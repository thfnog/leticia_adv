(function(a){function b(b){b=b.split(".");for(var c=a,d=0;d<b.length-1;d++)c[b[d]]||(c[b[d]]={}),c=c[b[d]]}function c(b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++){if(!e[d[f]])return null;e=e[d[f]]}e[d[d.length-1]]=c;return e[d[d.length-1]]}String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)};Function.prototype.bind=Function.prototype.bind||function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){return a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}};a.isArray=function(a){return"object"==typeof a&&a instanceof Array};a.isString=function(a){return"string"==typeof a};a.isFunction=function(a){return"function"==typeof a};var d=!1,e=function(){};e.extend=function(a,f,g,h,k){function m(){!d&&this.__init&&this.__init.apply(this,arguments)}var v=this.prototype;d=!0;var x=new this;d=!1;m.prototype=x;m.prototype.constructor=m;m.superclass=v;m.extend=e.extend;c(g,m);if(f){f=isFunction(f)?f():f;for(var w in f)f.hasOwnProperty(w)&&(m[w]=f[w])}m.__CLASS=g;if(h)for(isArray(h)||(h=[h]),g=0;g<h.length;g++){b(h[g]);var y=c(h[g],m);if(f)for(w in f)f.hasOwnProperty(w)&&(y[w]=f[w])}a=isFunction(a)?a():a;for(var z in a)x[z]=("__init"===z||k&&k.decorated)&&isFunction(a[z])&&isFunction(v[z])?function(a,b){return function(){var c=this.__super;this.__super=v[a];var d=b.apply(this,arguments);this.__super=c;return d}}(z,a[z]):a[z];return m};var f=function(a){this.name=a.defines;this.extendWith=a.extendsWith;this.callback=a.onCreate;this.callbackPreCreation=a.onPreCreate;this.dependencies=a.depends;this.baseClass=a.extendsClass;this.aliases=a.aliases;this.constants=a.constants;this.decorated=a.decorated;this.children=[];return this};f.prototype={children:null,name:null,extendWith:null,callback:null,dependencies:null,baseClass:null,aliases:null,constants:null,decorated:!1,solved:!1,visited:!1,status:function(){},removeDependency:function(a){for(var b=0;b<this.dependencies.length;b++)if(this.dependencies[b]===a){this.dependencies.splice(b,1);break}},assignDependency:function(a){var b;for(b=0;b<this.dependencies.length;b++)if(this.dependencies[b]===a.name){this.children.push(a);this.dependencies.splice(b,1);break}},isSolved:function(){return this.solved},solveDeep:function(){if(this.visited)return!0;this.visited=!0;if(this.solved)return!0;if(0!==this.dependencies.length)return!1;for(var a=0;a<this.children.length;a++)if(!this.children[a].solveDeep())return!1;this.__initModule();this.solved=!0;k.solved(this);return!0},__initModule:function(){var b=null;if(this.baseClass){a:{for(var b=this.baseClass.split("."),c=a,d=0;d<b.length;d++){if(!c[b[d]]){b=null;break a}c=c[b[d]]}b=c}if(!b)return}else b=e;b.extend(this.extendWith,this.constants,this.name,this.aliases,{decorated:this.decorated});this.callback&&this.callback()}};var g=function(a,b){this.path=a;this.module=b;return this};g.prototype={path:null,processed:!1,module:null,setProcessed:function(){this.processed=!0},isProcessed:function(){return this.processed}};var h=function(){this.nodes=[];this.loadedFiles=[];this.path={};this.solveListener=[];this.orderedSolvedModules=[];this.readyListener=[];return this};h.baseURL="";h.modulePath={};h.sortedModulePath=[];h.symbol={};h.prototype={nodes:null,loadedFiles:null,solveListener:null,readyListener:null,orderedSolvedModules:null,addSolvedListener:function(a,b){this.solveListener.push({name:a,callback:b})},solved:function(a){var b;for(b=0;b<this.solveListener.length;b++)this.solveListener[b].name===a.name&&this.solveListener[b].callback();this.orderedSolvedModules.push(a);this.notifyReady()},notifyReady:function(){var a;for(a=0;a<this.nodes.length;a++)if(!this.nodes[a].isSolved())return;for(a=0;a<this.loadedFiles.length;a++)if(!this.loadedFiles[a].isProcessed())return;var b=Array.prototype.slice.call(this.readyListener);setTimeout(function(){for(var a=0;a<b.length;a++)b[a]()},0);this.readyListener=[]},status:function(){for(var a=0;a<this.nodes.length;a++)this.nodes[a].status()},module:function(a){var b,c;if(this.isModuleScheduledToSolve(a.defines))return this;if(a.onPreCreate)try{a.onPreCreate()}catch(d){}a.depends||(a.depends=[]);(b=a.depends)&&!isArray(b)&&(b=[b],a.depends=b);for(c=0;c<b.length;)this.alreadySolved(b[c])?b.splice(c,1):c++;b=new f(a);for(c=0;c<this.nodes.length;c++)this.nodes[c].assignDependency(b);this.nodes.push(b);for(c=0;c<a.depends.length;)if(this.isModuleScheduledToSolve(a.depends[c])){var e=this.findNode(a.depends[c]);null!==e?b.assignDependency(e):(alert("Module loaded and does not exist in loaded modules nodes. "+a.depends[c]),c++)}else c+=1;(function(a,b){setTimeout(function(){for(c=0;c<b.depends.length;c++)a.loadFile(b.depends[c])},0)})(this,a);return this},findNode:function(a){for(var b=0;b<this.nodes.length;b++)if(this.nodes[b].name===a)return this.nodes[b];return null},alreadySolved:function(a){for(var b=0;b<this.nodes.length;b++)if(this.nodes[b].name===a&&this.nodes[b].isSolved())return!0;return!1},exists:function(b){b=b.split(".");for(var c=a,d=0;d<b.length;d++){if(!c[b[d]])return!1;c=c[b[d]]}return!0},loadFile:function(a){if(!this.exists(a)){for(var b=this.getPath(a),c=0;c<this.loadedFiles.length;c++)if(this.loadedFiles[c].path===b)return;c=new g(b,a);this.loadedFiles.push(c);c=document.createElement("script");c.type="text/javascript";c.charset="utf-8";c.async=!0;c.addEventListener("load",this.moduleLoaded.bind(this),!1);c.addEventListener("error",this.moduleErrored.bind(this),!1);c.setAttribute("module-name",a);c.src=b+(m?"":"?"+(new Date).getTime());document.getElementsByTagName("head")[0].appendChild(c)}},getPath:function(a){if(a.endsWith(".js"))return a="/"!==a.charAt(0)?h.baseURL+a:a.substring(1);var b,c;for(c in h.symbol)if(a===c)return h.baseURL+h.symbol[c];for(b=0;b<h.sortedModulePath.length;b++){var d=h.sortedModulePath[b];if(h.modulePath.hasOwnProperty(d)&&(c=h.modulePath[d],0===a.indexOf(d)))return a=a.substring(d.length+1),a=a.replace(/\./g,"/"),a=c+a+".js",h.baseURL+a}return h.baseURL+a.replace(/\./g,"/")+".js"},isModuleScheduledToSolve:function(a){for(var b=0;b<this.nodes.length;b++)if(this.nodes[b].name===a)return!0;return!1},moduleLoaded:function(a){if("load"===a.type){var b=(a.currentTarget||a.srcElement||a.target).getAttribute("module-name");for(a=0;a<this.loadedFiles.length;a++)if(this.loadedFiles[a].module===b){this.loadedFiles[a].setProcessed();break}for(a=0;a<this.nodes.length;a++)this.nodes[a].removeDependency(b);for(a=0;a<this.nodes.length;a++){for(b=0;b<this.nodes.length;b++)this.nodes[b].visited=!1;this.nodes[a].solveDeep()}var c=this;setTimeout(function(){c.notifyReady()},0)}},moduleErrored:function(a){},solvedInOrder:function(){for(var a=0;a<this.orderedSolvedModules.length;a++);},solveAll:function(){for(var a=0;a<this.nodes.length;a++)this.nodes[a].solveDeep()},onReady:function(a){this.readyListener.push(a)}};var k=new h,m=!1;a.CAAT=a.CAAT||{};CAAT.Module=function(a){a.defines?(b(a.defines),k.module(a)):console.error("Bad module definition: "+a)};CAAT.ModuleManager={};CAAT.ModuleManager.baseURL=function(a){if(!a)return CAAT.Module;a.endsWith("/")||(a+="/");h.baseURL=a;return CAAT.ModuleManager};CAAT.ModuleManager.setModulePath=function(a,b){b.endsWith("/")||(b+="/");h.modulePath[a]||(h.modulePath[a]=b,h.sortedModulePath.push(a),h.sortedModulePath.sort(function(a,b){return a==b?0:a<b?1:-1}));return CAAT.ModuleManager};CAAT.ModuleManager.symbol=function(a,b){h.symbol[a]||(h.symbol[a]=b);return CAAT.ModuleManager};CAAT.ModuleManager.bring=function(a){isArray(a)||(a=[a]);for(var b=0;b<a.length;b++)k.loadFile(a[b]);return CAAT.ModuleManager};CAAT.ModuleManager.status=function(){k.status()};CAAT.ModuleManager.addModuleSolvedListener=function(a,b){k.addSolveListener(a,b);return CAAT.ModuleManager};CAAT.ModuleManager.load=function(a,b,c){var d=document.createElement("script");d.type="text/javascript";d.charset="utf-8";d.async=!0;b&&d.addEventListener("load",b,!1);c&&d.addEventListener("error",c,!1);d.addEventListener("load",function(){k.solveAll()},!1);d.src=a+(m?"":"?"+(new Date).getTime());document.getElementsByTagName("head")[0].appendChild(d)};CAAT.ModuleManager.solvedInOrder=function(){k.solvedInOrder()};CAAT.ModuleManager.onReady=function(a){k.onReady(a);return CAAT.ModuleManager};CAAT.ModuleManager.solveAll=function(){k.solveAll()};CAAT.ModuleManager.debug=function(a){m=a;return CAAT.ModuleManager};CAAT.Class=e})(this);CAAT.Module({defines:"CAAT.Core.Constants",depends:["CAAT.Math.Matrix"],extendsWith:function(){CAAT.CLAMP=!1;CAAT.setCoordinateClamping=function(a){CAAT.CLAMP=a;CAAT.Math.Matrix.setCoordinateClamping(a)};CAAT.log=function(){};CAAT.CSS_TEXT_METRICS=0;CAAT.GLRENDER=!1;CAAT.DEBUG=!1;CAAT.DEBUGBB=!1;CAAT.DEBUGBBBCOLOR="#00f";CAAT.DEBUGAABB=!1;CAAT.DEBUGAABBCOLOR="#f00";CAAT.DEBUG_DIRTYRECTS=!1;CAAT.DRAG_THRESHOLD_X=5;CAAT.DRAG_THRESHOLD_Y=5;CAAT.CACHE_SCENE_ON_CHANGE=!0;return{}}});extend=function(a,b){var c=a.prototype,d=function(){};d.prototype=b.prototype;a.prototype=new d;a.superclass=b.prototype;a.prototype.constructor=a;b.prototype.constructor===Object.prototype.constructor&&(b.prototype.constructor=b);for(var e in c)c.hasOwnProperty(e)&&(a.prototype[e]=c[e])};extendWith=function(a,b,c){var d=function(){};d.prototype=a.prototype;b.prototype=new d;b.superclass=a.prototype;b.prototype.constructor=b;a.prototype.constructor===Object.prototype.constructor&&(a.prototype.constructor=a);if(c)for(var e in c)c.hasOwnProperty(e)&&(b.prototype[e]=c[e])};function proxyFunction(a,b,c,d,e){return function(){var f=Array.prototype.slice.call(arguments);c&&c({object:a,method:b,arguments:f});var g=null;try{if(g=a[b].apply(a,f),d){var h=d({object:a,method:b,arguments:f});h&&(g=h)}}catch(k){if(e)g=e({object:a,method:b,arguments:f,exception:k});else throw k;}return g}}function proxyAttribute(a,b,c,d,e){a.__defineGetter__(c,function(){d&&d(b,c);return b[c]});a.__defineSetter__(c,function(a){b[c]=a;e&&e(b,c,a)})}
function proxyObject(a,b,c,d,e,f){if("object"!==typeof a||isArray(a)||isString(a)||a.$proxy)return a;var g={$proxy:!0};g.$proxy_delegate=a;for(var h in a)"constructor"!==h&&("function"===typeof a[h]?g[h]=proxyFunction(a,h,b,c,d):proxyAttribute(g,a,h,e,f));return g}CAAT.Module({defines:"CAAT.Core.Class",extendsWith:function(){return{}}});CAAT.Module({defines:"CAAT.Math.Bezier",depends:["CAAT.Math.Curve"],extendsClass:"CAAT.Math.Curve",aliases:["CAAT.Bezier"],extendsWith:function(){return{cubic:!1,applyAsPath:function(a){var b=this.coordlist;this.cubic?a.ctx.bezierCurveTo(b[1].x,b[1].y,b[2].x,b[2].y,b[3].x,b[3].y):a.ctx.quadraticCurveTo(b[1].x,b[1].y,b[2].x,b[2].y);return this},isQuadric:function(){return!this.cubic},isCubic:function(){return this.cubic},setCubic:function(a,b,c,d,e,f,g,h){this.coordlist=[];this.coordlist.push((new CAAT.Math.Point).set(a,b));this.coordlist.push((new CAAT.Math.Point).set(c,d));this.coordlist.push((new CAAT.Math.Point).set(e,f));this.coordlist.push((new CAAT.Math.Point).set(g,h));this.cubic=!0;this.update();return this},setQuadric:function(a,b,c,d,e,f){this.coordlist=[];this.coordlist.push((new CAAT.Math.Point).set(a,b));this.coordlist.push((new CAAT.Math.Point).set(c,d));this.coordlist.push((new CAAT.Math.Point).set(e,f));this.cubic=!1;this.update();return this},setPoints:function(a){if(3===a.length)this.coordlist=a,this.cubic=!1,this.update();else if(4===a.length)this.coordlist=a,this.cubic=!0,this.update();else throw"points must be an array of 3 or 4 CAAT.Point instances.";return this},paint:function(a){this.cubic?this.paintCubic(a):this.paintCuadric(a);CAAT.Math.Bezier.superclass.paint.call(this,a)},paintCuadric:function(a){var b,c;b=this.coordlist[0].x;c=this.coordlist[0].y;a=a.ctx;a.save();a.beginPath();a.moveTo(b,c);b=new CAAT.Math.Point;for(c=this.k;c<=1+this.k;c+=this.k)this.solve(b,c),a.lineTo(b.x,b.y);a.stroke();a.restore()},paintCubic:function(a){var b,c;b=this.coordlist[0].x;c=this.coordlist[0].y;a=a.ctx;a.save();a.beginPath();a.moveTo(b,c);b=new CAAT.Math.Point;for(c=this.k;c<=1+this.k;c+=this.k)this.solve(b,c),a.lineTo(b.x,b.y);a.stroke();a.restore()},solve:function(a,b){return this.cubic?this.solveCubic(a,b):this.solveQuadric(a,b)},solveCubic:function(a,b){var c=b*b,d=b*c,e=this.coordlist,f=e[0],g=e[1],h=e[2],e=e[3];a.x=f.x+b*(3*-f.x+b*(3*f.x-f.x*b))+b*(3*g.x+b*(-6*g.x+3*g.x*b))+c*(3*h.x-3*h.x*b)+e.x*d;a.y=f.y+b*(3*-f.y+b*(3*f.y-f.y*b))+b*(3*g.y+b*(-6*g.y+3*g.y*b))+c*(3*h.y-3*h.y*b)+e.y*d;return a},solveQuadric:function(a,b){var c=this.coordlist,d=c[0],e=c[1],c=c[2],f=1-b;a.x=f*f*d.x+2*f*b*e.x+b*b*c.x;a.y=f*f*d.y+2*f*b*e.y+b*b*c.y;return a}}}});CAAT.Module({defines:"CAAT.Math.CatmullRom",depends:["CAAT.Math.Curve"],extendsClass:"CAAT.Math.Curve",aliases:["CAAT.CatmullRom"],extendsWith:function(){return{setCurve:function(a,b,c,d){this.coordlist=[];this.coordlist.push(a);this.coordlist.push(b);this.coordlist.push(c);this.coordlist.push(d);this.update();return this},paint:function(a){var b,c;b=this.coordlist[1].x;c=this.coordlist[1].y;var d=a.ctx;d.save();d.beginPath();d.moveTo(b,c);b=new CAAT.Point;for(c=this.k;c<=1+this.k;c+=this.k)this.solve(b,c),d.lineTo(b.x,b.y);d.stroke();d.restore();CAAT.Math.CatmullRom.superclass.paint.call(this,a)},solve:function(a,b){var c=this.coordlist,d=((-b+2)*b-1)*b*.5,e=.5*((3*b-5)*b*b+2),f=((-3*b+4)*b+1)*b*.5,g=(b-1)*b*b*.5;a.x=c[0].x*d+c[1].x*e+c[2].x*f+c[3].x*g;a.y=c[0].y*d+c[1].y*e+c[2].y*f+c[3].y*g;return a},applyAsPath:function(a){a=a.ctx;for(var b=new CAAT.Math.Point,c=this.k;c<=1+this.k;c+=this.k)this.solve(b,c),a.lineTo(b.x,b.y);return this},endCurvePosition:function(){return this.coordlist[this.coordlist.length-
2]},startCurvePosition:function(){return this.coordlist[1]}}}});CAAT.Module({defines:"CAAT.Math.Curve",depends:["CAAT.Math.Point"],extendsWith:function(){return{coordlist:null,k:.05,length:-1,HANDLE_SIZE:40,drawHandles:!0,paint:function(a){if(!1!==this.drawHandles){var b=this.coordlist;a=a.ctx;a.save();a.beginPath();a.strokeStyle="#a0a0a0";a.moveTo(b[0].x,b[0].y);a.lineTo(b[1].x,b[1].y);a.stroke();this.cubic&&(a.moveTo(b[2].x,b[2].y),a.lineTo(b[3].x,b[3].y),a.stroke());a.globalAlpha=.5;for(var c=0;c<this.coordlist.length;c++){a.fillStyle="#7f7f00";var d=this.HANDLE_SIZE/2;a.beginPath();a.arc(b[c].x,b[c].y,d,0,2*Math.PI,!1);a.fill()}a.restore()}},update:function(){this.calcLength()},solve:function(a,b){},getContour:function(a){var b=[],c;for(c=0;c<=a;c++){var d=new CAAT.Math.Point;this.solve(d,c/a);b.push(d)}return b},getBoundingBox:function(a){a||(a=new CAAT.Math.Rectangle);a.setEmpty();a.union(this.coordlist[0].x,this.coordlist[0].y);for(var b=new CAAT.Math.Point,c=this.k;c<=1+this.k;c+=this.k)this.solve(b,c),a.union(b.x,b.y);return a},calcLength:function(){var a,b;a=this.coordlist[0].x;b=this.coordlist[0].y;for(var c=0,d=new CAAT.Math.Point,e=this.k;e<=1+this.k;e+=this.k)this.solve(d,e),c+=Math.sqrt((d.x-a)*(d.x-a)+(d.y-b)*(d.y-b)),a=d.x,b=d.y;return this.length=c},getLength:function(){return this.length},endCurvePosition:function(){return this.coordlist[this.coordlist.length-1]},startCurvePosition:function(){return this.coordlist[0]},setPoints:function(a){},setPoint:function(a,b){0<=b&&b<this.coordlist.length&&(this.coordlist[b]=a)},applyAsPath:function(a){}}}});CAAT.Module({defines:"CAAT.Math.Dimension",aliases:["CAAT.Dimension"],extendsWith:function(){return{width:0,height:0,__init:function(a,b){this.width=a;this.height=b;return this}}}});CAAT.Module({defines:"CAAT.Math.Matrix",depends:["CAAT.Math.Point"],aliases:["CAAT.Matrix"],onCreate:function(){CAAT.Math.Matrix.prototype.transformRenderingContext=CAAT.Math.Matrix.prototype.transformRenderingContext_NoClamp;CAAT.Math.Matrix.prototype.transformRenderingContextSet=CAAT.Math.Matrix.prototype.transformRenderingContextSet_NoClamp},constants:{setCoordinateClamping:function(a){a?(CAAT.Matrix.prototype.transformRenderingContext=CAAT.Matrix.prototype.transformRenderingContext_Clamp,CAAT.Matrix.prototype.transformRenderingContextSet=CAAT.Matrix.prototype.transformRenderingContextSet_Clamp,CAAT.Math.Matrix.prototype.transformRenderingContext=CAAT.Matrix.prototype.transformRenderingContext_Clamp,CAAT.Math.Matrix.prototype.transformRenderingContextSet=CAAT.Matrix.prototype.transformRenderingContextSet_Clamp):(CAAT.Matrix.prototype.transformRenderingContext=CAAT.Matrix.prototype.transformRenderingContext_NoClamp,CAAT.Matrix.prototype.transformRenderingContextSet=CAAT.Matrix.prototype.transformRenderingContextSet_NoClamp,CAAT.Math.Matrix.prototype.transformRenderingContext=CAAT.Matrix.prototype.transformRenderingContext_NoClamp,CAAT.Math.Matrix.prototype.transformRenderingContextSet=CAAT.Matrix.prototype.transformRenderingContextSet_NoClamp)},scale:function(a,b){var c=new CAAT.Math.Matrix;c.matrix[0]=a;c.matrix[4]=b;return c},rotate:function(a){var b=new CAAT.Math.Matrix;b.setRotation(a);return b},translate:function(a,b){var c=new CAAT.Math.Matrix;c.matrix[2]=a;c.matrix[5]=b;return c}},extendsWith:function(){return{matrix:null,__init:function(){this.matrix=[1,0,0,0,1,0,0,0,1];"undefined"!==typeof Float32Array&&(this.matrix=new Float32Array(this.matrix));return this},transformCoord:function(a){var b=a.x,c=a.y,d=this.matrix;a.x=b*d[0]+c*d[1]+d[2];a.y=b*d[3]+c*d[4]+d[5];return a},setRotation:function(a){this.identity();var b=this.matrix,c=Math.cos(a);a=Math.sin(a);b[0]=c;b[1]=-a;b[3]=a;b[4]=c;return this},setScale:function(a,b){this.identity();this.matrix[0]=a;this.matrix[4]=b;return this},setTranslate:function(a,b){this.identity();this.matrix[2]=a;this.matrix[5]=b;return this},copy:function(a){a=a.matrix;var b=this.matrix;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},identity:function(){var a=this.matrix;a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return this},multiply:function(a){var b=this.matrix,c=a.matrix;a=b[0];var d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],m=b[7],n=b[8],p=c[0],r=c[1],q=c[2],t=c[3],u=c[4],v=c[5],x=c[6],w=c[7],c=c[8];b[0]=a*p+d*t+e*x;b[1]=a*r+d*u+e*w;b[2]=a*q+
d*v+e*c;b[3]=f*p+g*t+h*x;b[4]=f*r+g*u+h*w;b[5]=f*q+g*v+h*c;b[6]=k*p+m*t+n*x;b[7]=k*r+m*u+n*w;b[8]=k*q+m*v+n*c;return this},premultiply:function(a){var b=a.matrix[0]*this.matrix[1]+a.matrix[1]*this.matrix[4]+a.matrix[2]*this.matrix[7],c=a.matrix[0]*this.matrix[2]+a.matrix[1]*this.matrix[5]+a.matrix[2]*this.matrix[8],d=a.matrix[3]*this.matrix[0]+a.matrix[4]*this.matrix[3]+a.matrix[5]*this.matrix[6],e=a.matrix[3]*this.matrix[1]+a.matrix[4]*this.matrix[4]+a.matrix[5]*this.matrix[7],f=a.matrix[3]*this.matrix[2]+
a.matrix[4]*this.matrix[5]+a.matrix[5]*this.matrix[8],g=a.matrix[6]*this.matrix[0]+a.matrix[7]*this.matrix[3]+a.matrix[8]*this.matrix[6],h=a.matrix[6]*this.matrix[1]+a.matrix[7]*this.matrix[4]+a.matrix[8]*this.matrix[7],k=a.matrix[6]*this.matrix[2]+a.matrix[7]*this.matrix[5]+a.matrix[8]*this.matrix[8];this.matrix[0]=a.matrix[0]*this.matrix[0]+a.matrix[1]*this.matrix[3]+a.matrix[2]*this.matrix[6];this.matrix[1]=b;this.matrix[2]=c;this.matrix[3]=d;this.matrix[4]=e;this.matrix[5]=f;this.matrix[6]=g;this.matrix[7]=h;this.matrix[8]=k;return this},getInverse:function(){var a=this.matrix,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],a=a[8],m=new CAAT.Math.Matrix,n=b*(f*a-k*g)-e*(c*a-k*d)+h*(c*g-f*d);if(0===n)return null;var p=m.matrix;p[0]=f*a-g*k;p[1]=d*k-c*a;p[2]=c*g-d*f;p[3]=g*h-e*a;p[4]=b*a-d*h;p[5]=d*e-b*g;p[6]=e*k-f*h;p[7]=c*h-b*k;p[8]=b*f-c*e;m.multiplyScalar(1/n);return m},multiplyScalar:function(a){var b;for(b=0;9>b;b++)this.matrix[b]*=a;return this},transformRenderingContextSet_NoClamp:function(a){var b=this.matrix;a.setTransform(b[0],b[3],b[1],b[4],b[2],b[5]);return this},transformRenderingContext_NoClamp:function(a){var b=this.matrix;a.transform(b[0],b[3],b[1],b[4],b[2],b[5]);return this},transformRenderingContextSet_Clamp:function(a){var b=this.matrix;a.setTransform(b[0],b[3],b[1],b[4],b[2]>>0,b[5]>>0);return this},transformRenderingContext_Clamp:function(a){var b=this.matrix;a.transform(b[0],b[3],b[1],b[4],b[2]>>0,b[5]>>0);return this},setModelViewMatrix:function(a,b,c,d,e){var f,g,h,k,m,n;n=this.matrix;d=1;m=g=0;k=1;c=Math.cos(e);e=Math.sin(e);f=d;h=m;d=(f*c+g*e)*this.scaleX;g=(-f*e+g*c)*this.scaleY;m=(h*c+k*e)*this.scaleX;k=(-h*e+k*c)*this.scaleY;n[0]=d;n[1]=g;n[2]=a;n[3]=m;n[4]=k;n[5]=b}}}});CAAT.Module({defines:"CAAT.Math.Matrix3",aliases:["CAAT.Matrix3"],extendsWith:function(){return{matrix:null,fmatrix:null,__init:function(){this.matrix=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];this.fmatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this},transformCoord:function(a){var b=a.x,c=a.y,d=a.z;a.x=b*this.matrix[0][0]+c*this.matrix[0][1]+d*this.matrix[0][2]+this.matrix[0][3];a.y=b*this.matrix[1][0]+c*this.matrix[1][1]+d*this.matrix[1][2]+this.matrix[1][3];a.z=b*this.matrix[2][0]+c*this.matrix[2][1]+
d*this.matrix[2][2]+this.matrix[2][3];return a},initialize:function(a,b,c,d,e,f,g,h,k){this.identity();this.matrix[0][0]=a;this.matrix[0][1]=b;this.matrix[0][2]=c;this.matrix[1][0]=d;this.matrix[1][1]=e;this.matrix[1][2]=f;this.matrix[2][0]=g;this.matrix[2][1]=h;this.matrix[2][2]=k;return this},initWithMatrix:function(a){this.matrix=a;return this},flatten:function(){var a=this.fmatrix,b=this.matrix;a[0]=b[0][0];a[1]=b[1][0];a[2]=b[2][0];a[3]=b[3][0];a[4]=b[0][1];a[5]=b[1][1];a[6]=b[2][1];a[7]=b[2][1];a[8]=b[0][2];a[9]=b[1][2];a[10]=b[2][2];a[11]=b[3][2];a[12]=b[0][3];a[13]=b[1][3];a[14]=b[2][3];a[15]=b[3][3];return this.fmatrix},identity:function(){for(var a=0;4>a;a++)for(var b=0;4>b;b++)this.matrix[a][b]=a===b?1:0;return this},getMatrix:function(){return this.matrix},rotateXY:function(a){return this.rotate(a,0,0)},rotateXZ:function(a){return this.rotate(0,a,0)},rotateYZ:function(a){return this.rotate(0,0,a)},setRotate:function(a,b,c){a=this.rotate(a,b,c);this.copy(a);return this},rotate:function(a,b,c){var d=new CAAT.Math.Matrix3,e,f;0!==a&&(f=new CAAT.Math.Math.Matrix3,e=Math.sin(a),a=Math.cos(a),f.matrix[1][1]=a,f.matrix[1][2]=-e,f.matrix[2][1]=e,f.matrix[2][2]=a,d.multiply(f));0!==b&&(f=new CAAT.Math.Matrix3,e=Math.sin(b),a=Math.cos(b),f.matrix[0][0]=a,f.matrix[0][2]=-e,f.matrix[2][0]=e,f.matrix[2][2]=a,d.multiply(f));0!==c&&(f=new CAAT.Math.Matrix3,e=Math.sin(c),a=Math.cos(c),f.matrix[0][0]=a,f.matrix[0][1]=-e,f.matrix[1][0]=e,f.matrix[1][1]=a,d.multiply(f));return d},getClone:function(){var a=new CAAT.Math.Matrix3;a.copy(this);return a},multiply:function(a){var b=this.getClone().matrix,c=b[0][0],d=b[0][1],e=b[0][2],f=b[0][3],g=b[1][0],h=b[1][1],k=b[1][2],m=b[1][3],n=b[2][0],p=b[2][1],r=b[2][2],b=b[2][3],q=a.matrix;a=q[0][0];var t=q[0][1],u=q[0][2],v=q[0][3],x=q[1][0],w=q[1][1],y=q[1][2],z=q[1][3],A=q[2][0],B=q[2][1],C=q[2][2],D=q[2][3],E=q[3][0],F=q[3][1],G=q[3][2],q=q[3][3];this.matrix[0][0]=c*a+d*x+e*A+f*E;this.matrix[0][1]=c*t+d*w+e*B+f*F;this.matrix[0][2]=c*u+d*y+e*C+f*G;this.matrix[0][3]=c*v+d*z+e*D+f*q;this.matrix[1][0]=g*a+h*x+k*A+m*E;this.matrix[1][1]=g*t+h*w+k*B+m*F;this.matrix[1][2]=g*u+h*y+k*C+m*G;this.matrix[1][3]=g*v+h*z+k*D+m*q;this.matrix[2][0]=n*a+p*x+r*A+b*E;this.matrix[2][1]=n*t+p*w+r*B+b*F;this.matrix[2][2]=n*u+p*y+r*C+b*G;this.matrix[2][3]=n*v+p*z+r*D+b*q;return this},premultiply:function(a){var b=this.getClone().matrix,c=b[0][0],d=b[0][1],e=b[0][2],f=b[0][3],g=b[1][0],h=b[1][1],k=b[1][2],m=b[1][3],n=b[2][0],p=b[2][1],r=b[2][2],b=b[2][3],q=a.matrix;a=q[0][0];var t=q[0][1],u=q[0][2],v=q[0][3],x=q[1][0],w=q[1][1],y=q[1][2],z=q[1][3],A=q[2][0],B=q[2][1],C=q[2][2],q=q[2][3];this.matrix[0][0]=c*a+d*x+e*A;this.matrix[0][1]=c*t+d*w+e*B;this.matrix[0][2]=c*u+d*y+e*C;this.matrix[0][3]=c*v+d*z+e*q+f;this.matrix[1][0]=g*a+h*x+k*A;this.matrix[1][1]=g*t+h*w+k*B;this.matrix[1][2]=g*u+h*y+k*C;this.matrix[1][3]=g*v+h*z+k*q+m;this.matrix[2][0]=n*a+p*x+r*A;this.matrix[2][1]=n*t+p*w+r*B;this.matrix[2][2]=n*u+p*y+r*C;this.matrix[2][3]=n*v+p*z+r*q+b;return this},setTranslate:function(a,b,c){this.identity();this.matrix[0][3]=a;this.matrix[1][3]=b;this.matrix[2][3]=c;return this},translate:function(a,b,c){var d=new CAAT.Math.Matrix3;d.setTranslate(a,b,c);return d},setScale:function(a,b,c){this.identity();this.matrix[0][0]=a;this.matrix[1][1]=b;this.matrix[2][2]=c;return this},scale:function(a,b,c){var d=new CAAT.Math.Matrix3;d.setScale(a,b,c);return d},rotateModelView:function(a,b,c){var d=Math.sin(a),e=Math.sin(b),f=Math.sin(c);a=Math.cos(a);b=Math.cos(b);c=Math.cos(c);this.matrix[0][0]=b*a;this.matrix[0][1]=-b*d;this.matrix[0][2]=e;this.matrix[0][3]=0;this.matrix[1][0]=f*e*a+d*c;this.matrix[1][1]=c*a-f*e*d;this.matrix[1][2]=-f*b;this.matrix[1][3]=0;this.matrix[2][0]=f*d-c*e*a;this.matrix[2][1]=c*e*d+f*a;this.matrix[2][2]=c*b;this.matrix[2][3]=0;this.matrix[3][0]=0;this.matrix[3][1]=0;this.matrix[3][2]=0;this.matrix[3][3]=1;return this},copy:function(a){for(var b=0;4>b;b++)for(var c=0;4>c;c++)this.matrix[b][c]=a.matrix[b][c];return this},calculateDeterminant:function(){var a=this.matrix,b=a[0][0],c=a[0][1],d=a[0][2],e=a[0][3],f=a[1][0],g=a[1][1],h=a[1][2],k=a[1][3],m=a[2][0],n=a[2][1],p=a[2][2],r=a[2][3],q=a[3][0],t=a[3][1],u=a[3][2],a=a[3][3];return e*g*p*q+c*k*p*q+e*h*m*t+d*k*m*t+d*f*r*t+b*h*r*t+e*f*n*u+b*k*n*u+d*g*m*a+c*h*m*a+c*f*p*a+b*g*p*a+e*h*n*q-d*k*n*q-d*g*r*q-c*h*r*q-e*f*p*t-b*k*p*t-e*g*m*u-c*k*m*u-c*f*r*u-b*g*r*u-d*f*n*a-b*h*n*a},getInverse:function(){var a=this.matrix,b=a[0][0],c=a[0][1],d=a[0][2],e=a[0][3],f=a[1][0],g=a[1][1],h=a[1][2],k=a[1][3],m=a[2][0],n=a[2][1],p=a[2][2],r=a[2][3],q=a[3][0],t=a[3][1],u=a[3][2],a=a[3][3],v=new CAAT.Math.Matrix3;v.matrix[0][0]=h*r*t+k*n*u+g*p*a-k*p*t-g*r*u-h*n*a;v.matrix[0][1]=e*p*t+c*r*u+d*n*a-c*p*a-d*r*t-e*n*u;v.matrix[0][2]=d*k*t+c*h*a+e*g*u-c*k*u-d*g*a-e*h*t;v.matrix[0][3]=e*h*n+c*k*p+d*g*r-d*k*n-e*g*p-c*h*r;v.matrix[1][0]=k*p*q+f*r*u+h*m*a-h*r*q-k*m*u-f*p*a;v.matrix[1][1]=d*r*q+e*m*u+b*p*a-e*p*q-b*r*u-d*m*a;v.matrix[1][2]=e*h*q+b*k*u+d*f*a-d*k*q-e*f*u-b*h*a;v.matrix[1][3]=d*k*m+e*f*p+b*h*r-e*h*m-b*k*p-d*f*r;v.matrix[2][0]=g*r*q+k*m*t+f*n*a-k*n*q-f*r*t-g*m*a;v.matrix[2][1]=e*n*q+b*r*t+c*m*a-b*n*a-c*r*q-e*m*t;v.matrix[2][2]=d*k*q+e*f*t+b*g*a-e*g*q-b*k*t-c*f*a;v.matrix[2][3]=e*g*m+b*k*n+c*f*r-b*g*r-c*k*m-e*f*n;v.matrix[3][0]=h*n*q+f*p*t+g*m*u-g*p*q-h*m*t-f*n*u;v.matrix[3][1]=c*p*q+d*m*t+b*n*u-d*n*q-b*p*t-c*m*u;v.matrix[3][2]=d*g*q+b*h*t+c*f*u-b*g*u-c*h*q-d*f*t;v.matrix[3][3]=c*h*m+d*f*n+b*g*p-d*g*m-b*h*n-c*f*p;return v.multiplyScalar(1/this.calculateDeterminant())},multiplyScalar:function(a){var b,c;for(b=0;4>b;b++)for(c=0;4>c;c++)this.matrix[b][c]*=a;return this}}}});CAAT.Module({defines:"CAAT.Math.Point",aliases:["CAAT.Point"],extendsWith:function(){return{x:0,y:0,z:0,__init:function(a,b,c){this.x=a;this.y=b;this.z=c||0;return this},set:function(a,b,c){this.x=a;this.y=b;this.z=c||0;return this},clone:function(){return new CAAT.Math.Point(this.x,this.y,this.z)},translate:function(a,b,c){this.x+=a;this.y+=b;this.z+=c;return this},translatePoint:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},multiply:function(a){this.x*=a;this.y*=a;this.z*=a;return this},rotate:function(a){var b=this.x,c=this.y;this.x=b*Math.cos(a)-Math.sin(a)*c;this.y=b*Math.sin(a)+Math.cos(a)*c;this.z=0;return this},setAngle:function(a){var b=this.getLength();this.x=Math.cos(a)*b;this.y=Math.sin(a)*b;this.z=0;return this},setLength:function(a){var b=this.getLength();b?this.multiply(a/b):this.x=this.y=this.z=a;return this},normalize:function(){var a=this.getLength();this.x/=a;this.y/=a;this.z/=a;return this},getAngle:function(){return Math.atan2(this.y,this.x)},limit:function(a){var b=this.getLengthSquared();b+.01>a*a&&(b=Math.sqrt(b),this.x=this.x/b*a,this.y=this.y/b*a,this.z=this.z/b*a);return this},getLength:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return.005>a&&-.005<a?1E-6:a},getLengthSquared:function(){var a=this.x*this.x+this.y*this.y+this.z*this.z;return.005>a&&-.005<a?0:a},getDistance:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return Math.sqrt(b*b+c*c+
a*a)},getDistanceSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},toString:function(){return"(CAAT.Math.Point) x:"+String(Math.round(Math.floor(10*this.x))/10)+" y:"+String(Math.round(Math.floor(10*this.y))/10)+" z:"+String(Math.round(Math.floor(10*this.z))/10)}}}});CAAT.Module({defines:"CAAT.Math.Rectangle",aliases:["CAAT.Rectangle"],extendsWith:function(){return{__init:function(a,b,c,d){4!==arguments.length?this.setEmpty():(this.setLocation(a,b),this.setDimension(c,d))},x:0,y:0,x1:0,y1:0,width:-1,height:-1,setEmpty:function(){this.height=this.width=-1;this.y1=this.x1=this.y=this.x=0;return this},setLocation:function(a,b){this.x=a;this.y=b;this.x1=this.x+this.width;this.y1=this.y+this.height;return this},setDimension:function(a,b){this.width=a;this.height=b;this.x1=this.x+this.width;this.y1=this.y+this.height;return this},setBounds:function(a,b,c,d){this.setLocation(a,b);this.setDimension(c,d);return this},contains:function(a,b){return a>=this.x&&a<this.x1&&b>=this.y&&b<this.y1},isEmpty:function(){return-1===this.width&&-1===this.height},union:function(a,b){this.isEmpty()?(this.x1=this.x=a,this.y1=this.y=b,this.height=this.width=0):(this.x1=this.x+this.width,this.y1=this.y+this.height,b<this.y&&(this.y=b),a<this.x&&(this.x=a),b>this.y1&&(this.y1=b),a>this.x1&&(this.x1=a),this.width=this.x1-this.x,this.height=this.y1-this.y)},unionRectangle:function(a){this.union(a.x,a.y);this.union(a.x1,a.y);this.union(a.x,a.y1);this.union(a.x1,a.y1);return this},intersects:function(a){return a.isEmpty()||this.isEmpty()||a.x1<=this.x||a.x>=this.x1||a.y1<=this.y?!1:a.y<this.y1},intersectsRect:function(a,b,c,d){return-1===c||-1===d||a+c-1<this.x||a>this.x1||b+d-1<this.y?!1:b<=this.y1},intersect:function(a,b){"undefined"===typeof b&&(b=new CAAT.Math.Rectangle);b.x=Math.max(this.x,a.x);b.y=Math.max(this.y,a.y);b.x1=Math.min(this.x1,a.x1);b.y1=Math.min(this.y1,a.y1);b.width=b.x1-b.x;b.height=b.y1-b.y;return b}}}});CAAT.Module({defines:"CAAT.Behavior.Interpolator",depends:["CAAT.Math.Point"],aliases:["CAAT.Interpolator"],constants:{enumerateInterpolators:function(){return[(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1,!1),"Linear pingpong=false, inverse=false",(new CAAT.Behavior.Interpolator).createLinearInterpolator(!0,!1),"Linear pingpong=true, inverse=false",(new CAAT.Behavior.Interpolator).createBackOutInterpolator(!1),"BackOut pingpong=true, inverse=false",(new CAAT.Behavior.Interpolator).createBackOutInterpolator(!0),"BackOut pingpong=true, inverse=true",(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1,!0),"Linear pingpong=false, inverse=true",(new CAAT.Behavior.Interpolator).createLinearInterpolator(!0,!0),"Linear pingpong=true, inverse=true",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(2,!1),"ExponentialIn pingpong=false, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(2,!1),"ExponentialOut pingpong=false, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(2,!1),"ExponentialInOut pingpong=false, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(2,!0),"ExponentialIn pingpong=true, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(2,!0),"ExponentialOut pingpong=true, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(2,!0),"ExponentialInOut pingpong=true, exponent=2",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(4,!1),"ExponentialIn pingpong=false, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(4,!1),"ExponentialOut pingpong=false, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4,!1),"ExponentialInOut pingpong=false, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(4,!0),"ExponentialIn pingpong=true, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(4,!0),"ExponentialOut pingpong=true, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4,!0),"ExponentialInOut pingpong=true, exponent=4",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(6,!1),"ExponentialIn pingpong=false, exponent=6",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(6,!1),"ExponentialOut pingpong=false, exponent=6",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(6,!1),"ExponentialInOut pingpong=false, exponent=6",(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(6,!0),"ExponentialIn pingpong=true, exponent=6",(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(6,!0),"ExponentialOut pingpong=true, exponent=6",(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(6,!0),"ExponentialInOut pingpong=true, exponent=6",(new CAAT.Behavior.Interpolator).createBounceInInterpolator(!1),"BounceIn pingpong=false",(new CAAT.Behavior.Interpolator).createBounceOutInterpolator(!1),"BounceOut pingpong=false",(new CAAT.Behavior.Interpolator).createBounceInOutInterpolator(!1),"BounceInOut pingpong=false",(new CAAT.Behavior.Interpolator).createBounceInInterpolator(!0),"BounceIn pingpong=true",(new CAAT.Behavior.Interpolator).createBounceOutInterpolator(!0),"BounceOut pingpong=true",(new CAAT.Behavior.Interpolator).createBounceInOutInterpolator(!0),"BounceInOut pingpong=true",(new CAAT.Behavior.Interpolator).createElasticInInterpolator(1.1,.4,!1),"ElasticIn pingpong=false, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1.1,.4,!1),"ElasticOut pingpong=false, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticInOutInterpolator(1.1,.4,!1),"ElasticInOut pingpong=false, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticInInterpolator(1.1,.4,!0),"ElasticIn pingpong=true, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1.1,.4,!0),"ElasticOut pingpong=true, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticInOutInterpolator(1.1,.4,!0),"ElasticInOut pingpong=true, amp=1.1, d=.4",(new CAAT.Behavior.Interpolator).createElasticInInterpolator(1,.2,!1),"ElasticIn pingpong=false, amp=1.0, d=.2",(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1,.2,!1),"ElasticOut pingpong=false, amp=1.0, d=.2",(new CAAT.Behavior.Interpolator).createElasticInOutInterpolator(1,.2,!1),"ElasticInOut pingpong=false, amp=1.0, d=.2",(new CAAT.Behavior.Interpolator).createElasticInInterpolator(1,.2,!0),"ElasticIn pingpong=true, amp=1.0, d=.2",(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1,.2,!0),"ElasticOut pingpong=true, amp=1.0, d=.2",(new CAAT.Behavior.Interpolator).createElasticInOutInterpolator(1,.2,!0),"ElasticInOut pingpong=true, amp=1.0, d=.2"]},parse:function(a){var b="create"+a.type+"Interpolator",c=new CAAT.Behavior.Interpolator;try{c[b].apply(c,a.params||[])}catch(d){c.createLinearInterpolator(!1,!1)}return c}},extendsWith:function(){return{interpolated:null,paintScale:90,__init:function(){this.interpolated=new CAAT.Math.Point(0,0,0);return this},createLinearInterpolator:function(a,b){this.getPosition=function(c){var d=c;a&&(c=.5>c?2*c:1-2*(c-.5));null!==b&&b&&(c=1-c);return this.interpolated.set(d,c)};return this},createBackOutInterpolator:function(a){this.getPosition=function(b){var c=b;a&&(b=.5>b?2*b:1-2*(b-.5));--b;return this.interpolated.set(c,b*b*(2.70158*b+1.70158)+1)};return this},createExponentialInInterpolator:function(a,b){this.getPosition=function(c){var d=c;b&&(c=.5>c?2*c:1-2*(c-.5));return this.interpolated.set(d,Math.pow(c,a))};return this},createExponentialOutInterpolator:function(a,b){this.getPosition=function(c){var d=c;b&&(c=.5>c?2*c:1-2*(c-.5));return this.interpolated.set(d,1-Math.pow(1-c,a))};return this},createExponentialInOutInterpolator:function(a,b){this.getPosition=function(c){var d=c;b&&(c=.5>c?2*c:1-2*(c-.5));return 1>2*c?this.interpolated.set(d,Math.pow(2*c,a)/2):this.interpolated.set(d,1-Math.abs(Math.pow(2*c-2,a))/2)};return this},createQuadricBezierInterpolator:function(a,b,c,d){this.getPosition=function(e){var f=e;d&&(e=.5>e?2*e:1-2*(e-.5));e=(1-e)*(1-e)*a.y+2*(1-e)*e*b.y+e*e*c.y;return this.interpolated.set(f,e)};return this},createCubicBezierInterpolator:function(a,b,c,d,e){this.getPosition=function(f){var g=f;e&&(f=.5>f?2*f:1-2*(f-.5));var h=f*f;f=a.y+f*(3*-a.y+f*(3*a.y-a.y*f))+f*(3*b.y+f*(-6*b.y+3*b.y*f))+h*(3*c.y-3*c.y*f)+d.y*f*h;return this.interpolated.set(g,f)};return this},createElasticOutInterpolator:function(a,b,c){this.getPosition=function(d){c&&(d=.5>d?2*d:1-2*(d-.5));if(0===d)return{x:0,y:0};if(1===d)return{x:1,y:1};var e=b/(2*Math.PI)*Math.asin(1/a);return this.interpolated.set(d,a*Math.pow(2,-10*d)*Math.sin(2*(d-e)*Math.PI/b)+1)};return this},createElasticInInterpolator:function(a,b,c){this.getPosition=function(d){c&&(d=.5>d?2*d:1-2*(d-.5));if(0===d)return{x:0,y:0};if(1===d)return{x:1,y:1};var e=b/(2*Math.PI)*Math.asin(1/a);return this.interpolated.set(d,-(a*Math.pow(2,10*--d)*Math.sin(2*(d-e)*Math.PI/b)))};return this},createElasticInOutInterpolator:function(a,b,c){this.getPosition=function(d){c&&(d=.5>d?2*d:1-2*(d-.5));var e=b/(2*Math.PI)*Math.asin(1/a);d*=2;return 1>=d?this.interpolated.set(d,-.5*a*Math.pow(2,10*--d)*Math.sin(2*(d-e)*Math.PI/b)):this.interpolated.set(d,1+.5*a*Math.pow(2,-10*--d)*Math.sin(2*(d-e)*Math.PI/b))};return this},bounce:function(a){return(a/=1)<1/2.75?{x:a,y:7.5625*a*a}:a<2/2.75?{x:a,y:7.5625*(a-=1.5/2.75)*a+.75}:a<2.5/2.75?{x:a,y:7.5625*(a-=2.25/2.75)*a+.9375}:{x:a,y:7.5625*(a-=2.625/2.75)*a+.984375}},createBounceOutInterpolator:function(a){this.getPosition=function(b){a&&(b=.5>b?2*b:1-2*(b-.5));return this.bounce(b)};return this},createBounceInInterpolator:function(a){this.getPosition=function(b){a&&(b=.5>b?2*b:1-2*(b-.5));b=this.bounce(1-b);b.y=1-b.y;return b};return this},createBounceInOutInterpolator:function(a){this.getPosition=function(b){a&&(b=.5>b?2*b:1-2*(b-.5));if(.5>b)return b=this.bounce(1-2*b),b.y=.5*(1-b.y),b;b=this.bounce(2*b-1,a);b.y=.5*b.y+.5;return b};return this},paint:function(a){a.save();a.beginPath();a.moveTo(0,this.getPosition(0).y*this.paintScale);for(var b=0;b<=this.paintScale;b++)a.lineTo(b,this.getPosition(b/this.paintScale).y*this.paintScale);a.strokeStyle="black";a.stroke();a.restore()},getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push({x:c/a,y:this.getPosition(c/a).y});return b}}}});CAAT.Module({defines:"CAAT.Behavior.BaseBehavior",constants:{Status:{NOT_STARTED:0,STARTED:1,EXPIRED:2},parse:function(a){function b(a){a=a.split(".");for(var b=window,c=0;c<a.length;c++){if(!b[a[c]])return null;b=b[a[c]]}return b}try{var c=a.type.toLowerCase(),c="CAAT.Behavior."+c.substr(0,1).toUpperCase()+c.substr(1)+"Behavior",d=new new b(c);d.parse(a);return d}catch(e){}return null}},depends:["CAAT.Behavior.Interpolator"],extendsWith:function(){var a=(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1),b=(new CAAT.Behavior.Interpolator).createLinearInterpolator(!0);return{__init:function(){this.lifecycleListenerList=[];this.setDefaultInterpolator();return this},lifecycleListenerList:null,behaviorStartTime:-1,behaviorDuration:-1,cycleBehavior:!1,status:CAAT.Behavior.BaseBehavior.Status.NOT_STARTED,interpolator:null,actor:null,id:0,timeOffset:0,doValueApplication:!0,solved:!0,discardable:!1,isRelative:!1,setRelative:function(a){this.isRelative=a;return this},setRelativeValues:function(){this.isRelative=!0;return this},parse:function(a){a.pingpong&&this.setPingPong();a.cycle&&this.setCycle(!0);this.setDelayTime(a.delay||0,a.duration||1E3);a.interpolator&&this.setInterpolator(CAAT.Behavior.Interpolator.parse(a.interpolator))},setValueApplication:function(a){this.doValueApplication=a;return this},setTimeOffset:function(a){this.timeOffset=a;return this},setStatus:function(a){this.status=a;return this},setId:function(a){this.id=a;return this},setDefaultInterpolator:function(){this.interpolator=a;return this},setPingPong:function(){this.interpolator=b;return this},setFrameTime:function(a,b){this.behaviorStartTime=a;this.behaviorDuration=b;this.status=CAAT.Behavior.BaseBehavior.Status.NOT_STARTED;return this},setDelayTime:function(a,b){this.behaviorStartTime=a;this.behaviorDuration=b;this.status=CAAT.Behavior.BaseBehavior.Status.NOT_STARTED;this.expired=this.solved=!1;return this},setOutOfFrameTime:function(){this.status=CAAT.Behavior.BaseBehavior.Status.EXPIRED;this.behaviorStartTime=Number.MAX_VALUE;this.behaviorDuration=0;return this},setInterpolator:function(a){this.interpolator=a;return this},apply:function(a,b){this.solved||(this.behaviorStartTime+=a,this.solved=!0);var e=a+=this.timeOffset*this.behaviorDuration;this.isBehaviorInTime(a,b)&&(a=this.normalizeTime(a),this.fireBehaviorAppliedEvent(b,e,a,this.setForTime(a,b)))},setCycle:function(a){this.cycleBehavior=a;return this},addListener:function(a){this.lifecycleListenerList.push(a);return this},emptyListenerList:function(){this.lifecycleListenerList=[];return this},getStartTime:function(){return this.behaviorStartTime},getDuration:function(){return this.behaviorDuration},isBehaviorInTime:function(a,b){var e=CAAT.Behavior.BaseBehavior.Status;if(this.status===e.EXPIRED||0>this.behaviorStartTime)return!1;this.cycleBehavior&&a>=this.behaviorStartTime&&(a=(a-this.behaviorStartTime)%this.behaviorDuration+this.behaviorStartTime);if(a>this.behaviorStartTime+this.behaviorDuration)return this.status!==e.EXPIRED&&this.setExpired(b,a),!1;this.status===e.NOT_STARTED&&(this.status=e.STARTED,this.fireBehaviorStartedEvent(b,a));return this.behaviorStartTime<=a},fireBehaviorStartedEvent:function(a,b){for(var e=0,f=this.lifecycleListenerList.length;e<f;e++){var g=this.lifecycleListenerList[e];g.behaviorStarted&&g.behaviorStarted(this,b,a)}},fireBehaviorExpiredEvent:function(a,b){for(var e=0,f=this.lifecycleListenerList.length;e<f;e++){var g=this.lifecycleListenerList[e];g.behaviorExpired&&g.behaviorExpired(this,b,a)}},fireBehaviorAppliedEvent:function(a,b,e,f){for(var g=0,h=this.lifecycleListenerList.length;g<h;g++){var k=this.lifecycleListenerList[g];k.behaviorApplied&&k.behaviorApplied(this,b,e,a,f)}},normalizeTime:function(a){a-=this.behaviorStartTime;this.cycleBehavior&&(a%=this.behaviorDuration);return this.interpolator.getPosition(a/this.behaviorDuration).y},setExpired:function(a,b){this.status=CAAT.Behavior.BaseBehavior.Status.EXPIRED;this.setForTime(this.interpolator.getPosition(1).y,a);this.fireBehaviorExpiredEvent(a,b);this.discardable&&this.actor.removeBehavior(this)},setForTime:function(a,b){},initialize:function(a){if(a)for(var b in a)this[b]=a[b];return this},getPropertyName:function(){return""},calculateKeyFrameData:function(a){},getKeyFrameDataValues:function(a){},calculateKeyFramesData:function(a,b,e){}}}});CAAT.Module({defines:"CAAT.Behavior.AlphaBehavior",aliases:["CAAT.AlphaBehavior"],depends:["CAAT.Behavior.BaseBehavior"],extendsClass:"CAAT.Behavior.BaseBehavior",extendsWith:function(){return{startAlpha:0,endAlpha:0,parse:function(a){CAAT.Behavior.AlphaBehavior.superclass.parse.call(this,a);this.startAlpha=a.start||0;this.endAlpha=a.end||0},getPropertyName:function(){return"opacity"},setForTime:function(a,b){CAAT.Behavior.AlphaBehavior.superclass.setForTime.call(this,a,b);var c=this.startAlpha+a*(this.endAlpha-this.startAlpha);this.doValueApplication&&b.setAlpha(c);return c},setValues:function(a,b){this.startAlpha=a;this.endAlpha=b;return this},calculateKeyFrameData:function(a){a=this.interpolator.getPosition(a).y;return this.startAlpha+a*(this.endAlpha-this.startAlpha)},getKeyFrameDataValues:function(a){a=this.interpolator.getPosition(a).y;return{alpha:this.startAlpha+a*(this.endAlpha-this.startAlpha)}},calculateKeyFramesData:function(a,b,c){"undefined"===typeof c&&(c=100);c>>=0;var d="@-"+
a+"-keyframes "+b+" {";for(a=0;a<=c;a++)b=""+a/c*100+"%{opacity: "+this.calculateKeyFrameData(a/c)+"}",d+=b;return d+"}"}}}});CAAT.Module({defines:"CAAT.Behavior.ContainerBehavior",depends:["CAAT.Behavior.BaseBehavior","CAAT.Behavior.GenericBehavior"],aliases:["CAAT.ContainerBehavior"],extendsClass:"CAAT.Behavior.BaseBehavior",extendsWith:function(){return{parse:function(a){if(a.behaviors&&a.behaviors.length)for(var b=0;b<a.behaviors.length;b+=1)this.addBehavior(CAAT.Behavior.BaseBehavior.parse(a.behaviors[b]));CAAT.Behavior.ContainerBehavior.superclass.parse.call(this,a)},behaviors:null,conforming:!1,__init:function(a){this.__super();this.behaviors=[];a&&(this.conforming=!0);return this},conformToDuration:function(a){this.duration=a;a/=this.duration;for(var b,c=0;c<this.behaviors.length;c++)b=this.behaviors[c],b.setFrameTime(b.getStartTime()*a,b.getDuration()*a);return this},getBehaviorById:function(a){for(var b=0;b<this.behaviors.length;b++)if(this.behaviors[b].id===a)return this.behaviors[b];return null},addBehavior:function(a){this.behaviors.push(a);a.addListener(this);this.conforming&&(a=a.behaviorDuration+a.behaviorStartTime,this.behaviorDuration<a&&(this.behaviorDuration=a,this.behaviorStartTime=0));return this},apply:function(a,b){this.solved||(this.behaviorStartTime+=a,this.solved=!0);a+=this.timeOffset*this.behaviorDuration;if(this.isBehaviorInTime(a,b)){a-=this.behaviorStartTime;this.cycleBehavior&&(a%=this.behaviorDuration);for(var c=this.behaviors,d=0;d<c.length;d++)c[d].apply(a,b)}},behaviorExpired:function(a,b,c){this.cycleBehavior&&a.setStatus(CAAT.Behavior.BaseBehavior.Status.STARTED)},behaviorApplied:function(a,b,c,d,e){this.fireBehaviorAppliedEvent(d,b,c,e)},setForTime:function(a,b){for(var c=null,d=this.behaviors,e=0;e<d.length;e++)c=d[e].setForTime(a,b);return c},setExpired:function(a,b){for(var c=this.behaviors,d=0;d<c.length;d++){var e=c[d];e.status!==CAAT.Behavior.BaseBehavior.Status.EXPIRED&&e.setExpired(a,b-this.behaviorStartTime)}CAAT.Behavior.ContainerBehavior.superclass.setExpired.call(this,a,b);return this},setFrameTime:function(a,b){CAAT.Behavior.ContainerBehavior.superclass.setFrameTime.call(this,a,b);for(var c=this.behaviors,d=0;d<c.length;d++)c[d].setStatus(CAAT.Behavior.BaseBehavior.Status.NOT_STARTED);return this},setDelayTime:function(a,b){CAAT.Behavior.ContainerBehavior.superclass.setDelayTime.call(this,a,b);for(var c=this.behaviors,d=0;d<c.length;d++)c[d].setStatus(CAAT.Behavior.BaseBehavior.Status.NOT_STARTED);return this},getKeyFrameDataValues:function(a){var b,c,d,e={angle:0,scaleX:1,scaleY:1,x:0,y:0};for(b=0;b<this.behaviors.length;b++)if(c=this.behaviors[b],c.status!==CAAT.Behavior.BaseBehavior.Status.EXPIRED&&!(c instanceof CAAT.Behavior.GenericBehavior)&&(d=a*this.behaviorDuration,c.behaviorStartTime<=d&&c.behaviorStartTime+c.behaviorDuration>=d)){d=(d-c.behaviorStartTime)/c.behaviorDuration;c=c.getKeyFrameDataValues(d);for(var f in c)e[f]=c[f]}return e},calculateKeyFrameData:function(a,b){function c(a){f[a]?h+=f[a]:prevValues&&(k=prevValues[a])&&(h+=k,f[a]=k)}var d,e,f={},g;for(d=0;d<this.behaviors.length;d++)e=this.behaviors[d],e.status===CAAT.Behavior.BaseBehavior.Status.EXPIRED||e instanceof CAAT.Behavior.GenericBehavior||(g=a*this.behaviorDuration,e.behaviorStartTime<=g&&e.behaviorStartTime+e.behaviorDuration>=g&&(g=(g-e.behaviorStartTime)/e.behaviorDuration,g=e.calculateKeyFrameData(g),e=e.getPropertyName(b),"undefined"===typeof f[e]&&(f[e]=""),f[e]+=g+" "));var h="",k;c("translate");c("rotate");c("scale");d="";h&&(d="-"+b+"-transform: "+h+";");h="";c("opacity");h&&(d+=" opacity: "+h+";");return{rules:d+" -webkit-transform-origin: 0% 0%",ret:f}},calculateKeyFramesData:function(a,b,c,d,e){if(this.duration===Number.MAX_VALUE)return"";"undefined"===typeof d&&(d=.5);"undefined"===typeof e&&(e=.5);"undefined"===typeof c&&(c=100);var f="@-"+a+"-keyframes "+b+" {",g,h={};for(b=0;b<=c;b++){g=this.interpolator.getPosition(b/c).y;g=this.getKeyFrameDataValues(g);var k=""+b/c*100+"%{",m=g,n=void 0;for(n in h)m[n]||(m[n]=h[n]);h="-"+a+"-transform:";if(m.x||m.y)h+="translate("+(m.x||0)+"px,"+(m.y||0)+"px)";m.angle&&(h+=" rotate("+m.angle+"rad)");if(1!==m.scaleX||1!==m.scaleY)h+=" scale("+m.scaleX+","+m.scaleY+")";h+=";";m.alpha&&(h+=" opacity: "+
m.alpha+";");if(.5!==d||.5!==e)h+=" -"+a+"-transform-origin:"+100*d+"% "+100*e+"%;";f+=k+h+"}\n";h=g}return f+"}\n"}}}});CAAT.Module({defines:"CAAT.Behavior.GenericBehavior",depends:["CAAT.Behavior.BaseBehavior"],aliases:["CAAT.GenericBehavior"],extendsClass:"CAAT.Behavior.BaseBehavior",extendsWith:function(){return{start:0,end:0,target:null,property:null,callback:null,setForTime:function(a,b){var c=this.start+a*(this.end-this.start);this.callback&&this.callback(c,this.target,b);this.property&&(this.target[this.property]=c)},setValues:function(a,b,c,d,e){this.start=a;this.end=b;this.target=c;this.property=d;this.callback=e;return this}}}});CAAT.Module({defines:"CAAT.Behavior.PathBehavior",aliases:["CAAT.PathBehavior"],depends:["CAAT.Behavior.BaseBehavior","CAAT.Foundation.SpriteImage"],constants:{AUTOROTATE:{LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1,FREE:2},autorotate:{LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1,FREE:2}},extendsClass:"CAAT.Behavior.BaseBehavior",extendsWith:function(){return{parse:function(a){CAAT.Behavior.PathBehavior.superclass.parse.call(this,a);if(a.SVG){var b=(new CAAT.PathUtil.SVGPath).parsePath(a.SVG);this.setValues(b)}a.autoRotate&&(this.autoRotate=a.autoRotate)},path:null,autoRotate:!1,prevX:-1,prevY:-1,autoRotateOp:CAAT.Behavior.PathBehavior.autorotate.FREE,isOpenContour:!1,relativeX:0,relativeY:0,setOpenContour:function(a){this.isOpenContour=a;return this},getPropertyName:function(){return"translate"},setRelativeValues:function(a,b){this.relativeX=a;this.relativeY=b;this.isRelative=!0;return this},setAutoRotate:function(a,b){this.autoRotate=a;void 0!==b&&(this.autoRotateOp=b);return this},setPath:function(a){this.path=a;return this},setValues:function(a){return this.setPath(a)},setTranslation:function(a,b){return this},calculateKeyFrameData:function(a){a=this.interpolator.getPosition(a).y;a=this.path.getPosition(a);return"translateX("+a.x+"px) translateY("+a.y+"px)"},getKeyFrameDataValues:function(a){a=this.interpolator.getPosition(a).y;var b=this.path.getPosition(a),c={x:b.x,y:b.y};this.autoRotate&&(a=0===a?b:this.path.getPosition(a-.001),b=Math.atan2(b.y-a.y,b.x-a.x),c.angle=b);return c},calculateKeyFramesData:function(a,b,c){"undefined"===typeof c&&(c=100);c>>=0;var d,e="@-"+a+"-keyframes "+b+" {";for(b=0;b<=c;b++)d=""+b/c*100+"%{-"+a+"-transform:"+this.calculateKeyFrameData(b/c)+"}",e+=d;return e+"}"},setForTime:function(a,b){if(!this.path)return{x:b.x,y:b.y};var c=this.path.getPosition(a,this.isOpenContour,.001);this.isRelative&&(c.x+=this.relativeX,c.y+=this.relativeY);if(this.autoRotate){-1===this.prevX&&-1===this.prevY&&(this.prevX=c.x,this.prevY=c.y);var d=c.x-this.prevX,e=c.y-this.prevY;if(0===d&&0===e)return b.setLocation(c.x,c.y),{x:b.x,y:b.y};var f=Math.atan2(e,d),g=CAAT.Foundation.SpriteImage,h=CAAT.Behavior.PathBehavior.AUTOROTATE;this.autoRotateOp===h.LEFT_TO_RIGHT?this.prevX<=c.x?b.setImageTransformation(g.TR_NONE):(b.setImageTransformation(g.TR_FLIP_HORIZONTAL),f+=Math.PI):this.autoRotateOp===h.RIGHT_TO_LEFT&&(this.prevX<=c.x?b.setImageTransformation(g.TR_FLIP_HORIZONTAL):(b.setImageTransformation(g.TR_NONE),f-=Math.PI));b.setRotation(f);this.prevX=c.x;this.prevY=c.y;Math.sqrt(d*d+e*e)}return this.doValueApplication?(b.setLocation(c.x,c.y),{x:b.x,y:b.y}):{x:c.x,y:c.y}},positionOnTime:function(a){return this.isBehaviorInTime(a,null)?(a=this.normalizeTime(a),this.path.getPosition(a)):{x:-1,y:-1}}}}});CAAT.Module({defines:"CAAT.Behavior.RotateBehavior",extendsClass:"CAAT.Behavior.BaseBehavior",depends:["CAAT.Behavior.BaseBehavior","CAAT.Foundation.Actor"],aliases:["CAAT.RotateBehavior"],extendsWith:function(){return{__init:function(){this.__super();this.anchor=CAAT.Foundation.Actor.ANCHOR_CENTER;return this},parse:function(a){CAAT.Behavior.RotateBehavior.superclass.parse.call(this,a);this.startAngle=a.start||0;this.endAngle=a.end||0;this.anchorX="undefined"!==typeof a.anchorX?parseInt(a.anchorX):.5;this.anchorY="undefined"!==typeof a.anchorY?parseInt(a.anchorY):.5},startAngle:0,endAngle:0,anchorX:.5,anchorY:.5,rotationRelative:0,setRelativeValues:function(a){this.rotationRelative=a;this.isRelative=!0;return this},getPropertyName:function(){return"rotate"},setForTime:function(a,b){var c=this.startAngle+a*(this.endAngle-this.startAngle);this.isRelative&&(c+=this.rotationRelative,c>=Math.PI&&(c-=2*Math.PI),c<-2*Math.PI&&(c+=2*Math.PI));this.doValueApplication&&b.setRotationAnchored(c,this.anchorX,this.anchorY);return c},setValues:function(a,b,c,d){this.startAngle=a;this.endAngle=b;"undefined"!==typeof c&&"undefined"!==typeof d&&(this.anchorX=c,this.anchorY=d);return this},setAngles:function(a,b){return this.setValues(a,b)},setAnchor:function(a,b,c){this.anchorX=b/a.width;this.anchorY=c/a.height;return this},calculateKeyFrameData:function(a){a=this.interpolator.getPosition(a).y;return"rotate("+(this.startAngle+a*(this.endAngle-this.startAngle))+"rad)"},getKeyFrameDataValues:function(a){a=this.interpolator.getPosition(a).y;return{angle:this.startAngle+a*(this.endAngle-this.startAngle)}},calculateKeyFramesData:function(a,b,c){"undefined"===typeof c&&(c=100);c>>=0;var d,e="@-"+a+"-keyframes "+b+" {";for(b=0;b<=c;b++)d=""+b/c*100+"%{-"+a+"-transform:"+this.calculateKeyFrameData(b/c)+"; -"+a+"-transform-origin:"+100*this.anchorX+"% "+100*this.anchorY+"% }\n",e+=d;return e+"}\n"}}}});CAAT.Module({defines:"CAAT.Behavior.Scale1Behavior",depends:["CAAT.Behavior.BaseBehavior","CAAT.Foundation.Actor"],aliases:["CAAT.Scale1Behavior"],constants:{AXIS:{X:0,Y:1},Axis:{X:0,Y:1}},extendsClass:"CAAT.Behavior.BaseBehavior",extendsWith:function(){return{__init:function(){this.__super();this.anchor=CAAT.Foundation.Actor.ANCHOR_CENTER;return this},startScale:1,endScale:1,anchorX:.5,anchorY:.5,applyOnX:!0,parse:function(a){CAAT.Behavior.Scale1Behavior.superclass.parse.call(this,a);this.startScale=a.start||0;this.endScale=a.end||0;this.anchorX="undefined"!==typeof a.anchorX?parseInt(a.anchorX):.5;this.anchorY="undefined"!==typeof a.anchorY?parseInt(a.anchorY):.5;this.applyOnX=a.axis?"x"===a.axis.toLowerCase():!0},applyOnAxis:function(a){this.applyOnX=a===CAAT.Behavior.Scale1Behavior.AXIS.X?!1:!0},getPropertyName:function(){return"scale"},setForTime:function(a,b){var c=this.startScale+a*(this.endScale-this.startScale);0===c&&(c=.01);this.doValueApplication&&(this.applyOnX?b.setScaleAnchored(c,b.scaleY,this.anchorX,this.anchorY):b.setScaleAnchored(b.scaleX,c,this.anchorX,this.anchorY));return c},setValues:function(a,b,c,d,e){this.startScale=a;this.endScale=b;this.applyOnX=!!c;"undefined"!==typeof d&&"undefined"!==typeof e&&(this.anchorX=d,this.anchorY=e);return this},setAnchor:function(a,b,c){this.anchorX=b/a.width;this.anchorY=c/a.height;return this},calculateKeyFrameData:function(a){a=this.interpolator.getPosition(a).y;a=this.startScale+a*(this.endScale-this.startScale);return this.applyOnX?"scaleX("+a+")":"scaleY("+a+")"},getKeyFrameDataValues:function(a){a=this.interpolator.getPosition(a).y;var b={};b[this.applyOnX?"scaleX":"scaleY"]=this.startScale+a*(this.endScale-this.startScale);return b},calculateKeyFramesData:function(a,b,c){"undefined"===typeof c&&(c=100);c>>=0;var d,e="@-"+a+"-keyframes "+b+" {";for(b=0;b<=c;b++)d=""+b/c*100+"%{-"+a+"-transform:"+this.calculateKeyFrameData(b/c)+"; -"+a+"-transform-origin:"+100*this.anchorX+"% "+100*this.anchorY+"% }\n",e+=d;return e+"}\n"}}}});CAAT.Module({defines:"CAAT.Behavior.ScaleBehavior",depends:["CAAT.Behavior.BaseBehavior","CAAT.Foundation.Actor"],extendsClass:"CAAT.Behavior.BaseBehavior",aliases:["CAAT.ScaleBehavior"],extendsWith:function(){return{__init:function(){this.__super();this.anchor=CAAT.Foundation.Actor.ANCHOR_CENTER;return this},startScaleX:1,endScaleX:1,startScaleY:1,endScaleY:1,anchorX:.5,anchorY:.5,parse:function(a){CAAT.Behavior.ScaleBehavior.superclass.parse.call(this,a);this.startScaleX=a.scaleX&&a.scaleX.start||0;this.endScaleX=a.scaleX&&a.scaleX.end||0;this.startScaleY=a.scaleY&&a.scaleY.start||0;this.endScaleY=a.scaleY&&a.scaleY.end||0;this.anchorX="undefined"!==typeof a.anchorX?parseInt(a.anchorX):.5;this.anchorY="undefined"!==typeof a.anchorY?parseInt(a.anchorY):.5},getPropertyName:function(){return"scale"},setForTime:function(a,b){var c=this.startScaleX+a*(this.endScaleX-this.startScaleX),d=this.startScaleY+a*(this.endScaleY-this.startScaleY);0===c&&(c=.01);0===d&&(d=.01);this.doValueApplication&&b.setScaleAnchored(c,d,this.anchorX,this.anchorY);return{scaleX:c,scaleY:d}},setValues:function(a,b,c,d,e,f){this.startScaleX=a;this.endScaleX=b;this.startScaleY=c;this.endScaleY=d;"undefined"!==typeof e&&"undefined"!==typeof f&&(this.anchorX=e,this.anchorY=f);return this},setAnchor:function(a,b,c){this.anchorX=b/a.width;this.anchorY=c/a.height;return this},calculateKeyFrameData:function(a){a=this.interpolator.getPosition(a).y;return"scale("+(this.startScaleX+a*(this.endScaleX-this.startScaleX))+","+(this.startScaleY+
a*(this.endScaleY-this.startScaleY))+")"},getKeyFrameDataValues:function(a){a=this.interpolator.getPosition(a).y;return{scaleX:this.startScaleX+a*(this.endScaleX-this.startScaleX),scaleY:this.startScaleY+a*(this.endScaleY-this.startScaleY)}},calculateKeyFramesData:function(a,b,c){"undefined"===typeof c&&(c=100);c>>=0;var d,e="@-"+a+"-keyframes "+b+" {";for(b=0;b<=c;b++)d=""+b/c*100+"%{-"+a+"-transform:"+this.calculateKeyFrameData(b/c)+"; -"+a+"-transform-origin:"+100*this.anchorX+"% "+100*this.anchorY+"% }\n",e+=d;return e+"}\n"}}}});CAAT.Module({defines:"CAAT.Module.Runtime.BrowserInfo",constants:function(){function a(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(-1!==c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}}function b(a){var b=a.indexOf(this.versionSearchString);if(-1!==b)return parseFloat(a.substring(b+this.versionSearchString.length+1))}var c=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod/iPad"},{string:navigator.userAgent,subString:"iPad",identity:"iPhone/iPod/iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],d=a([{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Explorer",identity:"Explorer",versionSearch:"Explorer"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}])||"An unknown browser",e=b(navigator.userAgent)||b(navigator.appVersion)||"an unknown version",c=a(c)||"an unknown OS";return{browser:d,version:e,OS:c,DevicePixelRatio:window.devicePixelRatio||1}}});CAAT.Module({defines:"CAAT.Module.Audio.AudioManager",depends:["CAAT.Module.Runtime.BrowserInfo"],extendsWith:function(){return{__init:function(){this.browserInfo=CAAT.Module.Runtime.BrowserInfo;return this},musicChannel:null,browserInfo:null,musicEnabled:!0,fxEnabled:!0,audioCache:null,channels:null,workingChannels:null,loopingChannels:[],audioTypes:{mp3:"audio/mpeg;",ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',mp4:'audio/mp4; codecs="mp4a.40.2"'},initialize:function(a){this.audioCache=[];this.channels=[];this.workingChannels=[];for(var b=0;b<=a;b++){var c=document.createElement("audio");if(null!==c){c.finished=-1;this.channels.push(c);var d=this;c.addEventListener("ended",function(a){a=a.target;var b;for(b=0;b<d.workingChannels.length;b++)if(d.workingChannels[b]===a){d.workingChannels.splice(b,1);break}a.caat_callback&&a.caat_callback(a.caat_id);d.channels.push(a)},!1)}}this.musicChannel=this.channels.pop();return this},addAudioFromURL:function(a,b,c){var d=null,e=document.createElement("audio");if(null!==e){if(!e.canPlayType)return!1;d=b.substr(b.lastIndexOf(".")+1);d=e.canPlayType(this.audioTypes[d]);if(""!==d&&"no"!==d)return e.src=b,e.preload="auto",e.load(),c&&(e.caat_callback=c,e.caat_id=a),this.audioCache.push({id:a,audio:e}),!0}return!1},addAudioFromDomNode:function(a,b,c){var d=b.src.substr(b.src.lastIndexOf(".")+1);return b.canPlayType(this.audioTypes[d])?(c&&(b.caat_callback=c,b.caat_id=a),this.audioCache.push({id:a,audio:b}),!0):!1},addAudioElement:function(a,b,c){if("string"===typeof b)return this.addAudioFromURL(a,b,c);try{if(b instanceof HTMLAudioElement)return this.addAudioFromDomNode(a,b,c)}catch(d){}return!1},addAudio:function(a,b,c){if(b instanceof Array)for(var d=0;d<b.length&&!this.addAudioElement(a,b[d],c);d++);else this.addAudioElement(a,b,c);return this},getAudio:function(a){for(var b=0;b<this.audioCache.length;b++)if(this.audioCache[b].id===a)return this.audioCache[b].audio;return null},stopMusic:function(){this.musicChannel.pause()},playMusic:function(a){if(!this.musicEnabled)return null;a=this.getAudio(a);if(null!==a){var b=this.musicChannel;if(null!==b)return b.src=a.src,b.preload="auto","Firefox"===this.browserInfo.browser?b.addEventListener("ended",function(a){a.target.currentTime=0},!1):b.loop=!0,b.load(),b.play(),b}return null},setVolume:function(a,b){var c=this.getAudio(a);null!=c&&(c.volume=b);return this},play:function(a){if(!this.fxEnabled)return null;a=this.getAudio(a);if(null!==a&&0<this.channels.length){var b=this.channels.shift();b.src=a.src;b.volume=a.volume;b.play();this.workingChannels.push(b)}return a},cancelPlay:function(a){for(var b=0;this.workingChannels.length;b++){var c=this.workingChannels[b];c.caat_id===a&&(c.pause(),this.channels.push(c),this.workingChannels.splice(b,1))}return this},cancelPlayByChannel:function(a){for(var b=0;this.workingChannels.length;b++)if(this.workingChannels[b]===a){this.channels.push(a);this.workingChannels.splice(b,1);break}return this},loop:function(a){if(!this.musicEnabled)return null;a=this.getAudio(a);if(null!==a){var b=document.createElement("audio");if(null!==b)return b.src=a.src,b.preload="auto","Firefox"===this.browserInfo.browser?b.addEventListener("ended",function(a){a.target.currentTime=0},!1):b.loop=!0,b.load(),b.play(),this.loopingChannels.push(b),b}return null},endSound:function(){var a;for(a=0;a<this.workingChannels.length;a++)this.workingChannels[a].pause(),this.channels.push(this.workingChannels[a]);for(a=0;a<this.loopingChannels.length;a++)this.loopingChannels[a].pause();this.workingChannels=[];this.loopingChannels=[];this.stopMusic();return this},setSoundEffectsEnabled:function(a){this.fxEnabled=a;for(var b=0;b<this.loopingChannels.length;b++)a?this.loopingChannels[b].play():this.loopingChannels[b].pause();return this},isSoundEffectsEnabled:function(){return this.fxEnabled},setMusicEnabled:function(a){this.musicEnabled=a;this.stopMusic();return this},isMusicEnabled:function(){return this.musicEnabled}}}});CAAT.Module({defines:"CAAT.Module.Storage.LocalStorage",constants:{save:function(a,b){try{localStorage.setItem(a,JSON.stringify(b))}catch(c){}return this},load:function(a,b){try{var c=localStorage.getItem(a);return null===c?b:JSON.parse(c)}catch(d){return null}},remove:function(a){try{localStorage.removeItem(a)}catch(b){}return this}},extendsWith:{}});CAAT.Module({defines:"CAAT.Module.ColorUtil.Color",depends:[],constants:{RampEnumeration:{RAMP_RGBA:0,RAMP_RGB:1,RAMP_CHANNEL_RGB:2,RAMP_CHANNEL_RGBA:3,RAMP_CHANNEL_RGB_ARRAY:4,RAMP_CHANNEL_RGBA_ARRAY:5},hsvToRgb:function(a,b,c){var d,e,f;a=Math.max(0,Math.min(360,a));b=Math.max(0,Math.min(100,b));c=Math.max(0,Math.min(100,c));b/=100;c/=100;if(0===b)return d=b=c,[Math.round(255*d),Math.round(255*b),Math.round(255*c)];a/=60;d=Math.floor(a);e=a-d;a=c*(1-b);f=c*(1-b*e);e=c*(1-b*(1-e));switch(d){case 0:d=c;b=e;c=a;break;case 1:d=f;b=c;c=a;break;case 2:d=a;b=c;c=e;break;case 3:d=a;b=f;break;case 4:d=e;b=a;break;default:d=c,b=a,c=f}return new CAAT.Module.ColorUtil.Color(Math.round(255*d),Math.round(255*b),Math.round(255*c))},interpolate:function(a,b,c,d,e,f,g,h){if(0>=h)return{r:a,g:b,b:c};if(h>=g)return{r:d,g:e,b:f};a=a+(d-a)/g*h>>0;b=b+(e-b)/g*h>>0;c=c+(f-c)/g*h>>0;255<a?a=255:0>a&&(a=0);255<b?b=255:0>b&&(b=0);255<c?c=255:0>c&&(c=0);return{r:a,g:b,b:c}},makeRGBColorRamp:function(a,b,c){var d=[],e=a.length-1;b/=e;var f,g,h,k,m,n,p,r,q,t,u,v,x,w;for(f=0;f<e;f+=1)for(p=a[f],r=p>>24&255,q=(p&16711680)>>16,t=(p&65280)>>8,p&=255,g=a[f+1],u=g>>24&255,v=(g&16711680)>>16,x=(g&65280)>>8,g&=255,u=(u-r)/b,v=(v-q)/b,x=(x-t)/b,w=(g-p)/b,g=0;g<b;g+=1){h=r+u*g>>0;k=q+v*g>>0;m=t+x*g>>0;n=p+w*g>>0;var y=CAAT.Module.ColorUtil.Color.RampEnumeration;switch(c){case y.RAMP_RGBA:d.push("argb("+h+","+k+","+m+","+n+")");break;case y.RAMP_RGB:d.push("rgb("+k+","+m+","+n+")");break;case y.RAMP_CHANNEL_RGB:d.push(4278190080|k<<16|m<<8|n);break;case y.RAMP_CHANNEL_RGBA:d.push(h<<24|k<<16|m<<8|n);break;case y.RAMP_CHANNEL_RGBA_ARRAY:d.push([k,m,n,h]);break;case y.RAMP_CHANNEL_RGB_ARRAY:d.push([k,m,n])}}return d},random:function(){for(var a="#",b=0;3>b;b++)a+="0123456789abcdef"[16*Math.random()>>0];return a}},extendsWith:{__init:function(a,b,c){this.r=a||255;this.g=b||255;this.b=c||255;return this},r:255,g:255,b:255,toHex:function(){return("000000"+((this.r<<16)+(this.g<<8)+this.b).toString(16)).slice(-6)}}});CAAT.Module({defines:"CAAT.Module.Debug.Debug",depends:["CAAT.Event.AnimationLoop"],extendsWith:{width:0,height:0,canvas:null,ctx:null,statistics:null,framerate:null,textContainer:null,textFPS:null,textEntitiesTotal:null,textEntitiesActive:null,textDraws:null,textDrawTime:null,textRAFTime:null,textDirtyRects:null,textDiscardDR:null,frameTimeAcc:0,frameRAFAcc:0,canDebug:!1,SCALE:60,debugTpl:'    <style type="text/css">        #caat-debug {            z-index: 10000;            position:fixed;            bottom:0;            left:0;            width:100%;            background-color: rgba(0,0,0,0.8);        }        #caat-debug.caat_debug_max {            margin-bottom: 0px;        }        .caat_debug_bullet {            display:inline-block;            background-color:#f00;            width:8px;            height:8px;            border-radius: 4px;            margin-left:10px;            margin-right:2px;        }        .caat_debug_description {            font-size:11px;            font-family: helvetica, arial;            color: #aaa;            display: inline-block;        }        .caat_debug_value {            font-size:11px;            font-family: helvetica, arial;            color: #fff;            width:25px;            text-align: right;            display: inline-block;            margin-right: .3em;        }        .caat_debug_indicator {            float: right;        }        #debug_tabs {            border-top: 1px solid #888;            height:25px;        }        .tab_max_min {            font-family: helvetica, arial;            font-size: 12px;            font-weight: bold;            color: #888;            border-right: 1px solid #888;            float: left;            cursor: pointer;            padding-left: 5px;            padding-right: 5px;            padding-top: 5px;            height: 20px;        }        .debug_tabs_content_hidden {            display: none;            width: 100%;        }        .debug_tabs_content_visible {            display: block;            width: 100%;        }        .checkbox_enabled {            display:inline-block;            background-color:#eee;            border: 1px solid #eee;            width:6px;            height:8px;            margin-left:12px;            margin-right:2px;            cursor: pointer;        }        .checkbox_disabled {            display:inline-block;            width:6px;            height:8px;            background-color: #333;            border: 1px solid #eee;            margin-left:12px;            margin-right:2px;            cursor: pointer;        }        .checkbox_description {            font-size:11px;            font-family: helvetica, arial;            color: #fff;        }        .debug_tab {            font-family: helvetica, arial;            font-size: 12px;            color: #fff;            border-right: 1px solid #888;            float: left;            padding-left: 5px;            padding-right: 5px;            height: 20px;            padding-top: 5px;            cursor: default;        }        .debug_tab_selected {            background-color: #444;            cursor: default;        }        .debug_tab_not_selected {            background-color: #000;            cursor: pointer;        }    </style>    <div id="caat-debug">        <div id="debug_tabs">            <span class="tab_max_min" onCLick="javascript: var debug = document.getElementById(\'debug_tabs_content\');if (debug.className === \'debug_tabs_content_visible\') {debug.className = \'debug_tabs_content_hidden\'} else {debug.className = \'debug_tabs_content_visible\'}"> CAAT Debug panel </span>            <span id="caat-debug-tab0" class="debug_tab debug_tab_selected">Performance</span>            <span id="caat-debug-tab1" class="debug_tab debug_tab_not_selected">Controls</span>            <span class="caat_debug_indicator">                <span class="caat_debug_bullet" style="background-color:#0f0;"></span>                <span class="caat_debug_description">Draw Time: </span>                <span class="caat_debug_value" id="textDrawTime">5.46</span>                <span class="caat_debug_description">ms.</span>            </span>            <span class="caat_debug_indicator">                <span class="caat_debug_bullet" style="background-color:#f00;"></span>                <span class="caat_debug_description">FPS: </span>                <span class="caat_debug_value" id="textFPS">48</span>            </span>        </div>        <div id="debug_tabs_content" class="debug_tabs_content_hidden">            <div id="caat-debug-tab0-content">                <canvas id="caat-debug-canvas" height="60"></canvas>                <div>                    <span>                        <span class="caat_debug_bullet" style="background-color:#0f0;"></span>                        <span class="caat_debug_description">RAF Time:</span>                        <span class="caat_debug_value" id="textRAFTime">20.76</span>                        <span class="caat_debug_description">ms.</span>                    </span>                    <span>                        <span class="caat_debug_bullet" style="background-color:#0ff;"></span>                        <span class="caat_debug_description">Entities Total: </span>                        <span class="caat_debug_value" id="textEntitiesTotal">41</span>                    </span>                    <span>                        <span class="caat_debug_bullet" style="background-color:#0ff;"></span>                        <span class="caat_debug_description">Entities Active: </span>                        <span class="caat_debug_value" id="textEntitiesActive">37</span>                    </span>                    <span>                        <span class="caat_debug_bullet" style="background-color:#00f;"></span>                        <span class="caat_debug_description">Draws: </span>                        <span class="caat_debug_value" id="textDraws">0</span>                    </span>                    <span>                        <span class="caat_debug_bullet" style="background-color:#00f;"></span>                        <span class="caat_debug_description">DirtyRects: </span>                        <span class="caat_debug_value" id="textDirtyRects">0</span>                    </span>                    <span>                        <span class="caat_debug_bullet" style="background-color:#00f;"></span>                        <span class="caat_debug_description">Discard DR: </span>                        <span class="caat_debug_value" id="textDiscardDR">0</span>                    </span>                </div>            </div>            <div id="caat-debug-tab1-content">                <div>                    <div>                        <span id="control-sound"></span>                        <span class="checkbox_description">Sound</span>                    </div>                    <div>                        <span id="control-music"></span>                        <span class="checkbox_description">Music</span>                    </div>                    <div>                        <span id="control-aabb"></span>                        <span class="checkbox_description">AA Bounding Boxes</span>                    </div>                    <div>                        <span id="control-bb"></span>                        <span class="checkbox_description">Bounding Boxes</span>                    </div>                    <div>                        <span id="control-dr"></span>                        <span class="checkbox_description">Dirty Rects</span>                    </div>                </div>            </div>        </div>    </div>',setScale:function(a){this.scale=a;return this},initialize:function(a,b){this.width=a=window.innerWidth;this.height=b;this.framerate={refreshInterval:CAAT.FPS_REFRESH||500,frames:0,timeLastRefresh:0,fps:0,prevFps:-1,fpsMin:1E3,fpsMax:0};if(!document.getElementById("caat-debug")){var c=document.createElement("div");c.innerHTML=this.debugTpl;document.body.appendChild(c);eval(' var __x= CAAT;        function initCheck( name, bool, callback ) {            var elem= document.getElementById(name);            if ( elem ) {                elem.className= (bool) ? "checkbox_enabled" : "checkbox_disabled";                if ( callback ) {                    elem.addEventListener( "click", (function(elem, callback) {                        return function(e) {                            elem.__value= !elem.__value;                            elem.className= (elem.__value) ? "checkbox_enabled" : "checkbox_disabled";                            callback(e,elem.__value);                        }                    })(elem, callback), false );                }                elem.__value= bool;            }        }        function setupTabs() {            var numTabs=0;            var elem;            var elemContent;            do {                elem= document.getElementById("caat-debug-tab"+numTabs);                if ( elem ) {                    elemContent= document.getElementById("caat-debug-tab"+numTabs+"-content");                    if ( elemContent ) {                        elemContent.style.display= numTabs===0 ? \'block\' : \'none\';                        elem.className= numTabs===0 ? "debug_tab debug_tab_selected" : "debug_tab debug_tab_not_selected";                        elem.addEventListener( "click", (function(tabIndex) {                            return function(e) {                                for( var i=0; i<numTabs; i++ ) {                                    var _elem= document.getElementById("caat-debug-tab"+i);                                    var _elemContent= document.getElementById("caat-debug-tab"+i+"-content");                                    _elemContent.style.display= i===tabIndex ? \'block\' : \'none\';                                    _elem.className= i===tabIndex ? "debug_tab debug_tab_selected" : "debug_tab debug_tab_not_selected";                                }                            }                        })(numTabs), false );                    }                    numTabs++;                }            } while( elem );        }        initCheck( "control-sound", __x.director[0].isSoundEffectsEnabled(), function(e, bool) {            __x.director[0].setSoundEffectsEnabled(bool);        } );        initCheck( "control-music", __x.director[0].isMusicEnabled(), function(e, bool) {            __x.director[0].setMusicEnabled(bool);        } );        initCheck( "control-aabb", CAAT.DEBUGBB, function(e,bool) {            CAAT.DEBUGAABB= bool;            __x.director[0].currentScene.dirty= true;        } );        initCheck( "control-bb", CAAT.DEBUGBB, function(e,bool) {            CAAT.DEBUGBB= bool;            if ( bool ) {                CAAT.DEBUGAABB= true;            }            __x.director[0].currentScene.dirty= true;        } );        initCheck( "control-dr", CAAT.DEBUG_DIRTYRECTS , function( e,bool ) {            CAAT.DEBUG_DIRTYRECTS= bool;        });        setupTabs();')}this.canvas=document.getElementById("caat-debug-canvas");if(null===this.canvas)this.canDebug=!1;else return this.canvas.width=a,this.canvas.height=b,this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.width,this.height),this.textFPS=document.getElementById("textFPS"),this.textDrawTime=document.getElementById("textDrawTime"),this.textRAFTime=document.getElementById("textRAFTime"),this.textEntitiesTotal=document.getElementById("textEntitiesTotal"),this.textEntitiesActive=document.getElementById("textEntitiesActive"),this.textDraws=document.getElementById("textDraws"),this.textDirtyRects=document.getElementById("textDirtyRects"),this.textDiscardDR=document.getElementById("textDiscardDR"),this.canDebug=!0,this},debugInfo:function(a){this.statistics=a;a=CAAT;this.frameTimeAcc+=a.FRAME_TIME;this.frameRAFAcc+=a.REQUEST_ANIMATION_FRAME_TIME;this.framerate.frames++;a=(new Date).getTime();if(a>this.framerate.timeLastRefresh+this.framerate.refreshInterval){this.framerate.fps=1E3*this.framerate.frames/(a-this.framerate.timeLastRefresh)|0;this.framerate.fpsMin=0<this.framerate.frames?Math.min(this.framerate.fpsMin,this.framerate.fps):this.framerate.fpsMin;this.framerate.fpsMax=Math.max(this.framerate.fpsMax,this.framerate.fps);this.textFPS.innerHTML=this.framerate.fps;var b=(100*this.frameTimeAcc/this.framerate.frames|0)/100;this.frameTimeAcc=0;this.textDrawTime.innerHTML=b;b=(100*this.frameRAFAcc/this.framerate.frames|0)/100;this.frameRAFAcc=0;this.textRAFTime.innerHTML=b;this.framerate.timeLastRefresh=a;this.framerate.frames=0;this.paint(b)}this.textEntitiesTotal.innerHTML=this.statistics.size_total;this.textEntitiesActive.innerHTML=this.statistics.size_active;this.textDirtyRects.innerHTML=this.statistics.size_dirtyRects;this.textDraws.innerHTML=this.statistics.draws;this.textDiscardDR.innerHTML=this.statistics.size_discarded_by_dirty_rects},paint:function(a){var b=this.ctx,c=0;b.drawImage(this.canvas,1,0,this.width-1,this.height,0,0,this.width-1,this.height);b.strokeStyle="black";b.beginPath();b.moveTo(this.width-.5,0);b.lineTo(this.width-.5,this.height);b.stroke();b.strokeStyle="#a22";b.beginPath();c=this.height-(20/this.SCALE*this.height>>0)-.5;b.moveTo(.5,c);b.lineTo(this.width+.5,c);b.stroke();b.strokeStyle="#aa2";b.beginPath();c=this.height-(30/this.SCALE*this.height>>0)-.5;b.moveTo(.5,c);b.lineTo(this.width+.5,c);b.stroke();c=Math.min(this.height-this.framerate.fps/this.SCALE*this.height,59);-1===this.framerate.prevFps&&(this.framerate.prevFps=c|0);b.strokeStyle="#0ff";b.beginPath();b.moveTo(this.width,(c|0)-.5);b.lineTo(this.width,this.framerate.prevFps-.5);b.stroke();this.framerate.prevFps=c;a=(this.height-a/this.SCALE*this.height>>0)-.5;b.strokeStyle="#ff0";b.beginPath();b.moveTo(this.width,a);b.lineTo(this.width,a);b.stroke()}}});CAAT.Module({defines:"CAAT.Module.Font.Font",aliases:"CAAT.Font",depends:["CAAT.Foundation.SpriteImage"],constants:{getFontMetrics:function(a){var b;if(CAAT.CSS_TEXT_METRICS)try{return b=CAAT.Module.Font.Font.getFontMetricsCSS(a)}catch(c){}return CAAT.Module.Font.Font.getFontMetricsNoCSS(a)},getFontMetricsNoCSS:function(a){a=/(\d+)p[x|t]/i.exec(a);var b;b=a?a[1]|0:32;a=b-1;b=b+.2*b|0;return{height:b,ascent:a,descent:b-a}},getFontMetricsCSS:function(a){function b(a){var b,c,d;d=a&&a.ownerDocument;b=d.documentElement;a=a.getBoundingClientRect();c=document.body;d=9===d.nodeType?d.defaultView||d.parentWindow:!1;return{top:a.top+(d.pageYOffset||b.scrollTop)-(b.clientTop||c.clientTop||0),left:a.left+(d.pageXOffset||b.scrollLeft)-(b.clientLeft||c.clientLeft||0)}}try{var c=document.createElement("span");c.style.font=a;c.innerHTML="Hg";var d=document.createElement("div");d.style.display="inline-block";d.style.width="1px";d.style.heigh="0px";var e=document.createElement("div");e.appendChild(c);e.appendChild(d);var f=document.body;f.appendChild(e);try{return a={},d.style.verticalAlign="baseline",a.ascent=b(d).top-b(c).top,d.style.verticalAlign="bottom",a.height=b(d).top-b(c).top,a.ascent=Math.ceil(a.ascent),a.height=Math.ceil(a.height),a.descent=a.height-a.ascent,a}finally{f.removeChild(e)}}catch(g){return null}}},extendsWith:function(){return{fontSize:10,fontSizeUnit:"px",font:"Sans-Serif",fontStyle:"",fillStyle:"#fff",strokeStyle:null,strokeSize:1,padding:0,image:null,charMap:null,height:0,ascent:0,descent:0,setPadding:function(a){this.padding=a;return this},setFontStyle:function(a){this.fontStyle=a;return this},setStrokeSize:function(a){this.strokeSize=a;return this},setFontSize:function(a){this.fontSize=a;this.fontSizeUnit="px";return this},setFont:function(a){this.font=a;return this},setFillStyle:function(a){this.fillStyle=a;return this},setStrokeStyle:function(a){this.strokeStyle=a;return this},createDefault:function(a){for(var b="",c=32;128>c;c++)b+=String.fromCharCode(c);return this.create(b,a)},create:function(a,b){this.padding=b|=0;var c=document.createElement("canvas"),d=c.getContext("2d");d.textBaseline="bottom";d.font=this.fontStyle+" "+this.fontSize+""+this.fontSizeUnit+" "+this.font;var e=0,f=[],g,h;for(g=0;g<a.length;g++){var k=Math.max(1,(d.measureText(a.charAt(g)).width>>0)+1)+2*b;f.push(k);e+=k}g=CAAT.Font.getFontMetrics(d.font);d=g.height;this.ascent=g.ascent;this.descent=g.descent;this.height=g.height;k=g.ascent;c.width=e;c.height=d;d=c.getContext("2d");d.textBaseline="alphabetic";d.font=this.fontStyle+" "+this.fontSize+""+this.fontSizeUnit+" "+this.font;d.fillStyle=this.fillStyle;d.strokeStyle=this.strokeStyle;this.charMap={};for(g=e=0;g<a.length;g++)h=a.charAt(g),d.fillText(h,e+b,k),this.strokeStyle&&(d.beginPath(),d.lineWidth=this.strokeSize,d.strokeText(h,e+b,k)),this.charMap[h]={x:e+b,width:f[g]-2*b},e+=f[g];this.image=c;return this},setAsSpriteImage:function(){var a=[],b=0,c;for(c in this.charMap){var d=c,e=this.charMap[c];a[c]={id:b++,height:this.height,xoffset:0,letter:d,yoffset:0,width:e.width,xadvance:e.width,x:e.x,y:0}}this.spriteImage=(new CAAT.Foundation.SpriteImage).initializeAsGlyphDesigner(this.image,a);return this},getAscent:function(){return this.ascent},getDescent:function(){return this.descent},stringHeight:function(){return this.height},getFontData:function(){return{height:this.height,ascent:this.ascent,descent:this.descent}},stringWidth:function(a){var b,c,d=0,e;b=0;for(c=a.length;b<c;b++)d=(e=this.charMap[a.charAt(b)])?d+e.width:d+10;return d},drawText:function(a,b,c,d){var e,f,g,h,k=this.image.height;e=0;for(f=a.length;e<f;e++)(g=this.charMap[a.charAt(e)])?(h=g.width,0<h&&0<g.height&&b.drawImage(this.image,g.x,0,h,k,c,d,h,k),c+=h):(b.strokeStyle="#f00",b.strokeRect(c,d,10,k),c+=10)},save:function(){var a=this.image.toDataURL("image/png");document.location.href=a.replace("image/png","image/octet-stream")},drawSpriteText:function(a,b){this.spriteImage.drawSpriteText(a,b)}}}});CAAT.Module({defines:"CAAT.Module.CircleManager.PackedCircle",depends:["CAAT.Module.CircleManager.PackedCircle","CAAT.Math.Point"],constants:{BOUNDS_RULE_WRAP:1,BOUNDS_RULE_CONSTRAINT:2,BOUNDS_RULE_DESTROY:4,BOUNDS_RULE_IGNORE:8},extendsWith:{__init:function(){this.boundsRule=CAAT.Module.CircleManager.PackedCircle.BOUNDS_RULE_IGNORE;this.position=new CAAT.Math.Point(0,0,0);this.offset=new CAAT.Math.Point(0,0,0);this.targetPosition=new CAAT.Math.Point(0,0,0);return this},id:0,delegate:null,position:null,offset:null,targetPosition:null,targetChaseSpeed:.02,isFixed:!1,boundsRule:0,collisionMask:0,collisionGroup:0,containsPoint:function(a){return this.position.getDistanceSquared(a)<this.radiusSquared},getDistanceSquaredFromPosition:function(a){return this.position.getDistanceSquared(a)<this.radiusSquared},intersects:function(a){var b=this.position.getDistanceSquared(a.position);return b<this.radiusSquared||b<a.radiusSquared},setPosition:function(a){this.position=a;return this},setDelegate:function(a){this.delegate=a;return this},setOffset:function(a){this.offset=a;return this},setTargetPosition:function(a){this.targetPosition=a;return this},setTargetChaseSpeed:function(a){this.targetChaseSpeed=a;return this},setIsFixed:function(a){this.isFixed=a;return this},setCollisionMask:function(a){this.collisionMask=a;return this},setCollisionGroup:function(a){this.collisionGroup=a;return this},setRadius:function(a){this.radius=a;this.radiusSquared=this.radius*this.radius;return this},initialize:function(a){if(a)for(var b in a)this[b]=a[b];return this},dealloc:function(){this.targetPosition=this.delegate=this.offset=this.position=null}}});CAAT.Module({defines:"CAAT.Module.CircleManager.PackedCircleManager",depends:["CAAT.Math.Point","CAAT.Math.Rectangle"],extendsWith:{__init:function(){this.bounds=new CAAT.Math.Rectangle},allCircles:[],numberOfCollisionPasses:1,numberOfTargetingPasses:0,bounds:null,addCircle:function(a){a.id=this.allCircles.length;this.allCircles.push(a);return this},removeCircle:function(a){var b=0,c=!1,d=this.allCircles.length;if(0===d)throw"Error: (PackedCircleManager) attempting to remove circle, and allCircles.length === 0!!";for(;d--;)if(this.allCircles[d]===a){c=!0;b=d;break}if(!c)throw"Could not locate circle in allCircles array!";this.allCircles[b].dealloc();this.allCircles[b]=null;return this},forceCirclesToMatchDelegatePositions:function(){for(var a=this.allCircles.length,b=0;b<a;b++){var c=this.allCircles[b];c&&c.delegate&&c.position.set(c.delegate.x+c.offset.x,c.delegate.y+c.offset.y)}},pushAllCirclesTowardTarget:function(a){a=new CAAT.Math.Point(0,0,0);for(var b=this.allCircles,c=b.length,d=0;d<this.numberOfTargetingPasses;d++)for(var e=0;e<c;e++){var f=b[e];f.isFixed||(a.x=f.position.x-(f.targetPosition.x+f.offset.x),a.y=f.position.y-(f.targetPosition.y+f.offset.y),a.multiply(f.targetChaseSpeed),f.position.x-=a.x,f.position.y-=a.y)}},handleCollisions:function(){this.removeExpiredElements();for(var a=new CAAT.Math.Point(0,0,0),b=this.allCircles,c=b.length,d=0;d<this.numberOfCollisionPasses;d++)for(var e=0;e<c;e++)for(var f=b[e],g=e+1;g<c;g++){var h=b[g];if(this.circlesCanCollide(f,h)){var k=h.position.x-f.position.x,m=h.position.y-
f.position.y,n=1.08*(f.radius+h.radius),p=f.position.getDistanceSquared(h.position);p<n*n-.02&&(a.x=k,a.y=m,a.normalize(),k=.5*(n-Math.sqrt(p)),a.multiply(k),h.isFixed||(f.isFixed&&a.multiply(2.2),h.position.translatePoint(a)),f.isFixed||(h.isFixed&&a.multiply(2.2),f.position.subtract(a)))}}},handleBoundaryForCircle:function(a,b){var c=a.position.x,d=a.position.y,e=a.radius,f=2*e;b=12;b&1&&c-f>this.bounds.right?a.position.x=this.bounds.left+e:b&1&&c+f<this.bounds.left&&(a.position.x=this.bounds.right-
e);b&4&&d-f>this.bounds.bottom?a.position.y=this.bounds.top-e:b&4&&d+f<this.bounds.top&&(a.position.y=this.bounds.bottom+e);b&8&&c+e>=this.bounds.right?a.position.x=a.position.x=this.bounds.right-e:b&8&&c-e<this.bounds.left&&(a.position.x=this.bounds.left+e);b&16&&d+e>this.bounds.bottom?a.position.y=this.bounds.bottom-e:b&16&&d-e<this.bounds.top&&(a.position.y=this.bounds.top+e)},getCircleAt:function(a,b,c){var d=this.allCircles,e=d.length;a=new CAAT.Math.Point(a,b,0);b=null;for(var f=Number.MAX_VALUE,g=0;g<e;g++){var h=d[g];if(h){var k=h.position.getDistanceSquared(a);k<f&&k<h.radiusSquared+c&&(f=k,b=h)}}return b},circlesCanCollide:function(a,b){return a&&b&&a!==b?!0:!1},setBounds:function(a,b,c,d){this.bounds.x=a;this.bounds.y=b;this.bounds.width=c;this.bounds.height=d},setNumberOfCollisionPasses:function(a){this.numberOfCollisionPasses=a;return this},setNumberOfTargetingPasses:function(a){this.numberOfTargetingPasses=a;return this},sortOnDistanceToTarget:function(a,b){var c=a.getDistanceSquaredFromPosition(a.targetPosition),d=b.getDistanceSquaredFromPosition(a.targetPosition),e=0;c>d?e=-1:c<d&&(e=1);return e},removeExpiredElements:function(){for(var a=this.allCircles.length;0<=a;a--)null===this.allCircles[a]&&this.allCircles.splice(a,1)},initialize:function(a){if(a)for(var b in a)this[b]=a[b];return this}}});CAAT.Module({defines:"CAAT.Module.Preloader.Preloader",extendsWith:function(){var a=function(a,c,d){this.id=a;this.path=c;this.image=new Image;this.loader=d;this.image.onload=this.onload.bind(this);this.image.onerror=this.onerror.bind(this);return this};a.prototype={id:null,path:null,image:null,loader:null,onload:function(a){this.loader.__onload(this);this.image.onload=null;this.image.onerror=null},onerror:function(a){this.loader.__onerror(this)},load:function(){this.image.src=this.path},clear:function(){this.loader=null}};return{__init:function(){this.elements=[];this.baseURL="";return this},currentGroup:null,elements:null,imageCounter:0,cfinished:null,cloaded:null,cerrored:null,loadedCount:0,baseURL:null,addElement:function(b,c){this.elements.push(new a(b,this.baseURL+c,this));return this},clear:function(){for(var a=0;a<this.elements.length;a++)this.elements[a].clear();this.elements=null},__onload:function(a){this.cloaded&&this.cloaded(a.id);this.loadedCount++;this.loadedCount===this.elements.length&&this.cfinished&&this.cfinished(this.elements)},__onerror:function(a){this.cerrored&&this.cerrored(a.id)},setBaseURL:function(a){this.baseURL=a;return this},load:function(a,c,d){this.cfinished=a;this.cloaded=c;this.cerroed=d;for(a=0;a<this.elements.length;a++)this.elements[a].load();return this}}}});CAAT.Module({defines:"CAAT.Module.Preloader.ImagePreloader",aliases:["CAAT.ImagePreloader"],extendsWith:{__init:function(){this.images=[];return this},images:null,notificationCallback:null,imageCounter:0,loadImages:function(a,b,c){a||b&&b(0,[]);var d=this,e;this.notificationCallback=b;this.images=[];for(e=0;e<a.length;e++)this.images.push({id:a[e].id,image:new Image});for(e=0;e<a.length;e++)this.images[e].image.onload=function(){d.imageCounter++;d.notificationCallback(d.imageCounter,d.images)},this.images[e].image.onerror=function(a){return function(b){c&&c(b,a)}}(e),this.images[e].image.src=a[e].url;0===a.length&&b(0,[])}}});CAAT.Module({defines:"CAAT.Module.Image.ImageUtil",depends:["CAAT.Math.Matrix"],extendsWith:{},constants:{createAlphaSpriteSheet:function(a,b,c,d,e){if(a<b){var f=a;a=b;b=f}f=document.createElement("canvas");f.width=d.width;f.height=d.height*c;var g=f.getContext("2d");g.fillStyle=e?e:"rgba(255,255,255,0)";g.fillRect(0,0,d.width,d.height*c);for(e=0;e<c;e++)g.globalAlpha=1-(a-b)/c*(e+1),g.drawImage(d,0,e*d.height);return f},rotate:function(a,b){b=b||0;if(!b)return a;var c=document.createElement("canvas");c.width=a.height;c.height=a.width;var d=c.getContext("2d");d.globalAlpha=1;d.fillStyle="rgba(0,0,0,0)";d.clearRect(0,0,c.width,c.height);var e=new CAAT.Math.Matrix;e.multiply((new CAAT.Math.Matrix).setTranslate(c.width/2,c.width/2));e.multiply((new CAAT.Math.Matrix).setRotation(b*Math.PI/180));e.multiply((new CAAT.Math.Matrix).setTranslate(-c.width/2,-c.width/2));e.transformRenderingContext(d);d.drawImage(a,0,0);return c},optimize:function(a,b,c){b>>=0;var d=!0,e=!0,f=!0,g=!0;"undefined"!==typeof c&&("undefined"!==typeof c.top&&(d=c.top),"undefined"!==typeof c.bottom&&(e=c.bottom),"undefined"!==typeof c.left&&(f=c.left),"undefined"!==typeof c.right&&(g=c.right));c=document.createElement("canvas");c.width=a.width;c.height=a.height;var h=c.getContext("2d");h.fillStyle="rgba(0,0,0,0)";h.fillRect(0,0,a.width,a.height);h.drawImage(a,0,0);var k=h.getImageData(0,0,a.width,a.height).data,m;a=0;var n=c.height-1,p=0,r=c.width-1,q=!1;if(d){for(d=0;d<c.height;d++){for(m=0;m<c.width;m++)if(k[d*c.width*4+
3+4*m]>b){q=!0;break}if(q)break}a=d}if(e){q=!1;for(d=c.height-1;d>=a;d--){for(m=0;m<c.width;m++)if(k[d*c.width*4+3+4*m]>b){q=!0;break}if(q)break}n=d}if(f){q=!1;for(m=0;m<c.width;m++){for(d=a;d<=n;d++)if(k[d*c.width*4+3+4*m]>b){q=!0;break}if(q)break}p=m}if(g){q=!1;for(m=c.width-1;m>=p;m--){for(d=a;d<=n;d++)if(k[d*c.width*4+3+4*m]>b){q=!0;break}if(q)break}r=m}if(0===p&&0===a&&c.width-1===r&&c.height-1===n)return c;b=r-p+1;e=n-a+1;f=h.getImageData(p,a,b,e);c.width=b;c.height=e;h=c.getContext("2d");h.putImageData(f,0,0);return c},createThumb:function(a,b,c,d){b=b||24;c=c||24;var e=document.createElement("canvas");e.width=b;e.height=c;var f=e.getContext("2d");if(d){var g=Math.max(a.width,a.height);d=a.width/g*b;g=a.height/g*c;f.drawImage(a,(b-d)/2,(c-g)/2,d,g)}else f.drawImage(a,0,0,b,c);return e}}});CAAT.Module({defines:"CAAT.Module.Collision.QuadTree",depends:["CAAT.Math.Rectangle"],extendsClass:"CAAT.Math.Rectangle",extendsWith:function(){return{bgActors:null,quadData:null,create:function(a,b,c,d,e,f,g){"undefined"===typeof f&&(f=32);"undefined"===typeof g&&(g=1);var h=(a+c)/2,k=(b+d)/2;this.x=a;this.y=b;this.x1=c;this.y1=d;this.width=c-a;this.height=d-b;this.bgActors=this.__getOverlappingActorList(e);if(this.bgActors.length<=g||this.width<=f)return this;this.quadData=Array(4);this.quadData[0]=(new CAAT.Module.Collision.QuadTree).create(a,b,h,k,this.bgActors);this.quadData[1]=(new CAAT.Module.Collision.QuadTree).create(h,b,c,k,this.bgActors);this.quadData[2]=(new CAAT.Module.Collision.QuadTree).create(a,k,h,d,this.bgActors);this.quadData[3]=(new CAAT.Module.Collision.QuadTree).create(h,k,c,d,this.bgActors);return this},__getOverlappingActorList:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];this.intersects(e.AABB)&&b.push(e)}return b},getOverlappingActors:function(a){var b,c,d,e=[],f;c=this.bgActors;if(this.quadData)for(b=0;4>b;b++){if(this.quadData[b].intersects(a))for(f=this.quadData[b].getOverlappingActors(a),c=0,d=f.length;c<d;c++)e.push(f[c])}else for(b=0,d=c.length;b<d;b++)f=c[b],a.intersects(f.AABB)&&e.push(f);return e}}}});CAAT.Module({defines:"CAAT.Module.Collision.SpatialHash",aliases:["CAAT.SpatialHash"],depends:["CAAT.Math.Rectangle"],extendsWith:{elements:null,width:null,height:null,rows:null,columns:null,xcache:null,ycache:null,xycache:null,rectangle:null,r0:null,r1:null,initialize:function(a,b,c,d){var e;this.elements=[];for(e=0;e<c*d;e++)this.elements.push([]);this.width=a;this.height=b;this.rows=c;this.columns=d;this.xcache=[];for(e=0;e<a;e++)this.xcache.push(e/(a/d)>>0);this.ycache=[];for(e=0;e<b;e++)this.ycache.push(e/(b/c)>>0);this.xycache=[];for(e=0;e<this.rows;e++)for(this.xycache.push([]),c=0;c<this.columns;c++)this.xycache[e].push(c+e*d);this.rectangle=(new CAAT.Math.Rectangle).setBounds(0,0,a,b);this.r0=new CAAT.Math.Rectangle;this.r1=new CAAT.Math.Rectangle;return this},clearObject:function(){var a;for(a=0;a<this.rows*this.columns;a++)this.elements[a]=[];return this},addObject:function(a){for(var b=this.__getCells(a.x|0,a.y|0,a.width|0,a.height|0),c=0;c<b.length;c++)this.elements[b[c]].push(a)},__getCells:function(a,b,c,d){var e=[];this.rectangle.contains(a,b)&&e.push(this.xycache[this.ycache[b]][this.xcache[a]]);if(this.rectangle.contains(a+c-1,b+d-1)){var f=this.xycache[this.ycache[b+d-1]][this.xcache[a+c-1]];if(f===e[0])return e;e.push(f)}if(this.rectangle.contains(a+c-1,b)){f=this.xycache[this.ycache[b]][this.xcache[a+c-1]];if(f===e[0]||f===e[1])return e;e.push(f)}this.rectangle.contains(a+c-1,b+d-1)&&(f=this.xycache[this.ycache[b+d-1]][this.xcache[a]],e.push(f));return e},solveCollision:function(a){var b;for(b=0;b<this.elements.length;b++){var c=this.elements[b];1<c.length&&this._solveCollisionCell(c,a)}},_solveCollisionCell:function(a,b){var c,d;for(c=0;c<a.length;c++){var e=a[c];this.r0.setBounds(e.x,e.y,e.width,e.height);for(d=c+1;d<a.length;d++){var f=a[d];this.r0.intersects(this.r1.setBounds(f.x,f.y,f.width,f.height))&&b(e,f)}}},collide:function(a,b,c,d,e){a|=0;b|=0;c|=0;d|=0;var f=this.__getCells(a,b,c,d),g=this.elements;this.r0.setBounds(a,b,c,d);for(a=0;a<f.length;a++)for(d=g[f[a]],b=0,c=d.length;b<c;b++){var h=d[b];this.r1.setBounds(h.x,h.y,h.width,h.height);if(this.r0.intersects(this.r1)&&e(h))return}}}});CAAT.Module({defines:"CAAT.Module.TexturePacker.TextureElement",extendsWith:{inverted:!1,image:null,u:0,v:0,glTexture:null}});CAAT.Module({defines:"CAAT.Module.TexturePacker.TextureScan",depends:["CAAT.Module.TexturePacker.TextureElement"],extendsWith:{__init:function(a){this.freeChunks=[{position:0,size:a||1024}];return this},freeChunks:null,findWhereFits:function(a){if(0===this.freeChunks.length)return[];var b=[],c;for(c=0;c<this.freeChunks.length;c++)for(var d=0;d+a<=this.freeChunks[c].size;)b.push(d+this.freeChunks[c].position),d+=a;return b},fits:function(a,b){for(var c=0,c=0;c<this.freeChunks.length;c++){var d=this.freeChunks[c];if(d.position<=a&&a+b<=d.position+d.size)return!0}return!1},substract:function(a,b){for(var c=0,c=0;c<this.freeChunks.length;c++){var d=this.freeChunks[c];if(d.position<=a&&a+b<=d.position+d.size){var e=0,f=0,g=0,h=0,e=d.position,f=a-d.position,g=a+b,h=d.position+d.size-g;this.freeChunks.splice(c,1);0<f&&this.freeChunks.splice(c++,0,{position:e,size:f});0<h&&this.freeChunks.splice(c,0,{position:g,size:h});return!0}}return!1},log:function(a){if(0===this.freeChunks.length)CAAT.log("index "+a+" empty");else{a="index "+a;for(var b=0;b<this.freeChunks.length;b++){var c=this.freeChunks[b];a+="["+c.position+","+c.size+"]"}CAAT.log(a)}}}});CAAT.Module({defines:"CAAT.Module.TexturePacker.TextureScanMap",depends:["CAAT.Module.TexturePacker.TextureScan"],extendsWith:{__init:function(a,b){this.scanMapHeight=b;this.scanMapWidth=a;this.scanMap=[];for(var c=0;c<this.scanMapHeight;c++)this.scanMap.push(new CAAT.Module.TexturePacker.TextureScan(this.scanMapWidth));return this},scanMap:null,scanMapWidth:0,scanMapHeight:0,whereFitsChunk:function(a,b){if(a>this.width||b>this.height)return null;for(var c,d,e=0;e<=this.scanMapHeight-b;){var f=null;for(c=!1;e<=this.scanMapHeight-b;e++)if(f=this.scanMap[e].findWhereFits(a),null!==f&&0<f.length){c=!0;break}if(c){for(d=0;d<f.length;d++){var g=!0;for(c=e;c<e+b;c++)if(!this.scanMap[c].fits(f[d],a)){g=!1;break}if(g)return{x:f[d],y:e}}e++}else break}return null},substract:function(a,b,c,d){for(var e=0;e<d;e++)this.scanMap[e+b].substract(a,c)||CAAT.log("Error: removing chunk ",c,d," at ",a,b)},log:function(){for(var a=0;a<this.scanMapHeight;a++)this.scanMap[a].log(a)}}});CAAT.Module({defines:"CAAT.Module.TexturePacker.TexturePage",depends:["CAAT.Module.TexturePacker.TextureScanMap"],extendsWith:{__init:function(a,b){this.width=a||1024;this.height=b||1024;this.images=[];return this},width:1024,height:1024,gl:null,texture:null,allowImagesInvertion:!1,padding:4,scan:null,images:null,criteria:"area",initialize:function(a){this.gl=a;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);this.texture=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.texture);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);for(var b=new Uint8Array(this.width*this.height*4),c=0;c<4*this.width*this.height;)b[c++]=0,b[c++]=0,b[c++]=0,b[c++]=0;a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,b);a.enable(a.BLEND);for(b=0;b<this.images.length;b++)c=this.images[b],c.inverted&&(c=CAAT.Module.Image.ImageUtil.rotate(c,-90)),a.texSubImage2D(a.TEXTURE_2D,0,this.images[b].__tx,this.images[b].__ty,a.RGBA,a.UNSIGNED_BYTE,c)},create:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].image;d.__texturePage||b.push(d)}this.createFromImages(b)},clear:function(){this.createFromImages([])},update:function(a,b,c,d){this.allowImagesInvertion=a;this.padding=b;100>c&&(c=100);100>d&&(d=100);this.width=c;this.height=d;this.createFromImages(this.images)},createFromImages:function(a){var b;this.scan=new CAAT.Module.TexturePacker.TextureScanMap(this.width,this.height);this.images=[];if(this.allowImagesInvertion)for(b=0;b<a.length;b++)a[b].inverted=this.allowImagesInvertion&&a[b].height<a[b].width;var c=this;a.sort(function(a,b){var f=a.width*a.height,g=b.width*b.height;return"width"===c.criteria?a.width<b.width?1:a.width>b.width?-1:0:"height"===c.criteria?a.height<b.height?1:a.height>b.height?-1:0:f<g?1:f>g?-1:0});for(b=0;b<a.length;b++)this.packImage(a[b])},addImage:function(a,b,c){this.allowImagesInvertion=b;this.padding=c;this.images.push(a);this.createFromImages(Array.prototype.slice.call(this.images))},endCreation:function(){var a=this.gl;a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.generateMipmap(a.TEXTURE_2D)},deletePage:function(){for(var a=0;a<this.images.length;a++)delete this.images[a].__texturePage,delete this.images[a].__u,delete this.images[a].__v;this.gl.deleteTexture(this.texture)},toCanvas:function(a,b){a=a||document.createElement("canvas");a.width=this.width;a.height=this.height;var c=a.getContext("2d");c.fillStyle="rgba(0,0,0,0)";c.fillRect(0,0,this.width,this.height);for(var d=0;d<this.images.length;d++)c.drawImage(this.images[d].inverted?CAAT.Modules.Image.ImageUtil.rotate(this.images[d],90):this.images[d],this.images[d].__tx,this.images[d].__ty),b&&(c.strokeStyle="red",c.strokeRect(this.images[d].__tx,this.images[d].__ty,this.images[d].__w,this.images[d].__h));b&&(c.strokeStyle="red",c.strokeRect(0,0,this.width,this.height));return a},packImage:function(a){var b,c;a.inverted?(b=a.height,c=a.width):(b=a.width,c=a.height);var d=b,e=c,f;d&&this.padding&&(f=this.padding,d+f<=this.width&&(d+=f));e&&this.padding&&(f=this.padding,e+f<=this.height&&(e+=f));f=this.scan.whereFitsChunk(d,e);null!==f?(this.images.push(a),a.__tx=f.x,a.__ty=f.y,a.__u=f.x/this.width,a.__v=f.y/this.height,a.__u1=(f.x+b)/this.width,a.__v1=(f.y+c)/this.height,a.__texturePage=this,a.__w=b,a.__h=c,this.scan.substract(f.x,f.y,d,e)):CAAT.log("Imagen ",a.src," de tamano ",a.width,a.height," no cabe.")},changeHeuristic:function(a){this.criteria=a}}});CAAT.Module({defines:"CAAT.Module.TexturePacker.TexturePageManager",depends:["CAAT.Module.TexturePacker.TexturePage"],extendsWith:{__init:function(){this.pages=[];return this},pages:null,createPages:function(a,b,c,d){for(var e=!1;!e;){e=new CAAT.Module.TexturePacker.TexturePage(b,c);e.create(d);e.initialize(a);e.endCreation();this.pages.push(e);for(var e=!0,f=0;f<d.length;f++)if(!d[f].image.__texturePage){d[f].image.width<=b&&d[f].image.height<=c&&(e=!1);break}}},deletePages:function(){for(var a=0;a<this.pages.length;a++)this.pages[a].deletePage();this.pages=null}}});CAAT.Module({defines:"CAAT.Module.LayoutUtils.RowLayout",constants:{Row:function(a,b,c){for(var d=a.width,e=0,f=0,g=0,h=0,h=-Number.MAX_VALUE,k=Number.MAX_VALUE,g=b.length-1;g;--g)k<b[g].width&&(k=b[g].width),h<b[g].height&&(h=b[g].height);c.padding_left&&(e=c.padding_left,d-=e);c.padding_right&&(d-=c.padding_right);if(c.top&&(f=parseInt(c.top,10),isNaN(f)))switch(c.top){case"center":f=(a.height-h)/2;break;case"top":f=0;break;case"bottom":f=a.height-h;break;default:f=0}a=d/b.length;g=0;for(h=b.length;g<h;g++)b[g].setLocation(e+g*a+(a-b[g].width)/2,f)}}});CAAT.Module({defines:"CAAT.Module.Initialization.Template",depends:["CAAT.Foundation.Director","CAAT.Module.Preloader.ImagePreloader"],constants:{init:function(a,b,c,d,e){c=document.getElementById(c);var f;if(CAAT.__CSS__)c&&!1===c instanceof HTMLDivElement&&(c=null),null===c&&(c=document.createElement("div"),document.body.appendChild(c));else if(c)if(c instanceof HTMLDivElement){var g=document.createElement("canvas");c.appendChild(g);c=g}else 0==c instanceof HTMLCanvasElement&&(g=document.createElement("canvas"),document.body.appendChild(g),c=g);else c=document.createElement("canvas"),document.body.appendChild(c);f=(new CAAT.Foundation.Director).initialize(a||800,b||600,c);(new CAAT.Module.Preloader.ImagePreloader).loadImages(d,function(a,b){a===b.length&&(f.emptyScenes(),f.setImagesCache(b),e(f),f.easeIn(0,CAAT.Foundation.Scene.EASE_SCALE,2E3,!1,CAAT.Foundation.Actor.ANCHOR_CENTER,(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(2.5,.4)),CAAT.loop(60))})}}});CAAT.Module({defines:"CAAT.Module.Initialization.TemplateWithSplash",depends:["CAAT.Foundation.Director","CAAT.Module.Preloader.ImagePreloader"],constants:{init:function(a,b,c,d,e,f,g,h){function k(a,b,c){var d=a.getImage("spinner"),e=a.getImage("splash"),f=a.createScene(),g=(new Date).getTime();e&&f.addChild((new CAAT.Foundation.Actor).setBackgroundImage(e,!1).setBounds(0,0,a.width,a.height).setImageTransformation(CAAT.Foundation.SpriteImage.TR_FIXED_TO_SIZE));d&&f.addChild((new CAAT.Foundation.Actor).setBackgroundImage(d).centerAt(f.width/2,f.height/2).addBehavior((new CAAT.Behavior.RotateBehavior).setValues(0,2*Math.PI).setFrameTime(0,1E3).setCycle(!0)));f.loadedImage=function(d,e){if(!e||d===e.length){var f=(new Date).getTime()-g;f<b?(f=Math.abs(b-f),f>b&&(f=b),setTimeout(function(){m(a,e,c)},f)):m(a,e,c)}};return f}function m(a,b,c){a.emptyScenes();a.setImagesCache(b);a.setClear(!0);c(a);a.setClear(CAAT.Foundation.Director.CLEAR_ALL);a.easeIn(0,CAAT.Foundation.Scene.EASE_SCALE,2E3,!1,CAAT.Foundation.Actor.ANCHOR_CENTER,(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(2.5,.4))}c=document.getElementById(c);var n;if(CAAT.__CSS__)c&&!1===c instanceof HTMLDivElement&&(c=null),null===c&&(c=document.createElement("div"),document.body.appendChild(c));else if(c)if(c instanceof HTMLDivElement){var p=document.createElement("canvas");c.appendChild(p);c=p}else 0==c instanceof HTMLCanvasElement&&(p=document.createElement("canvas"),document.body.appendChild(p),c=p);else c=document.createElement("canvas"),document.body.appendChild(c);n=(new CAAT.Foundation.Director).initialize(a||800,b||600,c);a=[];g&&a.push({id:"splash",url:g});h&&a.push({id:"spinner",url:h});n.setClear(CAAT.Foundation.Director.CLEAR_DIRTY_RECTS);(new CAAT.Module.Preloader.ImagePreloader).loadImages(a,function(a,b){if(a===b.length){n.setImagesCache(b);var c=k(n,d||5E3,f);CAAT.loop(60);e&&0<e.length?(new CAAT.Module.Preloader.ImagePreloader).loadImages(e,c.loadedImage):c.loadedImage(0,null)}})}}});(function(){CAAT.CSS={};CAAT.CSS.PREFIX=function(){for(var a="",b=["WebKit","Moz","O"],c=0;c<b.length;c++)if(window[b[c]+"CSSKeyframeRule"]){a=b[c].toLowerCase();break}CAAT.CSS.PROP_ANIMATION="-"+a+"-animation";return a}();CAAT.CSS.applyKeyframe=function(a,b,c,d,e){a.style[CAAT.CSS.PROP_ANIMATION]=b+" "+c/1E3+"s "+d/1E3+"s linear both "+(e?"infinite":"")};CAAT.CSS.unregisterKeyframes=function(a){a=CAAT.CSS.getCSSKeyframesIndex(a);null!==a&&document.styleSheets[a.sheetIndex].deleteRule(a.index)};CAAT.CSS.registerKeyframes=function(a){var b=a.name,c=a.behavior,d=a.size,e=a.overwrite;if("undefined"===typeof b||"undefined"===typeof c)throw"Keyframes must be defined by a name and a CAAT.Behavior instance.";"undefined"===typeof d&&(d=100);"undefined"===typeof e&&(e=!1);var f=CAAT.CSS.getCSSKeyframesIndex(b);if(null===f||e)return a=c.calculateKeyFramesData(CAAT.CSS.PREFIX,b,d,a.anchorX,a.anchorY),document.styleSheets&&(document.styleSheets.length||(b=document.createElement("style"),b.type="text/css",document.getElementsByTagName("head")[0].appendChild(b)),null!==f&&document.styleSheets[f.sheetIndex].deleteRule(f.index),document.styleSheets[f?f.sheetIndex:0].insertRule(a,0)),a};CAAT.CSS.getCSSKeyframesIndex=function(a){for(var b=document.styleSheets,c=b.length-1;0<=c;c--)try{for(var d=b[c],e=d.cssRules?d.cssRules:d.rules?d.rules:[],f=e.length-1;0<=f;f--)if((e[f].type===window.CSSRule.WEBKIT_KEYFRAMES_RULE||e[f].type===window.CSSRule.MOZ_KEYFRAMES_RULE)&&e[f].name===a)return{sheetIndex:c,index:f}}catch(g){}return null};CAAT.CSS.getCSSKeyframes=function(a){for(var b=document.styleSheets,c=b.length-1;0<=c;c--)try{for(var d=b[c],e=d.cssRules?d.cssRules:d.rules?d.rules:[],f=e.length-1;0<=f;f--)if((e[f].type===window.CSSRule.WEBKIT_KEYFRAMES_RULE||e[f].type===window.CSSRule.MOZ_KEYFRAMES_RULE)&&e[f].name===a)return e[f]}catch(g){}return null}})();CAAT.Module({defines:"CAAT.PathUtil.PathSegment",depends:["CAAT.Math.Rectangle","CAAT.Math.Point","CAAT.Math.Matrix","CAAT.Math.Curve"],extendsWith:function(){return{__init:function(){this.bbox=new CAAT.Math.Rectangle;return this},color:"#000",length:0,bbox:null,parent:null,setParent:function(a){this.parent=a;return this},setColor:function(a){a&&(this.color=a);return this},endCurvePosition:function(){},startCurvePosition:function(){},setPoints:function(a){},setPoint:function(a,b){},getPosition:function(a){},getLength:function(){return this.length},getBoundingBox:function(){return this.bbox},numControlPoints:function(){},getControlPoint:function(a){},endPath:function(){},getContour:function(a){},updatePath:function(a){},applyAsPath:function(a){},transform:function(a){},drawHandle:function(a,b,c){a.beginPath();a.arc(b,c,CAAT.Math.Curve.prototype.HANDLE_SIZE/2,0,2*Math.PI,!1);a.fill()}}}});CAAT.Module({defines:"CAAT.PathUtil.ArcPath",depends:["CAAT.PathUtil.PathSegment","CAAT.Math.Point","CAAT.Math.Rectangle"],aliases:["CAAT.ArcPath"],extendsClass:"CAAT.PathUtil.PathSegment",extendsWith:function(){return{__init:function(){this.__super();this.points=[];this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.newPosition=new CAAT.Math.Point;return this},points:null,cw:!0,newPosition:null,radius:0,startAngle:0,angle:2*Math.PI,arcTo:!1,setRadius:function(a){this.radius=a;return this},isArcTo:function(){return this.arcTo},setArcTo:function(a){this.arcTo=a;return this},initialize:function(a,b,c,d){this.setInitialPosition(a,b);this.setFinalPosition(a+c,b);this.angle=d||2*Math.PI;return this},applyAsPath:function(a){a=a.ctx;this.arcTo?a.arcTo(this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,this.radius):a.arc(this.points[0].x,this.points[0].y,this.radius,this.startAngle,this.angle+this.startAngle,this.cw);return this},setPoint:function(a,b){0<=b&&b<this.points.length&&(this.points[b]=a)},setPoints:function(a){this.points=[];this.points[0]=a[0];this.points[1]=a[1];this.updatePath();return this},setClockWise:function(a){this.cw=void 0!==a?a:!0;return this},isClockWise:function(){return this.cw},setInitialPosition:function(a,b){for(var c=0,d=this.points.length;c<d;c++)this.points[0].x=a,this.points[0].y=b;return this},setFinalPosition:function(a,b){this.points[1].x=a;this.points[1].y=b;this.updatePath(this.points[1]);return this},endCurvePosition:function(){return this.points[0]},startCurvePosition:function(){return this.points[0]},getPosition:function(a){if(1<a||0>a)a%=1;0>a&&(a=1+a);-1===this.length?this.newPosition.set(this.points[0].x,this.points[0].y):(a=this.angle*a*(this.cw?1:-1)+this.startAngle,this.newPosition.set(this.points[0].x+this.radius*Math.cos(a),this.points[0].y+this.radius*Math.sin(a)));return this.newPosition},initialPositionX:function(){return this.points[0].x},finalPositionX:function(){return this.points[1].x},paint:function(a,b){var c=a.ctx;c.save();c.strokeStyle=this.color;c.beginPath();this.arcTo?c.arcTo(this.points[0].x,this.points[0].y,this.points[1].x,this.points[1].y,this.radius):c.arc(this.points[0].x,this.points[0].y,this.radius,this.startAngle,this.startAngle+this.angle,this.cw);c.stroke();if(b){c.globalAlpha=.5;c.fillStyle="#7f7f00";for(var d=0;d<this.points.length;d++)this.drawHandle(c,this.points[d].x,this.points[d].y)}c.restore()},numControlPoints:function(){return this.points.length},getControlPoint:function(a){return this.points[a]},getContour:function(a){for(var b=[],c=0;c<a;c++)b.push({x:this.points[0].x+this.radius*Math.cos(c*Math.PI/(a/2)),y:this.points[0].y+this.radius*Math.sin(c*Math.PI/(a/2))});return b},getPositionFromLength:function(a){return this.getPosition(a/this.length*(this.cw?1:-1))},updatePath:function(a){this.points[1]===a?(this.arcTo||(this.radius=Math.sqrt((this.points[0].x-this.points[1].x)*(this.points[0].x-this.points[1].x)+(this.points[0].y-this.points[1].y)*(this.points[0].y-this.points[1].y))),this.length=this.angle*this.radius,this.startAngle=Math.atan2(this.points[1].y-this.points[0].y,this.points[1].x-this.points[0].x)):this.points[0]===a&&this.points[1].set(this.points[0].x+this.radius*Math.cos(this.startAngle),this.points[0].y+this.radius*Math.sin(this.startAngle));this.bbox.setEmpty();this.bbox.x=this.points[0].x-this.radius;this.bbox.y=this.points[0].y-this.radius;this.bbox.x1=this.points[0].x+this.radius;this.bbox.y1=this.points[0].y+this.radius;this.bbox.width=2*this.radius;this.bbox.height=2*this.radius;return this}}}});CAAT.Module({defines:"CAAT.PathUtil.CurvePath",depends:["CAAT.PathUtil.PathSegment","CAAT.Math.Point","CAAT.Math.Bezier"],aliases:["CAAT.CurvePath"],extendsClass:"CAAT.PathUtil.PathSegment",extendsWith:function(){return{__init:function(){this.__super();this.newPosition=new CAAT.Math.Point(0,0,0);return this},curve:null,newPosition:null,applyAsPath:function(a){this.curve.applyAsPath(a);return this},setPoint:function(a,b){this.curve&&this.curve.setPoint(a,b)},setPoints:function(a){var b=new CAAT.Math.Bezier;b.setPoints(a);this.curve=b;return this},setQuadric:function(a,b,c,d,e,f){var g=new CAAT.Math.Bezier;g.setQuadric(a,b,c,d,e,f);this.curve=g;this.updatePath();return this},setCubic:function(a,b,c,d,e,f,g,h){var k=new CAAT.Math.Bezier;k.setCubic(a,b,c,d,e,f,g,h);this.curve=k;this.updatePath();return this},updatePath:function(a){this.curve.update();this.length=this.curve.getLength();this.curve.getBoundingBox(this.bbox);return this},getPosition:function(a){if(1<a||0>a)a%=1;0>a&&(a=1+a);this.curve.solve(this.newPosition,a);return this.newPosition},getPositionFromLength:function(a){this.curve.solve(this.newPosition,a/this.length);return this.newPosition},initialPositionX:function(){return this.curve.coordlist[0].x},finalPositionX:function(){return this.curve.coordlist[this.curve.coordlist.length-1].x},paint:function(a,b){this.curve.drawHandles=b;a.ctx.strokeStyle=this.color;this.curve.paint(a,b)},numControlPoints:function(){return this.curve.coordlist.length},getControlPoint:function(a){return this.curve.coordlist[a]},endCurvePosition:function(){return this.curve.endCurvePosition()},startCurvePosition:function(){return this.curve.startCurvePosition()},getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push({x:c/a,y:this.getPosition(c/a).y});return b}}}});CAAT.Module({defines:"CAAT.PathUtil.LinearPath",depends:["CAAT.PathUtil.PathSegment","CAAT.Math.Point"],aliases:["CAAT.LinearPath"],extendsClass:"CAAT.PathUtil.PathSegment",extendsWith:function(){return{__init:function(){this.__super();this.points=[];this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.newPosition=new CAAT.Math.Point(0,0,0);return this},points:null,newPosition:null,applyAsPath:function(a){a.ctx.lineTo(this.points[1].x,this.points[1].y)},setPoint:function(a,b){0===b?this.points[0]=a:1===b&&(this.points[1]=a)},updatePath:function(a){a=this.points[1].x-this.points[0].x;var b=this.points[1].y-this.points[0].y;this.length=Math.sqrt(a*a+b*b);this.bbox.setEmpty();this.bbox.union(this.points[0].x,this.points[0].y);this.bbox.union(this.points[1].x,this.points[1].y);return this},setPoints:function(a){this.points[0]=a[0];this.points[1]=a[1];this.updatePath();return this},setInitialPosition:function(a,b){this.points[0].x=a;this.points[0].y=b;this.newPosition.set(a,b);return this},setFinalPosition:function(a,b){this.points[1].x=a;this.points[1].y=b;return this},endCurvePosition:function(){return this.points[1]},startCurvePosition:function(){return this.points[0]},getPosition:function(a){if(1<a||0>a)a%=1;0>a&&(a=1+a);this.newPosition.set(this.points[0].x+(this.points[1].x-this.points[0].x)*a,this.points[0].y+(this.points[1].y-this.points[0].y)*a);return this.newPosition},getPositionFromLength:function(a){return this.getPosition(a/this.length)},initialPositionX:function(){return this.points[0].x},finalPositionX:function(){return this.points[1].x},paint:function(a,b){var c=a.ctx;c.save();c.strokeStyle=this.color;c.beginPath();c.moveTo(this.points[0].x,this.points[0].y);c.lineTo(this.points[1].x,this.points[1].y);c.stroke();b&&(c.globalAlpha=.5,c.fillStyle="#7f7f00",c.beginPath(),this.drawHandle(c,this.points[0].x,this.points[0].y),this.drawHandle(c,this.points[1].x,this.points[1].y));c.restore()},numControlPoints:function(){return 2},getControlPoint:function(a){if(0===a)return this.points[0];if(1===a)return this.points[1]},getContour:function(a){a=[];a.push(this.getPosition(0).clone());a.push(this.getPosition(1).clone());return a}}}});CAAT.Module({defines:"CAAT.PathUtil.RectPath",depends:["CAAT.PathUtil.PathSegment","CAAT.Math.Point","CAAT.Math.Rectangle"],aliases:["CAAT.RectPath","CAAT.ShapePath"],extendsClass:"CAAT.PathUtil.PathSegment",extendsWith:function(){return{__init:function(){this.__super();this.points=[];this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.points.push(new CAAT.Math.Point);this.newPosition=new CAAT.Math.Point;return this},points:null,cw:!0,newPosition:null,applyAsPath:function(a){a=a.ctx;this.cw?(a.lineTo(this.points[0].x,this.points[0].y),a.lineTo(this.points[1].x,this.points[1].y),a.lineTo(this.points[2].x,this.points[2].y),a.lineTo(this.points[3].x,this.points[3].y),a.lineTo(this.points[4].x,this.points[4].y)):(a.lineTo(this.points[4].x,this.points[4].y),a.lineTo(this.points[3].x,this.points[3].y),a.lineTo(this.points[2].x,this.points[2].y),a.lineTo(this.points[1].x,this.points[1].y),a.lineTo(this.points[0].x,this.points[0].y));return this},setPoint:function(a,b){0<=b&&b<this.points.length&&(this.points[b]=a)},setPoints:function(a){this.points=[];this.points.push(a[0]);this.points.push((new CAAT.Math.Point).set(a[1].x,a[0].y));this.points.push(a[1]);this.points.push((new CAAT.Math.Point).set(a[0].x,a[1].y));this.points.push(a[0].clone());this.updatePath();return this},setClockWise:function(a){this.cw=void 0!==a?a:!0;return this},isClockWise:function(){return this.cw},setInitialPosition:function(a,b){for(var c=0,d=this.points.length;c<d;c++)this.points[c].x=a,this.points[c].y=b;return this},setFinalPosition:function(a,b){this.points[2].x=a;this.points[2].y=b;this.points[1].x=a;this.points[1].y=this.points[0].y;this.points[3].x=this.points[0].x;this.points[3].y=b;this.points[4].x=this.points[0].x;this.points[4].y=this.points[0].y;this.updatePath();return this},endCurvePosition:function(){return this.points[4]},startCurvePosition:function(){return this.points[0]},getPosition:function(a){if(1<a||0>a)a%=1;0>a&&(a=1+a);if(-1===this.length)this.newPosition.set(0,0);else{var b=this.bbox.width/this.length,c=this.bbox.height/this.length,d=0,e,f=0;this.cw?(e=[0,1,2,3,4],b=[b,c,b,c]):(e=[4,3,2,1,0],b=[c,b,c,b]);for(;f<b.length;)if(d+b[f]<a)d+=b[f],f++;else break;a-=d;d=e[f];e=e[f+1];this.newPosition.set(this.points[d].x+(this.points[e].x-this.points[d].x)*a/b[f],this.points[d].y+(this.points[e].y-this.points[d].y)*a/b[f])}return this.newPosition},initialPositionX:function(){return this.points[0].x},finalPositionX:function(){return this.points[2].x},paint:function(a,b){var c=a.ctx;c.save();c.strokeStyle=this.color;c.beginPath();c.strokeRect(this.bbox.x,this.bbox.y,this.bbox.width,this.bbox.height);if(b){c.globalAlpha=.5;c.fillStyle="#7f7f00";for(var d=0;d<this.points.length;d++)this.drawHandle(c,this.points[d].x,this.points[d].y)}c.restore()},numControlPoints:function(){return this.points.length},getControlPoint:function(a){return this.points[a]},getContour:function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b]);return a},updatePath:function(a){a&&(a===this.points[0]?(this.points[1].y=a.y,this.points[3].x=a.x):a===this.points[1]?(this.points[0].y=a.y,this.points[2].x=a.x):a===this.points[2]?(this.points[3].y=a.y,this.points[1].x=a.x):a===this.points[3]&&(this.points[0].x=a.x,this.points[2].y=a.y),this.points[4].x=this.points[0].x,this.points[4].y=this.points[0].y);this.bbox.setEmpty();for(a=0;4>a;a++)this.bbox.union(this.points[a].x,this.points[a].y);this.length=2*this.bbox.width+2*this.bbox.height;this.points[0].x=this.bbox.x;this.points[0].y=this.bbox.y;this.points[1].x=this.bbox.x+this.bbox.width;this.points[1].y=this.bbox.y;this.points[2].x=this.bbox.x+this.bbox.width;this.points[2].y=this.bbox.y+this.bbox.height;this.points[3].x=this.bbox.x;this.points[3].y=this.bbox.y+this.bbox.height;this.points[4].x=this.bbox.x;this.points[4].y=this.bbox.y;return this},getPositionFromLength:function(a){return this.getPosition(a/(2*this.bbox.width+2*this.bbox.height))}}}});CAAT.Module({defines:"CAAT.PathUtil.Path",aliases:["CAAT.Path"],depends:"CAAT.PathUtil.PathSegment CAAT.PathUtil.ArcPath CAAT.PathUtil.CurvePath CAAT.PathUtil.LinearPath CAAT.PathUtil.RectPath CAAT.Math.Bezier CAAT.Math.CatmullRom CAAT.Math.Point CAAT.Math.Matrix".split(" "),extendsClass:"CAAT.PathUtil.PathSegment",extendsWith:{__init:function(){this.__super();this.newPosition=new CAAT.Math.Point(0,0,0);this.pathSegments=[];this.behaviorList=[];this.matrix=new CAAT.Math.Matrix;this.tmpMatrix=new CAAT.Math.Matrix;return this},pathSegments:null,pathSegmentDurationTime:null,pathSegmentStartTime:null,newPosition:null,pathLength:-1,beginPathX:-1,beginPathY:-1,trackPathX:-1,trackPathY:-1,ax:-1,ay:-1,point:[],interactive:!0,behaviorList:null,rb_angle:0,rb_rotateAnchorX:.5,rb_rotateAnchorY:.5,sb_scaleX:1,sb_scaleY:1,sb_scaleAnchorX:.5,sb_scaleAnchorY:.5,tAnchorX:0,tAnchorY:0,tb_x:0,tb_y:0,matrix:null,tmpMatrix:null,pathPoints:null,width:0,height:0,clipOffsetX:0,clipOffsetY:0,closed:!1,applyAsPath:function(a){var b=a.ctx;a.modelViewMatrix.transformRenderingContext(b);b.globalCompositeOperation="source-out";b.moveTo(this.getFirstPathSegment().startCurvePosition().x,this.getFirstPathSegment().startCurvePosition().y);for(var c=0;c<this.pathSegments.length;c++)this.pathSegments[c].applyAsPath(a);b.globalCompositeOperation="source-over";return this},setInteractive:function(a){this.interactive=a;return this},getFirstPathSegment:function(){return this.pathSegments.length?this.pathSegments[0]:null},getLastPathSegment:function(){return this.pathSegments.length?this.pathSegments[this.pathSegments.length-1]:null},endCurvePosition:function(){return this.pathSegments.length?this.pathSegments[this.pathSegments.length-1].endCurvePosition():(new CAAT.Math.Point).set(this.beginPathX,this.beginPathY)},startCurvePosition:function(){return this.pathSegments[0].startCurvePosition()},getCurrentPathSegment:function(){return this.pathSegments[this.pathSegments.length-1]},setLinear:function(a,b,c,d){this.pathSegments=[];this.beginPath(a,b);this.addLineTo(c,d);this.endPath();return this},setQuadric:function(a,b,c,d,e,f){this.beginPath(a,b);this.addQuadricTo(c,d,e,f);this.endPath();return this},setCubic:function(a,b,c,d,e,f,g,h){this.beginPath(a,b);this.addCubicTo(c,d,e,f,g,h);this.endPath();return this},setRectangle:function(a,b,c,d){this.beginPath(a,b);this.addRectangleTo(c,d);this.endPath();return this},setCatmullRom:function(a,b){b&&(a=a.slice(0),a.unshift(a[a.length-1]),a.push(a[1]),a.push(a[2]));for(var c=1;c<a.length-2;c++){var d=(new CAAT.PathUtil.CurvePath).setColor("#000").setParent(this),e=(new CAAT.Math.CatmullRom).setCurve(a[c-1],a[c],a[c+1],a[c+2]);d.curve=e;this.pathSegments.push(d)}return this},addSegment:function(a){a.setParent(this);this.pathSegments.push(a);return this},addArcTo:function(a,b,c,d,e,f,g){f=new CAAT.PathUtil.ArcPath;f.setArcTo(!0);f.setRadius(e);f.setInitialPosition(a,b).setFinalPosition(c,d);f.setParent(this);f.setColor(g);this.pathSegments.push(f);return this},addRectangleTo:function(a,b,c,d){var e=new CAAT.PathUtil.RectPath;e.setPoints([this.endCurvePosition(),(new CAAT.Math.Point).set(a,b)]);e.setClockWise(c);e.setColor(d);e.setParent(this);this.pathSegments.push(e);return this},addQuadricTo:function(a,b,c,d,e){var f=new CAAT.Math.Bezier;f.setPoints([this.endCurvePosition(),(new CAAT.Math.Point).set(a,b),(new CAAT.Math.Point).set(c,d)]);this.trackPathX=c;this.trackPathY=d;a=(new CAAT.PathUtil.CurvePath).setColor(e).setParent(this);a.curve=f;this.pathSegments.push(a);return this},addCubicTo:function(a,b,c,d,e,f,g){var h=new CAAT.Math.Bezier;h.setPoints([this.endCurvePosition(),(new CAAT.Math.Point).set(a,b),(new CAAT.Math.Point).set(c,d),(new CAAT.Math.Point).set(e,f)]);this.trackPathX=e;this.trackPathY=f;a=(new CAAT.PathUtil.CurvePath).setColor(g).setParent(this);a.curve=h;this.pathSegments.push(a);return this},addCatmullTo:function(a,b,c,d,e,f,g){g=(new CAAT.Math.CatmullRom).setColor(g);g.setCurve(this.trackPathX,this.trackPathY,a,b,c,d,e,f);this.trackPathX=e;this.trackPathY=f;a=(new CAAT.PathUtil.CurvePath).setParent(this);a.curve=g;this.pathSegments.push(a);return this},addLineTo:function(a,b,c){c=(new CAAT.PathUtil.LinearPath).setColor(c);c.setPoints([this.endCurvePosition(),(new CAAT.Math.Point).set(a,b)]);c.setParent(this);this.trackPathX=a;this.trackPathY=b;this.pathSegments.push(c);return this},beginPath:function(a,b){this.trackPathX=a;this.trackPathY=b;this.beginPathX=a;this.beginPathY=b;return this},closePath:function(){this.getLastPathSegment().setPoint(this.getFirstPathSegment().startCurvePosition(),this.getLastPathSegment().numControlPoints()-1);this.trackPathX=this.beginPathX;this.trackPathY=this.beginPathY;this.closed=!0;this.endPath();return this},endPath:function(){this.pathSegmentStartTime=[];this.pathSegmentDurationTime=[];this.updatePath();return this},getPosition:function(a,b){if(b&&(1<=a||0>=a)){var c,d,e;1<=a?(c=this.__getPositionImpl(.999),d=this.endCurvePosition(),e=Math.atan2(d.y-c.y,d.x-c.x),c=a%1):(c=this.__getPositionImpl(.001),d=this.startCurvePosition(),e=Math.atan2(d.y-c.y,d.x-c.x),c=-a);var f=this.newPosition,g=this.getLength();f.x=d.x+
c*g*Math.cos(e);f.y=d.y+c*g*Math.sin(e);return f}return this.__getPositionImpl(a)},__getPositionImpl:function(a){if(1<a||0>a)a%=1;0>a&&(a=1+a);for(var b=this.pathSegments,c=this.pathSegmentStartTime,d=this.pathSegmentDurationTime,e=0,f=b.length,g,h=this.newPosition,k;e!==f;){g=(f+e)/2|0;k=c[g];if(k<=a&&a<=k+d[g])return a=d[g]?(a-k)/d[g]:0,1<a?a=1:0>a&&(a=0),a=b[g].getPosition(a),h.x=a.x,h.y=a.y,h;a<k?f=g:e=g+1}return this.endCurvePosition()},getPositionFromLength:function(a){a%=this.getLength();0>a&&(a+=this.getLength());for(var b=0,c=0;c<this.pathSegments.length;c++){if(b<=a&&a<=this.pathSegments[c].getLength()+b){a-=b;a=this.pathSegments[c].getPositionFromLength(a);this.newPosition.x=a.x;this.newPosition.y=a.y;break}b+=this.pathSegments[c].getLength()}return this.newPosition},paint:function(a){for(var b=0;b<this.pathSegments.length;b++)this.pathSegments[b].paint(a,this.interactive)},release:function(){this.ay=this.ax=-1},isEmpty:function(){return!this.pathSegments.length},getNumSegments:function(){return this.pathSegments.length},getSegment:function(a){return this.pathSegments[a]},numControlPoints:function(){return this.points.length},getControlPoint:function(a){return this.points[a]},updatePath:function(a,b){var c,d;this.length=0;this.bbox.setEmpty();this.points=[];var e=Number.MAX_VALUE,f=Number.MAX_VALUE;for(c=0;c<this.pathSegments.length;c++)for(this.pathSegments[c].updatePath(a),this.length+=this.pathSegments[c].getLength(),this.bbox.unionRectangle(this.pathSegments[c].bbox),d=0;d<this.pathSegments[c].numControlPoints();d++){var g=this.pathSegments[c].getControlPoint(d);this.points.push(g);g.x<e&&(e=g.x);g.y<f&&(f=g.y)}this.clipOffsetX=-e;this.clipOffsetY=-f;this.width=this.bbox.width;this.height=this.bbox.height;this.setLocation(this.bbox.x,this.bbox.y);this.pathSegmentStartTime=[];this.pathSegmentDurationTime=[];for(c=0;c<this.pathSegments.length;c++)this.pathSegmentStartTime.push(0),this.pathSegmentDurationTime.push(0);for(c=0;c<this.pathSegments.length;c++)this.pathSegmentDurationTime[c]=this.getLength()?this.pathSegments[c].getLength()/this.getLength():0,0<c?this.pathSegmentStartTime[c]=this.pathSegmentStartTime[c-1]+this.pathSegmentDurationTime[c-1]:this.pathSegmentStartTime[0]=0,this.pathSegments[c].endPath();this.extractPathPoints();b&&b(this);return this},press:function(a,b){if(this.interactive){for(var c=CAAT.Math.Curve.prototype.HANDLE_SIZE/2,d=0;d<this.pathSegments.length;d++)for(var e=0;e<this.pathSegments[d].numControlPoints();e++){var f=this.pathSegments[d].getControlPoint(e);if(a>=f.x-c&&b>=f.y-c&&a<f.x+c&&b<f.y+c){this.point=f;return}}this.point=null}},drag:function(a,b,c){if(this.interactive&&null!==this.point){if(-1===this.ax||-1===this.ay)this.ax=a,this.ay=b;this.point.x+=a-this.ax;this.point.y+=b-this.ay;this.ax=a;this.ay=b;this.updatePath(this.point,c)}},getContour:function(a){for(var b=[],c=0;c<=a;c++)b.push((new CAAT.Math.Point).set(c/a,this.getPosition(c/a).y,0));return b},setPoints:function(a){if(this.points.length===a.length)for(var b=0;b<a.length;b++)this.points[b].x=a[b].x,this.points[b].y=a[b].y;return this},setPoint:function(a,b){0<=b&&b<this.points.length&&(this.points[b].x=a.x,this.points[b].y=a.y);return this},emptyBehaviorList:function(){this.behaviorList=[];return this},extractPathPoints:function(){if(!this.pathPoints){var a;this.pathPoints=[];for(a=0;a<this.numControlPoints();a++)this.pathPoints.push(this.getControlPoint(a).clone())}return this},addBehavior:function(a){this.behaviorList.push(a);return this},removeBehaviour:function(a){for(var b=this.behaviorList.length-1;b;)if(this.behaviorList[b]===a){this.behaviorList.splice(b,1);break}return this},removeBehaviorById:function(a){for(var b=0;b<this.behaviorList.length;b++)this.behaviorList[b].id===a&&this.behaviorList.splice(b,1);return this},applyBehaviors:function(a){for(var b=0;b<this.behaviorList.length;b++)this.behaviorList[b].apply(a,this);this.setATMatrix();for(b=0;b<this.numControlPoints();b++)this.setPoint(this.matrix.transformCoord(this.pathPoints[b].clone().translate(this.clipOffsetX,this.clipOffsetY)),b);return this},setATMatrix:function(){this.matrix.identity();this.tmpMatrix.identity();var a=this.matrix.matrix,b,c,d,e,f,g,h,k,m,n;h=this.bbox;var p=h.width,r=h.height,q=h.x,t=h.y;h=1;m=e=0;g=1;k=this.tb_x-q-this.tAnchorX*p;n=this.tb_y-t-this.tAnchorY*r;if(this.rb_angle){var u=this.rb_rotateAnchorX*p+q,v=this.rb_rotateAnchorY*r+t;k+=h*u+e*v;n+=m*u+g*v;b=Math.cos(this.rb_angle);c=Math.sin(this.rb_angle);d=h;f=m;h=d*b+e*c;e=-d*c+e*b;m=f*b+g*c;g=-f*c+g*b;k+=-h*u-e*v;n+=-m*u-g*v}if(1!=this.sb_scaleX||1!=this.sb_scaleY)p=this.sb_scaleAnchorX*p+q,r=this.sb_scaleAnchorY*r+t,k+=h*p+e*r,n+=m*p+g*r,h*=this.sb_scaleX,e*=this.sb_scaleY,m*=this.sb_scaleX,g*=this.sb_scaleY,k+=-h*p-e*r,n+=-m*p-g*r;a[0]=h;a[1]=e;a[2]=k;a[3]=m;a[4]=g;a[5]=n;return this},setRotationAnchored:function(a,b,c){this.rb_angle=a;this.rb_rotateAnchorX=b;this.rb_rotateAnchorY=c;return this},setRotationAnchor:function(a,b){this.rb_rotateAnchorX=a;this.rb_rotateAnchorY=b},setRotation:function(a){this.rb_angle=a},setScaleAnchored:function(a,b,c,d){this.sb_scaleX=a;this.sb_scaleAnchorX=c;this.sb_scaleY=b;this.sb_scaleAnchorY=d;return this},setScale:function(a,b){this.sb_scaleX=a;this.sb_scaleY=b;return this},setScaleAnchor:function(a,b){this.sb_scaleAnchorX=a;this.sb_scaleAnchorY=b;return this},setPositionAnchor:function(a,b){this.tAnchorX=a;this.tAnchorY=b;return this},setPositionAnchored:function(a,b,c,d){this.tb_x=a;this.tb_y=b;this.tAnchorX=c;this.tAnchorY=d;return this},setPosition:function(a,b){this.tb_x=a;this.tb_y=b;return this},setLocation:function(a,b){this.tb_x=a;this.tb_y=b;return this},flatten:function(a,b){for(var c=this.getPositionFromLength(0),d=(new CAAT.PathUtil.Path).beginPath(c.x,c.y),e=0;e<a;e++)c=this.getPositionFromLength(e/a*this.length),d.addLineTo(c.x,c.y);b?d.closePath():d.endPath();return d}}});CAAT.Module({defines:"CAAT.PathUtil.SVGPath",depends:["CAAT.PathUtil.Path"],extendsWith:function(){return{__init:function(){},c:0,bezierInfo:null,__skipBlank:function(a,b){for(var c=a.charAt(b);b<a.length&&(" "==c||"\n"==c||"\t"==c||","==c);)++b,c=a.charAt(b);return b},__maybeNumber:function(a,b){if(b<a.length-2){var c=a.charAt(b),d=a.charAt(b+1);return"-"==c||this.__isDigit(c)||"."===c&&this.__isDigit(d)}return!1},__isDigit:function(a){return"0"<=a&&"9">=a},__getNumber:function(a,b,c,d){b=this.__skipBlank(a,b);if(b<a.length){var e=this.__findNumber(a,b);-1!==e?(c.push(parseFloat(a.substr(b,e))),b=this.__skipBlank(a,e),d.pos=b,d.result=0):d.result=2}else d.result=1},____getNumbers:function(a,b,c,d,e){for(var f=0;f<d&&(this.__getNumber(a,b,c,e),0==e.result);f++)b=e.pos;return b},__findNumber:function(a,b){"-"==a.charAt(b)&&++b;if(!(this.__isDigit(a.charAt(b))||"."==a.charAt(b)&&this.__isDigit(a.charAt(b+1))))return-1;for(;this.__isDigit(a.charAt(b));)++b;if("."==a.charAt(b)){++b;if(!this.__isDigit(a.charAt(b)))return b;for(;this.__isDigit(a.charAt(b));)++b}return b},__parseMoveTo:function(a,b,c,d,e){var f=[];b=this.____getNumbers(a,b,f,2,e);0===e.result&&(c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY),d.beginPath(f[0],f[1]),this.__maybeNumber(a,b)&&(b=this.parseLine(a,b,c,d,e)),e.pos=b)},__parseLine:function(a,b,c,d,e){var f=[];do b=this.____getNumbers(a,b,f,2,e),c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY),d.addLineTo(f[0],f[1]);while(this.__maybeNumber(a,b));e.pos=b},__parseLineH:function(a,b,c,d,e){var f=[];do b=this.____getNumbers(a,b,f,1,e),c||(f[0]+=d.trackPathX),f[1].push(d.trackPathY),d.addLineTo(f[0],f[1]);while(this.__maybeNumber(a,b));e.pos=b},__parseLineV:function(a,b,c,d,e){var f=[d.trackPathX];do b=this.____getNumbers(a,b,f,1,e),c||(f[1]+=d.trackPathY),d.addLineTo(f[0],f[1]);while(this.__maybeNumber(a,b));e.pos=b},__parseCubic:function(a,b,c,d,e){var f=[];do if(b=this.____getNumbers(a,b,f,6,e),0===e.result)c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY,f[2]+=d.trackPathX,f[3]+=d.trackPathY,f[4]+=d.trackPathX,f[5]+=d.trackPathY),d.addCubicTo(f[0],f[1],f[2],f[3],f[4],f[5]),f.shift(),f.shift(),this.bezierInfo=f;else return;while(this.__maybeNumber(a,b));e.pos=b},__parseCubicS:function(a,b,c,d,e){var f=[];do if(b=this.____getNumbers(a,b,f,4,e),0==e.result)c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY,f[2]+=d.trackPathX,f[3]+=d.trackPathY),d.addCubicTo(this.bezierInfo[2]+(this.bezierInfo[2]-this.bezierInfo[0]),this.bezierInfo[3]+(this.bezierInfo[3]-this.bezierInfo[1]),f[0],f[1],f[2],f[3]),this.bezierInfo=f;else return;while(this.__maybeNumber(b));e.pos=b},__parseQuadricS:function(a,b,c,d,e){var f=[];do if(b=this.____getNumbers(a,b,f,4,e),0===e.result){c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY);var g,h;g=this.bezierInfo[2]+(this.bezierInfo[2]-this.bezierInfo[0]);h=this.bezierInfo[3]+(this.bezierInfo[3]-this.bezierInfo[1]);d.addQuadricTo(g,h,f[0],f[1]);this.bezierInfo=[];bezierInfo.push(g);bezierInfo.push(h);bezierInfo.push(f[0]);bezierInfo.push(f[1])}else return;while(this.__maybeNumber(b));e.pos=b},__parseQuadric:function(a,b,c,d,e){var f=[];do if(b=this.____getNumbers(a,b,f,4,e),0===e.result)c||(f[0]+=d.trackPathX,f[1]+=d.trackPathY,f[2]+=d.trackPathX,f[3]+=d.trackPathY),d.addQuadricTo(f[0],f[1],f[2],f[3]),this.bezierInfo=f;else return;while(this.__maybeNumber(b));e.pos=b},__parseClosePath:function(a,b,c,d){c.closePath();d.pos=b},parsePath:function(a){this.c=0;this.contours=[];var b=new CAAT.PathUtil.Path;this.contours.push(b);this.c=this.__skipBlank(a,this.c);if(this.c===a.length)return b;for(var c={pos:0,result:0};this.c!=a.length;){switch(a.charAt(this.c)){case"m":this.__parseMoveTo(a,this.c+1,!1,b,c);break;case"M":this.__parseMoveTo(a,this.c+1,!0,b,c);break;case"c":this.__parseCubic(a,this.c+1,!1,b,c);break;case"C":this.__parseCubic(a,this.c+1,!0,b,c);break;case"s":this.__parseCubicS(a,this.c+1,!1,b,c);break;case"S":this.__parseCubicS(a,this.c+1,!0,b,c);break;case"q":this.__parseQuadric(a,this.c+1,!1,b,c);break;case"Q":this.__parseQuadricS(a,this.c+1,!0,b,c);break;case"t":this.__parseQuadricS(a,this.c+1,!1,b,c);break;case"T":this.__parseQuadric(a,this.c+1,!0,b,c);break;case"l":this.__parseLine(a,this.c+1,!1,b,c);break;case"L":this.__parseLine(a,this.c+1,!0,b,c);break;case"h":this.__parseLineH(a,this.c+1,!1,b,c);break;case"H":this.__parseLineH(a,this.c+1,!0,b,c);break;case"v":this.__parseLineV(a,this.c+1,!1,b,c);break;case"V":this.__parseLineV(a,this.c+1,!0,b,c);break;case"z":case"Z":this.__parseClosePath(a,this.c+1,b,c),b=new CAAT.PathUtil.Path,this.contours.push(b)}if(0!=c.result)break;else this.c=c.pos}b=0;c=null;for(a=0;a<this.contours.length;a++)this.contours[a].isEmpty()||(c=this.contours[a],c.closed||c.endPath(),b++);if(1===b)return c;b=new CAAT.PathUtil.Path;for(a=0;a<this.contours.length;a++)this.contours[a].isEmpty()||b.addSegment(this.contours[a]);return b.endPath()}}}});CAAT.Module({defines:"CAAT.WebGL.GLU",depends:["CAAT.Math.Matrix3"],constants:{makePerspective:function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);var f=-a;return makeFrustum(f*b,a*b,f,a,c,d,e)},makeFrustum:function(a,b,c,d,e,f,g){var h=2*e/(b-a),k=2*e/(d-c);a=(b+a)/(b-a);c=(d+c)/(d-c);d=-(f+e)/(f-e);e=-2*f*e/(f-e);return(new CAAT.Math.Matrix3).initWithMatrix([[h,0,a,-g/2],[0,-k,c,g/2],[0,0,d,e],[0,0,-1,0]])},makeOrtho:function(a,b,c,d,e,f){var g=-(b+a)/(b-a),h=-(d+c)/(d-c),k=-(f+e)/(f-e);return(new CAAT.Math.Matrix3).initWithMatrix([[2/(b-a),0,0,g],[0,2/(d-c),0,h],[0,0,-2/(f-e),k],[0,0,0,1]])}}});CAAT.Module({defines:"CAAT.WebGL.Program",extendsWith:{__init:function(a){this.gl=a;return this},shaderProgram:null,gl:null,setAlpha:function(a){},getShader:function(a,b,c){if("x-shader/x-fragment"===b)b=a.createShader(a.FRAGMENT_SHADER);else if("x-shader/x-vertex"===b)b=a.createShader(a.VERTEX_SHADER);else return null;a.shaderSource(b,c);a.compileShader(b);return a.getShaderParameter(b,a.COMPILE_STATUS)?b:(alert(a.getShaderInfoLog(b)),null)},getDomShader:function(a,b){var c=document.getElementById(b);if(!c)return null;for(var d="",e=c.firstChild;e;)3===e.nodeType&&(d+=e.textContent),e=e.nextSibling;if("x-shader/x-fragment"===c.type)c=a.createShader(a.FRAGMENT_SHADER);else if("x-shader/x-vertex"===c.type)c=a.createShader(a.VERTEX_SHADER);else return null;a.shaderSource(c,d);a.compileShader(c);return a.getShaderParameter(c,a.COMPILE_STATUS)?c:(alert(a.getShaderInfoLog(c)),null)},initialize:function(){return this},getFragmentShader:function(){return null},getVertexShader:function(){return null},create:function(){var a=this.gl;this.shaderProgram=a.createProgram();a.attachShader(this.shaderProgram,this.getVertexShader());a.attachShader(this.shaderProgram,this.getFragmentShader());a.linkProgram(this.shaderProgram);a.useProgram(this.shaderProgram);return this},setMatrixUniform:function(a){this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,new Float32Array(a.flatten()))},useProgram:function(){this.gl.useProgram(this.shaderProgram);return this}}});CAAT.Module({defines:"CAAT.WebGL.ColorProgram",aliases:["CAAT.ColorProgram"],extendsClass:"CAAT.WebGL.Program",depends:["CAAT.WebGL.Program"],extendsWith:{__init:function(a){this.__super(a);return this},colorBuffer:null,vertexPositionBuffer:null,vertexPositionArray:null,getFragmentShader:function(){return this.getShader(this.gl,"x-shader/x-fragment","#ifdef GL_ES \nprecision highp float; \n#endif \nvarying vec4 color; \nvoid main(void) { \n  gl_FragColor = color;\n}\n")},getVertexShader:function(){return this.getShader(this.gl,"x-shader/x-vertex","attribute vec3 aVertexPosition; \nattribute vec4 aColor; \nuniform mat4 uPMatrix; \nvarying vec4 color; \nvoid main(void) { \ngl_Position = uPMatrix * vec4(aVertexPosition, 1.0); \ncolor= aColor; \n}\n")},initialize:function(){this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition");this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);this.shaderProgram.vertexColorAttribute=this.gl.getAttribLocation(this.shaderProgram,"aColor");this.gl.enableVertexAttribArray(this.shaderProgram.vertexColorAttribute);this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix");this.useProgram();this.colorBuffer=this.gl.createBuffer();this.setColor([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.vertexPositionBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer);this.vertexPositionArray=new Float32Array(6144);this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexPositionArray,this.gl.DYNAMIC_DRAW);this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0);return CAAT.ColorProgram.superclass.initialize.call(this)},setColor:function(a){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(a),this.gl.STATIC_DRAW);this.gl.vertexAttribPointer(this.shaderProgram.vertexColorAttribute,this.colorBuffer,this.gl.FLOAT,!1,0,0)}}});CAAT.Module({defines:"CAAT.WebGL.TextureProgram",aliases:["CAAT.TextureProgram"],extendsClass:"CAAT.WebGL.Program",depends:["CAAT.WebGL.Program"],extendsWith:{__init:function(a){this.__super(a);return this},vertexPositionBuffer:null,vertexPositionArray:null,vertexUVBuffer:null,vertexUVArray:null,vertexIndexBuffer:null,linesBuffer:null,prevAlpha:-1,prevR:-1,prevG:-1,prevB:-1,prevA:-1,prevTexture:null,getFragmentShader:function(){return this.getShader(this.gl,"x-shader/x-fragment","#ifdef GL_ES \nprecision highp float; \n#endif \nvarying vec2 vTextureCoord; \nuniform sampler2D uSampler; \nuniform float alpha; \nuniform bool uUseColor;\nuniform vec4 uColor;\nvoid main(void) { \nif ( uUseColor ) {\n  gl_FragColor= vec4(uColor.r*alpha, uColor.g*alpha, uColor.b*alpha, uColor.a*alpha);\n} else { \n  vec4 textureColor= texture2D(uSampler, vec2(vTextureCoord)); \n  gl_FragColor = vec4(textureColor.r*alpha, textureColor.g*alpha, textureColor.b*alpha, textureColor.a * alpha ); \n}\n}\n")},getVertexShader:function(){return this.getShader(this.gl,"x-shader/x-vertex","attribute vec3 aVertexPosition; \nattribute vec2 aTextureCoord; \nuniform mat4 uPMatrix; \nvarying vec2 vTextureCoord; \nvoid main(void) { \ngl_Position = uPMatrix * vec4(aVertexPosition, 1.0); \nvTextureCoord = aTextureCoord;\n}\n")},useProgram:function(){CAAT.TextureProgram.superclass.useProgram.call(this);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexUVBuffer);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)},initialize:function(){var a;this.linesBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.linesBuffer);var b=[];for(a=0;1024>a;a++)b[a]=a;this.linesBufferArray=new Uint16Array(b);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.linesBufferArray,this.gl.DYNAMIC_DRAW);this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition");this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);this.shaderProgram.textureCoordAttribute=this.gl.getAttribLocation(this.shaderProgram,"aTextureCoord");this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute);this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix");this.shaderProgram.samplerUniform=this.gl.getUniformLocation(this.shaderProgram,"uSampler");this.shaderProgram.alphaUniform=this.gl.getUniformLocation(this.shaderProgram,"alpha");this.shaderProgram.useColor=this.gl.getUniformLocation(this.shaderProgram,"uUseColor");this.shaderProgram.color=this.gl.getUniformLocation(this.shaderProgram,"uColor");this.setAlpha(1);this.setUseColor(!1);this.vertexPositionBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer);this.vertexPositionArray=new Float32Array(49152);this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexPositionArray,this.gl.DYNAMIC_DRAW);this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0);this.vertexUVBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexUVBuffer);this.vertexUVArray=new Float32Array(32768);this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexUVArray,this.gl.DYNAMIC_DRAW);this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,2,this.gl.FLOAT,!1,0,0);this.vertexIndexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);b=[];for(a=0;4096>a;a++)b.push(0+4*a),b.push(1+4*a),b.push(2+4*a),b.push(0+4*a),b.push(2+4*a),b.push(3+4*a);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(b),this.gl.DYNAMIC_DRAW);return CAAT.TextureProgram.superclass.initialize.call(this)},setUseColor:function(a,b,c,d,e){this.gl.uniform1i(this.shaderProgram.useColor,a?1:0);!a||this.prevA===e&&this.prevR===b&&this.prevG===c&&this.prevB===d||(this.gl.uniform4f(this.shaderProgram.color,b,c,d,e),this.prevA=e,this.prevR=b,this.prevG=c,this.prevB=d)},setTexture:function(a){if(this.prevTexture!==a){var b=this.gl;b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,a);b.uniform1i(this.shaderProgram.samplerUniform,0);this.prevTexture=a}return this},updateVertexBuffer:function(a){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.vertexPositionBuffer);b.bufferSubData(b.ARRAY_BUFFER,0,a);return this},updateUVBuffer:function(a){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,this.vertexUVBuffer);b.bufferSubData(b.ARRAY_BUFFER,0,a);return this},setAlpha:function(a){this.prevAlpha!==a&&(this.gl.uniform1f(this.shaderProgram.alphaUniform,a),this.prevAlpha=a);return this},drawLines:function(a,b,c,d,e,f,g){var h=this.gl;this.setAlpha(f);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.linesBuffer);h.lineWidth(g);this.updateVertexBuffer(a);this.setUseColor(!0,c,d,e,1);h.drawElements(h.LINES,b,h.UNSIGNED_SHORT,0);this.setAlpha(1);this.setUseColor(!1);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)},drawPolylines:function(a,b,c,d,e,f,g){var h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.linesBuffer);h.lineWidth(g);this.setAlpha(f);this.updateVertexBuffer(a);this.setUseColor(!0,c,d,e,1);h.drawElements(h.LINE_STRIP,b,h.UNSIGNED_SHORT,0);this.setAlpha(1);this.setUseColor(!1);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}});CAAT.Module({defines:"CAAT.Event.TouchInfo",aliases:["CAAT.TouchInfo"],extendsWith:{__init:function(a,b,c,d){this.identifier=a;this.pageX=this.clientX=b;this.pageY=this.clientY=c;this.target=d;this.time=(new Date).getTime();return this}}});CAAT.Module({defines:"CAAT.Event.TouchEvent",aliases:["CAAT.TouchEvent"],depends:["CAAT.Event.TouchInfo"],extendsWith:{__init:function(){this.touches=[];this.changedTouches=[];return this},time:0,source:null,sourceEvent:null,shift:!1,control:!1,alt:!1,meta:!1,touches:null,changedTouches:null,init:function(a,b,c){this.source=b;this.alt=a.altKey;this.control=a.ctrlKey;this.shift=a.shiftKey;this.meta=a.metaKey;this.sourceEvent=a;this.time=c;return this},addTouch:function(a){-1===this.touches.indexOf(a)&&this.touches.push(a);return this},addChangedTouch:function(a){-1===this.changedTouches.indexOf(a)&&this.changedTouches.push(a);return this},isAltDown:function(){return this.alt},isControlDown:function(){return this.control},isShiftDown:function(){return this.shift},isMetaDown:function(){return this.meta},getSourceEvent:function(){return this.sourceEvent}}});CAAT.Module({defines:"CAAT.Event.MouseEvent",aliases:["CAAT.MouseEvent"],depends:["CAAT.Math.Point"],extendsWith:{__init:function(){this.point=new CAAT.Math.Point(0,0,0);this.screenPoint=new CAAT.Math.Point(0,0,0);this.touches=[];return this},screenPoint:null,point:null,time:0,source:null,shift:!1,control:!1,alt:!1,meta:!1,sourceEvent:null,touches:null,init:function(a,b,c,d,e,f){this.point.set(a,b);this.source=d;this.screenPoint=e;this.alt=c.altKey;this.control=c.ctrlKey;this.shift=c.shiftKey;this.meta=c.metaKey;this.sourceEvent=c;this.x=a;this.y=b;this.time=f;return this},isAltDown:function(){return this.alt},isControlDown:function(){return this.control},isShiftDown:function(){return this.shift},isMetaDown:function(){return this.meta},getSourceEvent:function(){return this.sourceEvent}}});CAAT.Module({defines:"CAAT.Event.KeyEvent",aliases:"CAAT.KeyEvent",extendsWith:{__init:function(a,b,c,d){this.keyCode=a;this.action=b;this.modifiers=c;this.sourceEvent=d;this.preventDefault=function(){this.sourceEvent.preventDefault()};this.getKeyCode=function(){return this.keyCode};this.getAction=function(){return this.action};this.modifiers=function(){return this.modifiers};this.isShiftPressed=function(){return this.modifiers.shift};this.isControlPressed=function(){return this.modifiers.control};this.isAltPressed=function(){return this.modifiers.alt};this.getSourceEvent=function(){return this.sourceEvent}}},onCreate:function(){CAAT.KEYS={ENTER:13,BACKSPACE:8,TAB:9,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESCAPE:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,SELECT:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMALPOINT:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145,SEMICOLON:186,EQUALSIGN:187,COMMA:188,DASH:189,PERIOD:190,FORWARDSLASH:191,GRAVEACCENT:192,OPENBRACKET:219,BACKSLASH:220,CLOSEBRAKET:221,SINGLEQUOTE:222};CAAT.Keys=CAAT.KEYS;CAAT.SHIFT_KEY=16;CAAT.CONTROL_KEY=17;CAAT.ALT_KEY=18;CAAT.ENTER_KEY=13;CAAT.KEY_MODIFIERS={alt:!1,control:!1,shift:!1}}});CAAT.Module({defines:"CAAT.Event.Input",depends:["CAAT.Event.KeyEvent","CAAT.Event.MouseEvent","CAAT.Event.TouchEvent"],onCreate:function(){CAAT.setCursor=function(a){"iOS"!==navigator.browser&&(document.body.style.cursor=a)};CAAT.TOUCH_AS_MOUSE=1;CAAT.TOUCH_AS_MULTITOUCH=2;CAAT.TOUCH_BEHAVIOR=CAAT.TOUCH_AS_MOUSE;CAAT.windowResizeListeners=[];CAAT.registerResizeListener=function(a){CAAT.windowResizeListeners.push(a)};CAAT.unregisterResizeListener=function(a){for(var b=0;b<CAAT.windowResizeListeners.length;b++)if(a===CAAT.windowResizeListeners[b]){CAAT.windowResizeListeners.splice(b,1);break}};CAAT.keyListeners=[];CAAT.registerKeyListener=function(a){CAAT.keyListeners.push(a)};CAAT.accelerationIncludingGravity={x:0,y:0,z:0};CAAT.rotationRate={alpha:0,beta:0,gamma:0};CAAT.enableDeviceMotion=function(){function a(a){CAAT.rotationRate={alpha:0,beta:a[0],gamma:a[1]}}CAAT.prevOnDeviceMotion=null;CAAT.onDeviceMotion=null;window.DeviceOrientationEvent?window.addEventListener("deviceorientation",function(b){a([b.beta,b.gamma])},!0):window.DeviceMotionEvent?window.addEventListener("devicemotion",function(b){a([2*b.acceleration.x,2*b.acceleration.y])},!0):window.addEventListener("MozOrientation",function(b){a([45*-b.y,45*b.x])},!0)};window.addEventListener("keydown",function(a){var b=a.which?a.which:a.keyCode;if(b===CAAT.SHIFT_KEY)CAAT.KEY_MODIFIERS.shift=!0;else if(b===CAAT.CONTROL_KEY)CAAT.KEY_MODIFIERS.control=!0;else if(b===CAAT.ALT_KEY)CAAT.KEY_MODIFIERS.alt=!0;else for(var c=0;c<CAAT.keyListeners.length;c++)CAAT.keyListeners[c](new CAAT.KeyEvent(b,"down",{alt:CAAT.KEY_MODIFIERS.alt,control:CAAT.KEY_MODIFIERS.control,shift:CAAT.KEY_MODIFIERS.shift},a))},!1);window.addEventListener("keyup",function(a){var b=a.which?a.which:a.keyCode;if(b===CAAT.SHIFT_KEY)CAAT.KEY_MODIFIERS.shift=!1;else if(b===CAAT.CONTROL_KEY)CAAT.KEY_MODIFIERS.control=!1;else if(b===CAAT.ALT_KEY)CAAT.KEY_MODIFIERS.alt=!1;else for(var c=0;c<CAAT.keyListeners.length;c++)CAAT.keyListeners[c](new CAAT.KeyEvent(b,"up",{alt:CAAT.KEY_MODIFIERS.alt,control:CAAT.KEY_MODIFIERS.control,shift:CAAT.KEY_MODIFIERS.shift},a))},!1);window.addEventListener("resize",function(a){for(a=0;a<CAAT.windowResizeListeners.length;a++)CAAT.windowResizeListeners[a].windowResized(window.innerWidth,window.innerHeight)},!1)},extendsWith:{}});CAAT.Module({defines:"CAAT.Event.AnimationLoop",onCreate:function(){CAAT.ENDRAF=!1;CAAT.INTERVAL_ID=null;CAAT.renderEnabled=!1;CAAT.FPS=60;CAAT.NO_RAF=0;CAAT.FPS_REFRESH=500;CAAT.RAF=0;CAAT.REQUEST_ANIMATION_FRAME_TIME=0;CAAT.SET_INTERVAL=0;CAAT.FRAME_TIME=0;CAAT.currentDirector=null;CAAT.director=[];CAAT.RegisterDirector=function(a){CAAT.currentDirector||(CAAT.currentDirector=a);CAAT.director.push(a)};CAAT.getCurrentScene=function(){return CAAT.currentDirector.getCurrentScene()};CAAT.getCurrentSceneTime=function(){return CAAT.currentDirector.getCurrentScene().time};CAAT.endLoop=function(){CAAT.NO_RAF?null!==CAAT.INTERVAL_ID&&clearInterval(CAAT.INTERVAL_ID):CAAT.ENDRAF=!0;CAAT.renderEnabled=!1};CAAT.loop=function(a){if(!CAAT.renderEnabled){for(var b=0,c=CAAT.director.length;b<c;b++)CAAT.director[b].timeline=(new Date).getTime();CAAT.FPS=a||60;CAAT.renderEnabled=!0;CAAT.NO_RAF?CAAT.INTERVAL_ID=setInterval(function(){for(var a=(new Date).getTime(),b=0,c=CAAT.director.length;b<c;b++){var g=CAAT.director[b];(g.renderMode===CAAT.Foundation.Director.RENDER_MODE_CONTINUOUS||g.needsRepaint)&&g.renderFrame()}CAAT.FRAME_TIME=a-CAAT.SET_INTERVAL;CAAT.RAF&&(CAAT.REQUEST_ANIMATION_FRAME_TIME=(new Date).getTime()-CAAT.RAF);CAAT.RAF=(new Date).getTime();CAAT.SET_INTERVAL=a},1E3/CAAT.FPS):CAAT.renderFrameRAF()}};CAAT.renderFrameRAF=function(a){var b=CAAT;if(b.ENDRAF)b.ENDRAF=!1;else{a||(a=(new Date).getTime());var c=(new Date).getTime();b.REQUEST_ANIMATION_FRAME_TIME=b.RAF?a-b.RAF:16;for(var d=0,e=b.director.length;d<e;d++)b.director[d].renderFrame();b.RAF=a;b.FRAME_TIME=(new Date).getTime()-c;window.requestAnimFrame(b.renderFrameRAF,0)}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1E3/CAAT.FPS)}}()},extendsWith:function(){return{}}});CAAT.Module({defines:"CAAT.Foundation.Timer.TimerTask",aliases:["CAAT.TimerTask"],extendsWith:{startTime:0,duration:0,callback_timeout:null,callback_tick:null,callback_cancel:null,owner:null,scene:null,taskId:0,remove:!1,create:function(a,b,c,d,e){this.startTime=a;this.duration=b;this.callback_timeout=c;this.callback_tick=d;this.callback_cancel=e;return this},checkTask:function(a){var b;b=a-this.startTime;b>=this.duration?(this.remove=!0,this.callback_timeout&&this.callback_timeout(a,b,this)):this.callback_tick&&this.callback_tick(a,b,this);return this},remainingTime:function(){return this.duration-(this.scene.time-this.startTime)},reset:function(a){this.remove=!1;this.startTime=a;this.owner.ensureTimerTask(this);return this},cancel:function(){this.remove=!0;null!=this.callback_cancel&&this.callback_cancel(this.scene.time,this.scene.time-this.startTime,this);return this},addTime:function(a){this.duration+=a;return this}}});CAAT.Module({defines:"CAAT.Foundation.Timer.TimerManager",aliases:["CAAT.TimerManager"],depends:["CAAT.Foundation.Timer.TimerTask"],extendsWith:{__init:function(){this.timerList=[];return this},timerList:null,timerSequence:0,checkTimers:function(a){for(var b=this.timerList,c=b.length-1;0<=c;)b[c].remove||b[c].checkTask(a),c--},ensureTimerTask:function(a){this.hasTimer(a)||this.timerList.push(a);return this},hasTimer:function(a){for(var b=this.timerList,c=b.length-1;0<=c;){if(b[c]===a)return!0;c--}return!1},createTimer:function(a,b,c,d,e,f){a=(new CAAT.Foundation.Timer.TimerTask).create(a,b,c,d,e);a.taskId=this.timerSequence++;a.sceneTime=f.time;a.owner=this;a.scene=f;this.timerList.push(a);return a},removeExpiredTimers:function(){var a,b=this.timerList;for(a=0;a<b.length;a++)b[a].remove&&b.splice(a,1)}}});CAAT.Module({defines:"CAAT.Foundation.UI.Layout.LayoutManager",aliases:["CAAT.UI.LayoutManager"],depends:["CAAT.Behavior.Interpolator"],constants:{AXIS:{X:0,Y:1},ALIGNMENT:{LEFT:0,RIGHT:1,CENTER:2,TOP:3,BOTTOM:4,JUSTIFY:5}},extendsWith:function(){return{__init:function(){this.newChildren=[];this.padding={left:2,right:2,top:2,bottom:2};return this},newElementInterpolator:(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1.1,.7),moveElementInterpolator:(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(2),padding:null,invalid:!0,hgap:2,vgap:2,animated:!1,newChildren:null,setAnimated:function(a){this.animated=a;return this},setHGap:function(a){this.hgap=a;this.invalidateLayout();return this},setVGap:function(a){this.vgap=a;this.invalidateLayout();return this},setAllPadding:function(a){this.padding.left=a;this.padding.right=a;this.padding.top=a;this.padding.bottom=a;this.invalidateLayout();return this},setPadding:function(a,b,c,d){this.padding.left=a;this.padding.right=b;this.padding.top=c;this.padding.bottom=d;this.invalidateLayout();return this},addChild:function(a,b){this.newChildren.push(a)},removeChild:function(a){},doLayout:function(a){this.newChildren=[];this.invalid=!1},invalidateLayout:function(a){this.invalid=!0},getMinimumLayoutSize:function(a){},getPreferredLayoutSize:function(a){},isValid:function(){return!this.invalid},isInvalidated:function(){return this.invalid}}}});CAAT.Module({defines:"CAAT.Foundation.UI.Layout.BoxLayout",aliases:["CAAT.UI.BoxLayout"],depends:["CAAT.Foundation.UI.Layout.LayoutManager","CAAT.Math.Dimension"],extendsClass:"CAAT.Foundation.UI.Layout.LayoutManager",extendsWith:function(){return{axis:CAAT.Foundation.UI.Layout.LayoutManager.AXIS.Y,valign:CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.CENTER,halign:CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.CENTER,setAxis:function(a){this.axis=a;this.invalidateLayout();return this},setHorizontalAlignment:function(a){this.halign=a;this.invalidateLayout();return this},setVerticalAlignment:function(a){this.valign=a;this.invalidateLayout();return this},doLayout:function(a){this.axis===CAAT.Foundation.UI.Layout.LayoutManager.AXIS.Y?this.doLayoutVertical(a):this.doLayoutHorizontal(a);CAAT.Foundation.UI.Layout.BoxLayout.superclass.doLayout.call(this,a)},doLayoutHorizontal:function(a){var b=0,c=0,d=0,e,f,g;e=0;for(f=a.getNumChildren();e<f;e+=1)g=a.getChildAt(e),!g.preventLayout&&g.isVisible()&&g.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(c<g.height&&(c=g.height),b+=g.width,0<e&&(b+=this.hgap));switch(this.halign){case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.LEFT:b=this.padding.left;break;case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.RIGHT:b=a.width-b-this.padding.right;break;default:b=(a.width-b)/2}e=0;for(f=a.getNumChildren();e<f;e+=1)if(g=a.getChildAt(e),!g.preventLayout&&g.isVisible()&&g.isInAnimationFrame(CAAT.getCurrentSceneTime())){switch(this.valign){case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.TOP:d=this.padding.top;break;case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.BOTTOM:d=a.height-this.padding.bottom-g.height;break;default:d=(a.height-g.height)/2}this.__setActorPosition(g,b,d);b+=g.width+this.hgap}},__setActorPosition:function(a,b,c){this.animated?-1!==this.newChildren.indexOf(a)?(a.setPosition(b,c),a.setScale(0,0),a.scaleTo(1,1,500,0,.5,.5,this.newElementInterpolator)):a.moveTo(b,c,500,0,this.moveElementInterpolator):a.setPosition(b,c)},doLayoutVertical:function(a){var b=0,c=0,d,e,f;d=0;for(e=a.getNumChildren();d<e;d+=1)f=a.getChildAt(d),!f.preventLayout&&f.isVisible()&&f.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(b<f.width&&(b=f.width),c+=f.height,0<d&&(c+=this.vgap));switch(this.valign){case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.TOP:b=this.padding.top;break;case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.BOTTOM:b=a.height-c-this.padding.bottom;break;default:b=(a.height-c)/2}d=0;for(e=a.getNumChildren();d<e;d+=1)if(f=a.getChildAt(d),!f.preventLayout&&f.isVisible()&&f.isInAnimationFrame(CAAT.getCurrentSceneTime())){switch(this.halign){case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.LEFT:c=this.padding.left;break;case CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.RIGHT:c=a.width-this.padding.right-f.width;break;default:c=(a.width-f.width)/2}this.__setActorPosition(f,c,b);b+=f.height+this.vgap}},getPreferredLayoutSize:function(a){var b=new CAAT.Math.Dimension,c=0,d=0,e,f;e=0;for(f=a.getNumChildren();e<f;e+=1){var g=a.getChildAt(e);!g.preventLayout&&g.isVisible()&&g.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(g=g.getPreferredSize(),d<g.height&&(d=g.height),c+=g.width)}b.width=c;b.height=d;return b},getMinimumLayoutSize:function(a){var b=new CAAT.Math.Dimension,c=0,d=0,e,f;e=0;for(f=a.getNumChildren();e<f;e+=1){var g=a.getChildAt(e);!g.preventLayout&&g.isVisible()&&g.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(g=g.getMinimumSize(),d<g.height&&(d=g.height),c+=g.width)}b.width=c;b.height=d;return b}}}});CAAT.Module({defines:"CAAT.Foundation.UI.Layout.BorderLayout",aliases:["CAAT.UI.BorderLayout"],depends:["CAAT.Foundation.UI.Layout.LayoutManager","CAAT.Math.Dimension"],extendsClass:"CAAT.Foundation.UI.Layout.LayoutManager",extendsWith:{__init:function(){this.__super();return this},left:null,right:null,top:null,bottom:null,center:null,addChild:function(a,b){"undefined"===typeof b&&(b="center");CAAT.Foundation.UI.Layout.BorderLayout.superclass.addChild.call(this,a,b);"left"===b?this.left=a:"right"===b?this.right=a:"top"===b?this.top=a:"bottom"===b?this.bottom=a:this.center=a},removeChild:function(a){this.center===a?this.center=null:this.left===a?this.left=null:this.right===a?this.right=null:this.top===a?this.top=null:this.bottom===a&&(this.bottom=null)},__getChild:function(a){if("center"===a)return this.center;if("left"===a)return this.left;if("right"===a)return this.right;if("top"===a)return this.top;if("bottom"===a)return this.bottom},getMinimumLayoutSize:function(a){var b;a=new CAAT.Math.Dimension;null!=(b=this.__getChild("right"))&&(b=b.getMinimumSize(),a.width+=b.width+this.hgap,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("left"))&&(b=b.getMinimumSize(),a.width+=b.width+this.hgap,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("center"))&&(b=b.getMinimumSize(),a.width+=b.width,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("top"))&&(b=b.getMinimumSize(),a.width=Math.max(b.width,a.width),a.height+=b.height+this.vgap);null!=(b=this.__getChild("bottom"))&&(b=b.getMinimumSize(),a.width=Math.max(b.width,a.width),a.height+=b.height+this.vgap);a.width+=this.padding.left+this.padding.right;a.height+=this.padding.top+this.padding.bottom;return a},getPreferredLayoutSize:function(a){var b;a=new CAAT.Dimension;null!=(b=this.__getChild("left"))&&(b=b.getPreferredSize(),a.width+=b.width+this.hgap,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("right"))&&(b=b.getPreferredSize(),a.width+=b.width+this.hgap,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("center"))&&(b=b.getPreferredSize(),a.width+=b.width,a.height=Math.max(b.height,a.height));null!=(b=this.__getChild("top"))&&(b=b.getPreferredSize(),a.width=Math.max(b.width,a.width),a.height+=b.height+this.vgap);null!=(b=this.__getChild("bottom"))&&(b=b.getPreferredSize(),a.width=Math.max(b.width,a.width),a.height+=b.height+this.vgap);a.width+=this.padding.left+this.padding.right;a.height+=this.padding.top+this.padding.bottom;return a},doLayout:function(a){var b=this.padding.top,c=a.height-this.padding.bottom,d=this.padding.left,e=a.width-this.padding.right,f,g;null!=(f=this.__getChild("top"))&&(f.setSize(e-d,f.height),g=f.getPreferredSize(),f.setBounds(d,b,e-d,g.height),b+=g.height+this.vgap);null!=(f=this.__getChild("bottom"))&&(f.setSize(e-d,f.height),g=f.getPreferredSize(),f.setBounds(d,c-g.height,e-d,g.height),c-=g.height+this.vgap);null!=(f=this.__getChild("right"))&&(f.setSize(f.width,c-b),g=f.getPreferredSize(),f.setBounds(e-g.width,b,g.width,c-b),e-=g.width+this.hgap);null!=(f=this.__getChild("left"))&&(f.setSize(f.width,c-b),g=f.getPreferredSize(),f.setBounds(d,b,g.width,c-b),d+=g.width+this.hgap);null!=(f=this.__getChild("center"))&&f.setBounds(d,b,e-d,c-b);CAAT.Foundation.UI.Layout.BorderLayout.superclass.doLayout.call(this,a)}}});CAAT.Module({defines:"CAAT.Foundation.UI.Layout.GridLayout",aliases:["CAAT.UI.GridLayout"],depends:["CAAT.Foundation.UI.Layout.LayoutManager","CAAT.Math.Dimension"],extendsClass:"CAAT.Foundation.UI.Layout.LayoutManager",extendsWith:{__init:function(a,b){this.__super();this.rows=a;this.columns=b;return this},rows:0,columns:2,doLayout:function(a){for(var b=[],c=0;c<a.getNumChildren();c++){var d=a.getChildAt(c);!d.preventLayout&&d.isVisible()&&d.isInAnimationFrame(CAAT.getCurrentSceneTime())&&b.push(d)}var e=b.length;if(0!==e.length){var f=this.rows,g=this.columns;0<f?g=Math.floor((e+f-1)/f):f=Math.floor((e+g-1)/g);for(var c=(g-1)*this.hgap,d=a.width-(this.padding.left+this.padding.right),e=Math.floor((d-c)/g),h=(f-1)*this.vgap,k=a.height-(this.padding.top+this.padding.bottom),m=Math.floor((k-h)/f),h=Math.floor((k-(m*f+h))/2),k=0,n=this.padding.left+Math.floor((d-(e*g+c))/2);k<g;k++,n+=e+this.hgap)for(var p=0,r=this.padding.top+h;p<f;p++,r+=m+this.vgap)if(c=p*g+k,c<b.length&&(d=b[c],!d.preventLayout&&d.isVisible()&&d.isInAnimationFrame(CAAT.getCurrentSceneTime())))if(!this.animated)d.setBounds(n+(e-d.width)/2,r,e,m);else if(d.width!==e||d.height!==m)d.setSize(e,m),-1!==this.newChildren.indexOf(d)?(d.setPosition(n+(e-d.width)/2,r),d.setScale(.01,.01),d.scaleTo(1,1,500,0,.5,.5,this.newElementInterpolator)):d.moveTo(n+(e-d.width)/2,r,500,0,this.moveElementInterpolator);CAAT.Foundation.UI.Layout.GridLayout.superclass.doLayout.call(this,a)}},getMinimumLayoutSize:function(a){var b=this.rows,c=this.columns,d=a.getNumChildren(),e=0,f=0,g;0<b?c=Math.ceil((d+b-1)/b):b=Math.ceil((d+c-1)/c);for(g=0;g<d;g+=1){var h=a.getChildAt(g);!h.preventLayout&&h.isVisible()&&h.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(h=h.getMinimumSize(),e<h.width&&(e=h.width),f<h.height&&(f=h.height))}return new CAAT.Math.Dimension(this.padding.left+this.padding.right+c*e+(c-1)*this.hgap,this.padding.top+this.padding.bottom+b*f+(b-1)*this.vgap)},getPreferredLayoutSize:function(a){var b=this.rows,c=this.columns,d=a.getNumChildren(),e=0,f=0,g;0<b?c=Math.ceil((d+b-1)/b):b=Math.ceil((d+c-1)/c);for(g=0;g<d;g+=1){var h=a.getChildAt(g);!h.preventLayout&&h.isVisible()&&h.isInAnimationFrame(CAAT.getCurrentSceneTime())&&(h=h.getPreferredSize(),e<h.width&&(e=h.width),f<h.height&&(f=h.height))}return new CAAT.Math.Dimension(this.padding.left+this.padding.right+c*e+(c-1)*this.hgap,this.padding.top+this.padding.bottom+b*f+(b-1)*this.vgap)}}});CAAT.Module({defines:"CAAT.Foundation.SpriteImageHelper",extendsWith:{__init:function(a,b,c,d,e,f){this.x=parseFloat(a);this.y=parseFloat(b);this.width=parseFloat(c);this.height=parseFloat(d);this.setGL(a/e,b/f,(a+c-1)/e,(b+d-1)/f);return this},x:0,y:0,width:0,height:0,u:0,v:0,u1:0,v1:0,setGL:function(a,b,c,d){this.u=a;this.v=b;this.u1=c;this.v1=d;return this}}});CAAT.Module({defines:"CAAT.Foundation.SpriteImageAnimationHelper",extendsWith:function(){return{__init:function(a,b,c){this.animation=a;this.time=b;this.onEndPlayCallback=c;return this},animation:null,time:0,onEndPlayCallback:null}}});CAAT.Module({defines:"CAAT.Foundation.SpriteImage",aliases:["CAAT.SpriteImage"],depends:["CAAT.Foundation.SpriteImageHelper","CAAT.Foundation.SpriteImageAnimationHelper","CAAT.Math.Rectangle"],constants:{TR_NONE:0,TR_FLIP_HORIZONTAL:1,TR_FLIP_VERTICAL:2,TR_FLIP_ALL:3,TR_FIXED_TO_SIZE:4,TR_FIXED_WIDTH_TO_SIZE:6,TR_TILE:5},extendsWith:function(){return{__init:function(){this.paint=this.paintN;this.setAnimationImageIndex([0]);this.mapInfo={};this.animationsMap={};3===arguments.length&&this.initialize.apply(this,arguments);return this},animationImageIndex:null,prevAnimationTime:-1,changeFPS:1E3,transformation:0,spriteIndex:0,prevIndex:0,currentAnimation:null,image:null,rows:1,columns:1,width:0,height:0,singleWidth:0,singleHeight:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0,parentOffsetX:0,parentOffsetY:0,ownerActor:null,mapInfo:null,map:null,animationsMap:null,callback:null,fontScale:1,getOwnerActor:function(){return this.ownerActor},addAnimation:function(a,b,c,d){this.animationsMap[a]=new CAAT.Foundation.SpriteImageAnimationHelper(b,c,d);return this},setAnimationEndCallback:function(a){this.callback=a},playAnimation:function(a){if(a===this.currentAnimation)return this;var b=this.animationsMap[a];if(!b)return this;this.currentAnimation=a;this.setAnimationImageIndex(b.animation);this.changeFPS=b.time;this.callback=b.onEndPlayCallback;return this},setOwner:function(a){this.ownerActor=a;return this},getRows:function(){return this.rows},getColumns:function(){return this.columns},getWidth:function(){return this.mapInfo[this.spriteIndex].width},getHeight:function(){return this.mapInfo[this.spriteIndex].height},getWrappedImageWidth:function(){return this.image.width},getWrappedImageHeight:function(){return this.image.height},getRef:function(){var a=new CAAT.Foundation.SpriteImage;a.image=this.image;a.rows=this.rows;a.columns=this.columns;a.width=this.width;a.height=this.height;a.singleWidth=this.singleWidth;a.singleHeight=this.singleHeight;a.mapInfo=this.mapInfo;a.offsetX=this.offsetX;a.offsetY=this.offsetY;a.scaleX=this.scaleX;a.scaleY=this.scaleY;a.animationsMap=this.animationsMap;a.parentOffsetX=this.parentOffsetX;a.parentOffsetY=this.parentOffsetY;a.scaleFont=this.scaleFont;return a},setOffsetX:function(a){this.offsetX=a;return this},setOffsetY:function(a){this.offsetY=a;return this},setOffset:function(a,b){this.offsetX=a;this.offsetY=b;return this},initialize:function(a,b,c){isString(a)&&(a=CAAT.currentDirector.getImage(a));this.parentOffsetY=this.parentOffsetX=0;this.rows=b;this.columns=c;if(a instanceof CAAT.Foundation.SpriteImage||a instanceof CAAT.SpriteImage){this.image=a.image;var d=a.mapInfo[0];this.width=d.width;this.height=d.height;this.parentOffsetX=d.x;this.parentOffsetY=d.y;this.width=a.mapInfo[0].width;this.height=a.mapInfo[0].height}else this.image=a,this.width=a.width,this.height=a.height,this.mapInfo={};this.singleWidth=Math.floor(this.width/c);this.singleHeight=Math.floor(this.height/b);var e,f,g;if(a.__texturePage){a.__du=this.singleWidth/a.__texturePage.width;a.__dv=this.singleHeight/a.__texturePage.height;e=this.singleWidth;f=this.singleHeight;var h=this.columns;a.inverted&&(d=e,e=f,f=d,h=this.rows);a=this.image.__tx;for(var k=this.image.__ty,m=this.image.__texturePage,d=0;d<b*c;d++){g=a+(d%h>>0)*e;var n=k+(d/h>>0)*f,p=g+e,r=n+f;g=(new CAAT.Foundation.SpriteImageHelper(g,n,p-g,r-n,m.width,m.height)).setGL(g/m.width,n/m.height,p/m.width,r/m.height);this.mapInfo[d]=g}}else for(d=0;d<b*c;d++)e=(d%this.columns|0)*this.singleWidth+this.parentOffsetX,f=(d/this.columns|0)*this.singleHeight+this.parentOffsetY,g=new CAAT.Foundation.SpriteImageHelper(e,f,this.singleWidth,this.singleHeight,a.width,a.height),this.mapInfo[d]=g;return this},copy:function(a){this.initialize(a,1,1);this.mapInfo=a.mapInfo;return this},paintTiled:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];c=new CAAT.Math.Rectangle;this.ownerActor.AABB.intersect(a.AABB,c);var e=this.getWidth(),f=this.getHeight();d=(this.offsetX-this.ownerActor.x)%e;0<d&&(d-=e);var g=(this.offsetY-this.ownerActor.y)%f;0<g&&(g-=f);var e=((c.width-d)/e>>0)+
1,f=((c.height-g)/f>>0)+1,h,k=a.ctx;for(a=0;a<f;a++)for(h=0;h<e;h++)k.drawImage(this.image,b.x,b.y,b.width,b.height,c.x-this.ownerActor.x+d+h*b.width>>0,c.y-this.ownerActor.y+g+a*b.height>>0,b.width,b.height)},paintInvertedH:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a=a.ctx;a.save();a.translate((c|0)+b.width,d|0);a.scale(-1,1);a.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX>>0,this.offsetY>>0,b.width,b.height);a.restore();return this},paintInvertedV:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a=a.ctx;a.save();a.translate(c|0,d+b.height|0);a.scale(1,-1);a.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX>>0,this.offsetY>>0,b.width,b.height);a.restore();return this},paintInvertedHV:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a=a.ctx;a.save();a.translate(c|0,d+b.height|0);a.scale(1,-1);a.translate(b.width,0);a.scale(-1,1);a.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX>>0,this.offsetY>>0,b.width,b.height);a.restore();return this},paintN:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a.ctx.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX+c>>0,this.offsetY+d>>0,b.width,b.height);return this},paintAtRect:function(a,b,c,d,e,f){b=this.mapInfo[this.spriteIndex];a.ctx.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX+c>>0,this.offsetY+d>>0,e,f);return this},paintScaledWidth:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a.ctx.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX+c>>0,this.offsetY+d>>0,this.ownerActor.width,b.height);return this},paintChunk:function(a,b,c,d,e,f,g){a.drawImage(this.image,d,e,f,g,b,c,f,g)},paintTile:function(a,b,c,d){b=this.mapInfo[b];a.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX+c>>0,this.offsetY+d>>0,b.width,b.height);return this},paintScaled:function(a,b,c,d){b=this.mapInfo[this.spriteIndex];a.ctx.drawImage(this.image,b.x,b.y,b.width,b.height,this.offsetX+c>>0,this.offsetY+d>>0,this.ownerActor.width,this.ownerActor.height);return this},getCurrentSpriteImageCSSPosition:function(){var a=this.mapInfo[this.spriteIndex];return""+-(a.x+this.parentOffsetX-this.offsetX)+"px "+-(a.y+this.parentOffsetY-this.offsetY)+"px "+(this.ownerActor.transformation===CAAT.Foundation.SpriteImage.TR_TILE?"repeat":"no-repeat")},getNumImages:function(){return this.rows*this.columns},setUV:function(a,b){var c=this.image;if(c.__texturePage){var d=b,e=this.mapInfo[this.spriteIndex],f=e.u,g=e.v,h=e.u1,e=e.v1;if(this.offsetX||this.offsetY)f=c.__texturePage,g=-this.offsetY/f.height,h=(this.ownerActor.width-this.offsetX)/f.width,e=(this.ownerActor.height-
this.offsetY)/f.height,f=-this.offsetX/f.width+c.__u,g+=c.__v,h+=c.__u,e+=c.__v;c.inverted?(a[d++]=h,a[d++]=g,a[d++]=h,a[d++]=e,a[d++]=f,a[d++]=e,a[d++]=f,a[d++]=g):(a[d++]=f,a[d++]=g,a[d++]=h,a[d++]=g,a[d++]=h,a[d++]=e,a[d++]=f,a[d++]=e)}},setChangeFPS:function(a){this.changeFPS=a;return this},setSpriteTransformation:function(a){this.transformation=a;var b=CAAT.Foundation.SpriteImage;switch(a){case b.TR_FLIP_HORIZONTAL:this.paint=this.paintInvertedH;break;case b.TR_FLIP_VERTICAL:this.paint=this.paintInvertedV;break;case b.TR_FLIP_ALL:this.paint=this.paintInvertedHV;break;case b.TR_FIXED_TO_SIZE:this.paint=this.paintScaled;break;case b.TR_FIXED_WIDTH_TO_SIZE:this.paint=this.paintScaledWidth;break;case b.TR_TILE:this.paint=this.paintTiled;break;default:this.paint=this.paintN}this.ownerActor.invalidate();return this},resetAnimationTime:function(){this.prevAnimationTime=-1;return this},setAnimationImageIndex:function(a){this.animationImageIndex=a;this.spriteIndex=a[0];this.prevAnimationTime=-1;return this},setSpriteIndex:function(a){this.spriteIndex=a;return this},setSpriteIndexAtTime:function(a){if(1<this.animationImageIndex.length){if(-1===this.prevAnimationTime)this.prevAnimationTime=a,this.spriteIndex=this.animationImageIndex[0],this.prevIndex=0;else{var b;b=a-this.prevAnimationTime;b/=this.changeFPS;b%=this.animationImageIndex.length;b=Math.floor(b);b<this.prevIndex&&this.callback&&this.callback(this,a);this.prevIndex=b;this.spriteIndex=this.animationImageIndex[b]}this.ownerActor.invalidate()}},getMapInfo:function(a){return this.mapInfo[a]},initializeFromMap:function(a,b){this.initialize(a,1,1);var c,d,e=0;for(c in b)d=b[c],d=new CAAT.Foundation.SpriteImageHelper(parseFloat(d.x)+this.parentOffsetX,parseFloat(d.y)+this.parentOffsetY,parseFloat(d.width),parseFloat(d.height),a.width,a.height),this.mapInfo[c]=d,e||this.setAnimationImageIndex([c]),e++;return this},addElement:function(a,b){var c=new CAAT.Foundation.SpriteImageHelper(parseFloat(b.x)+this.parentOffsetX,parseFloat(b.y)+this.parentOffsetY,parseFloat(b.width),parseFloat(b.height),this.image.width,this.image.height);c.xoffset="undefined"===typeof b.xoffset?0:parseFloat(b.xoffset);c.yoffset="undefined"===typeof b.yoffset?0:parseFloat(b.yoffset);c.xadvance="undefined"===typeof b.xadvance?b.width:parseFloat(b.xadvance);this.mapInfo[a]=c;return this},initializeAsGlyphDesigner:function(a,b){this.initialize(a,1,1);var c,d,e=0;for(c in b){var f=b[c];d=new CAAT.Foundation.SpriteImageHelper(parseFloat(f.x)+this.parentOffsetX,parseFloat(f.y)+
this.parentOffsetX,parseFloat(f.width),parseFloat(f.height),a.width,a.height);d.xoffset="undefined"===typeof f.xoffset?0:f.xoffset;d.yoffset="undefined"===typeof f.yoffset?0:f.yoffset;d.xadvance="undefined"===typeof f.xadvance?f.width:f.xadvance;this.mapInfo[c]=d;e||this.setAnimationImageIndex([c]);e++}return this},initializeAsFontMap:function(a,b){this.initialize(a,1,1);for(var c,d=0,e=0;e<b.length;e++){var f=b[e];c=new CAAT.Foundation.SpriteImageHelper(parseFloat(d)+this.parentOffsetX,0+this.parentOffsetY,parseFloat(f.width),a.height,a.width,a.height);c.xoffset=0;c.yoffset=0;c.xadvance=f.width;d+=f.width;this.mapInfo[b[e].c]=c;e||this.setAnimationImageIndex([b[e].c])}return this},initializeAsMonoTypeFontMap:function(a,b){for(var c=[],d=b.split(""),e=a.width/d.length>>0,f=0;f<d.length;f++)c.push({c:d[f],width:e});return this.initializeAsFontMap(a,c)},stringWidth:function(a){var b,c,d=0,e;b=0;for(c=a.length;b<c;b++)(e=this.mapInfo[a.charAt(b)])&&(d+=e.xadvance*this.fontScale);return d},stringHeight:function(){if(this.fontHeight)return this.fontHeight*this.fontScale;var a=0,b;for(b in this.mapInfo){var c=this.mapInfo[b],c=c.height+c.yoffset;c>a&&(a=c)}this.fontHeight=a;return this.fontHeight*this.fontScale},drawText:function(a,b,c,d){var e,f,g;for(e=0;e<a.length;e++)if(f=this.mapInfo[a.charAt(e)])g=f.width,0<g&&0<f.height&&b.drawImage(this.image,f.x,f.y,g,f.height,c+f.xoffset*this.fontScale,d+f.yoffset*this.fontScale,g*this.fontScale,f.height*this.fontScale),c+=f.xadvance*this.fontScale},getFontData:function(){var a=.8*this.stringHeight()>>0;return{height:this.stringHeight(),ascent:a,descent:this.stringHeight()-a}}}}});CAAT.Module({defines:"CAAT.Foundation.Actor",aliases:["CAAT.Actor"],depends:"CAAT.Math.Dimension CAAT.Event.AnimationLoop CAAT.Foundation.SpriteImage CAAT.Core.Constants CAAT.Behavior.PathBehavior CAAT.Behavior.RotateBehavior CAAT.Behavior.ScaleBehavior CAAT.Behavior.Scale1Behavior CAAT.PathUtil.LinearPath CAAT.Event.AnimationLoop".split(" "),constants:{ANCHOR_CENTER:0,ANCHOR_TOP:1,ANCHOR_BOTTOM:2,ANCHOR_LEFT:3,ANCHOR_RIGHT:4,ANCHOR_TOP_LEFT:5,ANCHOR_TOP_RIGHT:6,ANCHOR_BOTTOM_LEFT:7,ANCHOR_BOTTOM_RIGHT:8,ANCHOR_CUSTOM:9,CACHE_NONE:0,CACHE_SIMPLE:1,CACHE_DEEP:2},extendsWith:function(){var a=0;return{__init:function(){this.behaviorList=[];this.lifecycleListenerList=[];this.AABB=new CAAT.Math.Rectangle;this.viewVertices=[new CAAT.Math.Point(0,0,0),new CAAT.Math.Point(0,0,0),new CAAT.Math.Point(0,0,0),new CAAT.Math.Point(0,0,0)];this.scaleAnchor=CAAT.Foundation.Actor.ANCHOR_CENTER;this.modelViewMatrix=new CAAT.Math.Matrix;this.worldModelViewMatrix=new CAAT.Math.Matrix;this.resetTransform();this.setScale(1,1);this.setRotation(0);this.id=a++;return this},__super:null,lifecycleListenerList:null,behaviorList:null,parent:null,x:0,y:0,width:0,height:0,preferredSize:null,minimumSize:null,start_time:0,duration:Number.MAX_VALUE,clip:!1,clipPath:null,tAnchorX:0,tAnchorY:0,scaleX:1,scaleY:1,scaleTX:.5,scaleTY:.5,scaleAnchor:0,rotationAngle:0,rotationY:.5,rotationX:.5,alpha:1,isGlobalAlpha:!1,frameAlpha:1,expired:!1,discardable:!1,pointed:!1,mouseEnabled:!0,visible:!0,fillStyle:null,strokeStyle:null,time:0,AABB:null,viewVertices:null,inFrame:!1,dirty:!0,wdirty:!0,oldX:-1,oldY:-1,modelViewMatrix:null,worldModelViewMatrix:null,modelViewMatrixI:null,worldModelViewMatrixI:null,glEnabled:!1,backgroundImage:null,id:null,size_active:1,size_total:1,__d_ax:-1,__d_ay:-1,gestureEnabled:!1,invalid:!0,cached:0,preventLayout:!1,isAA:!0,setPreventLayout:function(a){this.preventLayout=a;return this},invalidateLayout:function(){this.parent&&!this.parent.layoutInvalidated&&this.parent.invalidateLayout();return this},__validateLayout:function(){},setPreferredSize:function(a,c){this.preferredSize||(this.preferredSize=new CAAT.Math.Dimension);this.preferredSize.width=a;this.preferredSize.height=c;return this},getPreferredSize:function(){return this.preferredSize?this.preferredSize:this.getMinimumSize()},setMinimumSize:function(a,c){this.minimumSize||(this.minimumSize=new CAAT.Math.Dimension);this.minimumSize.width=a;this.minimumSize.height=c;return this},getMinimumSize:function(){return this.minimumSize?this.minimumSize:new CAAT.Math.Dimension(this.width,this.height)},create:function(){return this},moveTo:function(a,c,d,e,f,g){if(a!==this.x||c!==this.y){var h=this.getBehavior("__moveTo");h||(h=(new CAAT.Behavior.PathBehavior).setId("__moveTo").setValues(new CAAT.PathUtil.LinearPath),this.addBehavior(h));h.path.setInitialPosition(this.x,this.y).setFinalPosition(a,c);h.setDelayTime(e?e:0,d);f&&h.setInterpolator(f);g&&(h.lifecycleListenerList=[],h.addListener({behaviorExpired:function(a,b,c){g(a,b,c)}}));return this}},rotateTo:function(a,c,d,e,f,g){if(a!==this.rotationAngle){var h=this.getBehavior("__rotateTo");h||(h=(new CAAT.Behavior.RotateBehavior).setId("__rotateTo").setValues(0,0,.5,.5),this.addBehavior(h));h.setValues(this.rotationAngle,a,e,f).setDelayTime(d?d:0,c);g&&h.setInterpolator(g);return this}},scaleTo:function(a,c,d,e,f,g,h){if(this.scaleX!==a||this.scaleY!==c){var k=this.getBehavior("__scaleTo");k||(k=(new CAAT.Behavior.ScaleBehavior).setId("__scaleTo").setValues(1,1,1,1,.5,.5),this.addBehavior(k));k.setValues(this.scaleX,a,this.scaleY,c,f,g).setDelayTime(e?e:0,d);h&&k.setInterpolator(h);return this}},scaleXTo:function(a,c,d,e,f,g){return this.__scale1To(CAAT.Behavior.Scale1Behavior.AXIS_X,a,c,d,e,f,g)},scaleYTo:function(a,c,d,e,f,g){return this.__scale1To(CAAT.Behavior.Scale1Behavior.AXIS_Y,a,c,d,e,f,g)},__scale1To:function(a,c,d,e,f,g,h){if(!(a===CAAT.Behavior.Scale1Behavior.AXIS_X&&c===this.scaleX||a===CAAT.Behavior.Scale1Behavior.AXIS_Y&&c===this.scaleY)){var k=this.getBehavior("__scaleXTo");k||(k=(new CAAT.Behavior.Scale1Behavior).setId("__scaleXTo").setValues(1,1,a===CAAT.Behavior.Scale1Behavior.AXIS_X,.5,.5),this.addBehavior(k));k.setValues(a?this.scaleX:this.scaleY,c,f,g).setDelayTime(e?e:0,d);h&&k.setInterpolator(h);return this}},touchStart:function(a){},touchMove:function(a){},touchEnd:function(a){},gestureStart:function(a,c,d){},gestureChange:function(a,c,d){this.gestureEnabled&&(this.setRotation(a),this.setScale(c,d));return this},gestureEnd:function(a,c,d){},isVisible:function(){return this.visible},invalidate:function(){this.invalid=!0;return this},setGestureEnabled:function(a){this.gestureEnabled=!!a;return this},isGestureEnabled:function(){return this.gestureEnabled},getId:function(){return this.id},setId:function(a){this.id=a;return this},setParent:function(a){this.parent=a;return this},setBackgroundImage:function(a,c){if(a){a=a instanceof CAAT.Foundation.SpriteImage?a.getRef():isString(a)?(new CAAT.Foundation.SpriteImage).initialize(CAAT.currentDirector.getImage(a),1,1):(new CAAT.Foundation.SpriteImage).initialize(a,1,1);a.setOwner(this);this.backgroundImage=a;if("undefined"===typeof c||c)this.width=a.getWidth(),this.height=a.getHeight();this.glEnabled=!0;this.invalidate()}else this.backgroundImage=null;return this},setSpriteIndex:function(a){this.backgroundImage&&(this.backgroundImage.setSpriteIndex(a),this.invalidate());return this},setBackgroundImageOffset:function(a,c){this.backgroundImage&&this.backgroundImage.setOffset(a,c);return this},setAnimationImageIndex:function(a){this.backgroundImage&&(this.backgroundImage.resetAnimationTime(),this.backgroundImage.setAnimationImageIndex(a),this.invalidate());return this},addAnimation:function(a,c,d,e){this.backgroundImage&&this.backgroundImage.addAnimation(a,c,d,e);return this},playAnimation:function(a){this.backgroundImage&&this.backgroundImage.playAnimation(a);return this},setAnimationEndCallback:function(a){this.backgroundImage&&this.backgroundImage.setAnimationEndCallback(a);return this},resetAnimationTime:function(){this.backgroundImage&&(this.backgroundImage.resetAnimationTime(),this.invalidate());return this},setChangeFPS:function(a){this.backgroundImage&&this.backgroundImage.setChangeFPS(a);return this},setImageTransformation:function(a){this.backgroundImage&&this.backgroundImage.setSpriteTransformation(a);return this},centerOn:function(a,c){this.setPosition(a-this.width/2,c-this.height/2);return this},centerAt:function(a,c){this.setPosition(a-this.width*(.5-this.tAnchorX),c-this.height*(.5-this.tAnchorY));return this},getTextureGLPage:function(){return this.backgroundImage.image.__texturePage},setVisible:function(a){this.invalidate();CAAT.currentDirector&&CAAT.currentDirector.dirtyRectsEnabled&&!a&&this.visible&&CAAT.currentDirector.scheduleDirtyRect(this.AABB);a&&!this.visible&&(this.dirty=!0);this.visible=a;return this},setOutOfFrameTime:function(){this.setFrameTime(-1,0);return this},addListener:function(a){this.lifecycleListenerList.push(a);return this},removeListener:function(a){for(var c=this.lifecycleListenerList.length;c--;)if(this.lifecycleListenerList[c]===a){this.lifecycleListenerList.splice(c,1);break}},setGlobalAlpha:function(a){this.isGlobalAlpha=a;return this},fireEvent:function(a,c){for(var d=0;d<this.lifecycleListenerList.length;d++)this.lifecycleListenerList[d].actorLifeCycleEvent(this,a,c)},setExpired:function(a){this.expired=!0;this.fireEvent("expired",a);return this},enableEvents:function(a){this.mouseEnabled=a;return this},emptyBehaviorList:function(){this.behaviorList=[];return this},setFillStyle:function(a){this.fillStyle=a;this.invalidate();return this},setStrokeStyle:function(a){this.strokeStyle=a;this.invalidate();return this},setPaint:function(a){return this.setFillStyle(a)},setAlpha:function(a){this.alpha=a;this.invalidate();return this},resetTransform:function(){this.rotationAngle=0;this.rotationY=this.rotationX=.5;this.scaleY=this.scaleX=1;this.scaleTY=this.scaleTX=.5;this.scaleAnchor=0;this.oldY=this.oldX=-1;this.dirty=!0;return this},setFrameTime:function(a,c){this.start_time=a;this.duration=c;this.expired=!1;this.dirty=!0;return this},paint:function(a,c){if(this.backgroundImage)this.backgroundImage.paint(a,c,0,0);else if(this.fillStyle){var d=a.ctx;d.fillStyle=this.fillStyle;d.fillRect(0,0,this.width,this.height)}},setScale:function(a,c){this.scaleX=a;this.scaleY=c;this.dirty=!0;return this},getAnchorPercent:function(a){var c=[.5,.5,.5,0,.5,1,0,.5,1,.5,0,0,1,0,0,1,1,1];return{x:c[2*a],y:c[2*a+1]}},getAnchor:function(a){var c=0,d=0,e=CAAT.Foundation.Actor;switch(a){case e.ANCHOR_CENTER:d=c=.5;break;case e.ANCHOR_TOP:c=.5;d=0;break;case e.ANCHOR_BOTTOM:c=.5;d=1;break;case e.ANCHOR_LEFT:c=0;d=.5;break;case e.ANCHOR_RIGHT:c=1;d=.5;break;case e.ANCHOR_TOP_RIGHT:c=1;d=0;break;case e.ANCHOR_BOTTOM_LEFT:c=0;d=1;break;case e.ANCHOR_BOTTOM_RIGHT:d=c=1;break;case e.ANCHOR_TOP_LEFT:d=c=0}return{x:c,y:d}},setGlobalAnchor:function(a,c){this.scaleTX=this.rotationX=this.tAnchorX=a;this.scaleTY=this.rotationY=this.tAnchorY=c;this.dirty=!0;return this},setScaleAnchor:function(a,c){this.scaleTX=a;this.scaleTY=c;this.dirty=!0;return this},setScaleAnchored:function(a,c,d,e){this.scaleTX=d;this.scaleTY=e;this.scaleX=a;this.scaleY=c;this.dirty=!0;return this},setRotationAnchor:function(a,c){this.rotationX=c;this.rotationY=a;this.dirty=!0;return this},setRotation:function(a){this.rotationAngle=a;this.dirty=!0;return this},setRotationAnchored:function(a,c,d){this.rotationAngle=a;this.rotationX=c;this.rotationY=d;this.dirty=!0;return this},setSize:function(a,c){this.width=a;this.height=c;this.dirty=!0;return this},setBounds:function(a,c,d,e){this.x=a;this.y=c;this.width=d;this.height=e;this.dirty=!0;return this},setLocation:function(a,c){this.x=a;this.y=c;this.oldX=a;this.oldY=c;this.dirty=!0;return this},setPosition:function(a,c){return this.setLocation(a,c)},setPositionAnchor:function(a,c){this.tAnchorX=a;this.tAnchorY=c;return this},setPositionAnchored:function(a,c,d,e){this.setLocation(a,c);this.tAnchorX=d;this.tAnchorY=e;return this},isInAnimationFrame:function(a){return this.expired?!1:this.duration===Number.MAX_VALUE?this.start_time<=a:a>=this.start_time+this.duration?(this.expired||this.setExpired(a),!1):this.start_time<=a&&a<this.start_time+this.duration},contains:function(a,c){return 0<=a&&0<=c&&a<this.width&&c<this.height},addBehavior:function(a){this.behaviorList.push(a);return this},removeBehaviour:function(a){for(var c=this.behaviorList,d=c.length-1;d;)if(c[d]===a){c.splice(d,1);break}return this},removeBehaviorById:function(a){for(var c=this.behaviorList,d=0;d<c.length;d++)c[d].id===a&&c.splice(d,1);return this},getBehavior:function(a){for(var c=this.behaviorList,d=0;d<c.length;d++){var e=c[d];if(e.id===a)return e}return null},setDiscardable:function(a){this.discardable=a;return this},destroy:function(a){this.parent&&this.parent.removeChild(this);this.backgroundImage=null;this.emptyBehaviorList();this.fireEvent("destroyed",a);this.lifecycleListenerList=[]},modelToView:function(a){var c,d,e,f;this.dirty&&this.setModelViewMatrix();f=this.worldModelViewMatrix.matrix;if(a instanceof Array)for(var g=0;g<a.length;g++)e=a[g],c=e.x,d=e.y,e.x=c*f[0]+d*f[1]+f[2],e.y=c*f[3]+d*f[4]+f[5];else c=a.x,d=a.y,a.x=c*f[0]+d*f[1]+f[2],a.y=c*f[3]+d*f[4]+f[5];return a},modelToModel:function(a,c){this.dirty&&this.setModelViewMatrix();return c.viewToModel(this.modelToView(a))},viewToModel:function(a){this.dirty&&this.setModelViewMatrix();this.worldModelViewMatrixI=this.worldModelViewMatrix.getInverse();this.worldModelViewMatrixI.transformCoord(a);return a},findActorAtPosition:function(a){if(0===this.scaleX||0===this.scaleY||!this.visible||!this.mouseEnabled||!this.isInAnimationFrame(this.time))return null;this.modelViewMatrixI=this.modelViewMatrix.getInverse();this.modelViewMatrixI.transformCoord(a);return this.contains(a.x,a.y)?this:null},enableDrag:function(){this.ay=this.ax=0;this.asy=this.asx=1;this.screeny=this.screenx=this.ara=0;this.mouseEnter=function(a){this.__d_ay=this.__d_ax=-1;this.pointed=!0;CAAT.setCursor("move")};this.mouseExit=function(a){this.__d_ay=this.__d_ax=-1;this.pointed=!1;CAAT.setCursor("default")};this.mouseMove=function(a){};this.mouseUp=function(a){this.__d_ay=this.__d_ax=-1};this.mouseDrag=function(a){var c;c=this.modelToView(new CAAT.Math.Point(a.x,a.y));this.parent.viewToModel(c);if(-1===this.__d_ax||-1===this.__d_ay)this.__d_ax=c.x,this.__d_ay=c.y,this.__d_asx=this.scaleX,this.__d_asy=this.scaleY,this.__d_ara=this.rotationAngle,this.__d_screenx=a.screenPoint.x,this.__d_screeny=a.screenPoint.y;if(a.isShiftDown()){var d=(a.screenPoint.x-this.__d_screenx)/100,e=(a.screenPoint.y-this.__d_screeny)/100;a.isAltDown()||(e=d=a=Math.max(d,e));this.setScale(d+this.__d_asx,e+this.__d_asy)}else a.isControlDown()?this.setRotation(-Math.atan2(a.screenPoint.x-this.__d_screenx,a.screenPoint.y-this.__d_screeny)+this.__d_ara):(this.x+=c.x-this.__d_ax,this.y+=c.y-this.__d_ay);this.__d_ax=c.x;this.__d_ay=c.y};return this},disableDrag:function(){this.mouseEnter=function(a){};this.mouseExit=function(a){};this.mouseMove=function(a){};this.mouseUp=function(a){};this.mouseDrag=function(a){};return this},mouseClick:function(a){},mouseDblClick:function(a){},mouseEnter:function(a){this.pointed=!0},mouseExit:function(a){this.pointed=!1},mouseMove:function(a){},mouseDown:function(a){},mouseUp:function(a){},mouseOut:function(a){},mouseOver:function(a){},mouseDrag:function(a){},drawScreenBoundingBox:function(a,c){if(null!==this.AABB&&this.inFrame){var d=this.AABB,e=a.ctx;e.strokeStyle=CAAT.DEBUGAABBCOLOR;e.strokeRect(.5+(d.x|0),.5+(d.y|0),d.width|0,d.height|0);CAAT.DEBUGBB&&(d=this.viewVertices,e.beginPath(),e.lineTo(d[0].x,d[0].y),e.lineTo(d[1].x,d[1].y),e.lineTo(d[2].x,d[2].y),e.lineTo(d[3].x,d[3].y),e.closePath(),e.strokeStyle=CAAT.DEBUGBBCOLOR,e.stroke())}},animate:function(a,c){if(!this.visible)return!1;var d;if(!this.isInAnimationFrame(c))return this.inFrame=!1,this.dirty=!0,!1;if(this.x!==this.oldX||this.y!==this.oldY)this.dirty=!0,this.oldX=this.x,this.oldY=this.y;for(d=0;d<this.behaviorList.length;d++)this.behaviorList[d].apply(c,this);this.clipPath&&this.clipPath.applyBehaviors(c);this.setModelViewMatrix();if(this.dirty||this.wdirty||this.invalid)a.dirtyRectsEnabled&&a.addDirtyRect(this.AABB),this.setScreenBounds(),a.dirtyRectsEnabled&&a.addDirtyRect(this.AABB);this.invalid=this.dirty=!1;this.inFrame=!0;this.backgroundImage&&this.backgroundImage.setSpriteIndexAtTime(c);return this.AABB.intersects(a.AABB)},setModelViewMatrix:function(){var a,c,d,e,f,g,h,k,m,n,p;this.wdirty=!1;p=this.modelViewMatrix.matrix;if(this.dirty){h=1;m=e=0;g=1;k=this.x-this.tAnchorX*this.width;n=this.y-this.tAnchorY*this.height;if(this.rotationAngle){var r=this.rotationX*this.width,q=this.rotationY*this.height;k+=h*r+e*q;n+=m*r+g*q;a=Math.cos(this.rotationAngle);c=Math.sin(this.rotationAngle);d=h;f=m;h=d*a+e*c;e=-d*c+e*a;m=f*a+g*c;g=-f*c+g*a;k+=-h*r-e*q;n+=-m*r-g*q}if(1!=this.scaleX||1!=this.scaleY)a=this.scaleTX*this.width,c=this.scaleTY*this.height,k+=h*a+e*c,n+=m*a+g*c,h*=this.scaleX,e*=this.scaleY,m*=this.scaleX,g*=this.scaleY,k+=-h*a-e*c,n+=-m*a-g*c;p[0]=h;p[1]=e;p[2]=k;p[3]=m;p[4]=g;p[5]=n}if(this.parent){if(this.isAA=0===this.rotationAngle&&1===this.scaleX&&1===this.scaleY&&this.parent.isAA,this.dirty||this.parent.wdirty)this.worldModelViewMatrix.copy(this.parent.worldModelViewMatrix),this.isAA?(h=this.worldModelViewMatrix.matrix,h[2]+=p[2],h[5]+=p[5]):this.worldModelViewMatrix.multiply(this.modelViewMatrix),this.wdirty=!0}else this.dirty&&(this.wdirty=!0),this.worldModelViewMatrix.identity(),this.isAA=0===this.rotationAngle&&1===this.scaleX&&1===this.scaleY},setScreenBounds:function(){var a=this.AABB,c=this.viewVertices,d,e,f,g,h;if(this.isAA)return d=this.worldModelViewMatrix.matrix,e=d[2],f=d[5],g=this.width,h=this.height,a.x=e,a.y=f,a.x1=e+g,a.y1=f+h,a.width=g,a.height=h,CAAT.GLRENDER&&(d=c[0],d.x=e,d.y=f,d=c[1],d.x=e+g,d.y=f,d=c[2],d.x=e+g,d.y=f+h,d=c[3],d.x=e,d.y=f+h),this;d=c[0];d.x=0;d.y=0;d=c[1];d.x=this.width;d.y=0;d=c[2];d.x=this.width;d.y=this.height;d=c[3];d.x=0;d.y=this.height;this.modelToView(this.viewVertices);e=Number.MAX_VALUE;f=-Number.MAX_VALUE;g=Number.MAX_VALUE;h=-Number.MAX_VALUE;d=c[0];d.x<e&&(e=d.x);d.x>f&&(f=d.x);d.y<g&&(g=d.y);d.y>h&&(h=d.y);d=c[1];d.x<e&&(e=d.x);d.x>f&&(f=d.x);d.y<g&&(g=d.y);d.y>h&&(h=d.y);d=c[2];d.x<e&&(e=d.x);d.x>f&&(f=d.x);d.y<g&&(g=d.y);d.y>h&&(h=d.y);d=c[3];d.x<e&&(e=d.x);d.x>f&&(f=d.x);d.y<g&&(g=d.y);d.y>h&&(h=d.y);a.x=e;a.y=g;a.x1=f;a.y1=h;a.width=f-e;a.height=h-g;return this},paintActor:function(a,c){if(!this.visible||!a.inDirtyRect(this))return!0;var d=a.ctx;this.frameAlpha=this.parent?this.parent.frameAlpha*this.alpha:1;d.globalAlpha=this.frameAlpha;a.modelViewMatrix.transformRenderingContextSet(d);this.worldModelViewMatrix.transformRenderingContext(d);this.clip&&(d.beginPath(),this.clipPath?this.clipPath.applyAsPath(a):d.rect(0,0,this.width,this.height),d.clip());this.paint(a,c);return!0},__paintActor:function(a,c){if(!this.visible)return!0;var d=a.ctx;this.frameAlpha=this.alpha;var e=this.worldModelViewMatrix.matrix;d.setTransform(e[0],e[3],e[1],e[4],e[2],e[5],this.frameAlpha);this.paint(a,c);return!0},paintActorGL:function(a,c){this.frameAlpha=this.parent.frameAlpha*this.alpha;if(this.glEnabled&&this.visible)if(this.glNeedsFlush(a))a.glFlush(),this.glSetShader(a),this.__uv||(this.__uv=new Float32Array(8)),this.__vv||(this.__vv=new Float32Array(12)),this.setGLCoords(this.__vv,0),this.setUV(this.__uv,0),a.glRender(this.__vv,12,this.__uv);else{var d=a.coordsIndex;this.setGLCoords(a.coords,d);a.coordsIndex=d+12;this.setUV(a.uv,a.uvIndex);a.uvIndex+=8}},setGLCoords:function(a,c){var d=this.viewVertices;a[c++]=d[0].x;a[c++]=d[0].y;a[c++]=0;a[c++]=d[1].x;a[c++]=d[1].y;a[c++]=0;a[c++]=d[2].x;a[c++]=d[2].y;a[c++]=0;a[c++]=d[3].x;a[c++]=d[3].y;a[c]=0},setUV:function(a,c){this.backgroundImage.setUV(a,c)},glNeedsFlush:function(a){return this.getTextureGLPage()!==a.currentTexturePage||this.frameAlpha!==a.currentOpacity?!0:!1},glSetShader:function(a){var c=this.getTextureGLPage();c!==a.currentTexturePage&&a.setGLTexturePage(c);this.frameAlpha!==a.currentOpacity&&a.setGLCurrentOpacity(this.frameAlpha)},endAnimate:function(a,c){return this},initialize:function(a){if(a)for(var c in a)this[c]=a[c];return this},setClip:function(a,c){this.clip=a;this.clipPath=c;return this},isCached:function(){return this.cached},stopCacheAsBitmap:function(){this.cached&&(this.backgroundImage=null,this.cached=CAAT.Foundation.Actor.CACHE_NONE)},cacheAsBitmap:function(a,c){if(0>=this.width||0>=this.height)return this;a=a||0;var d=document.createElement("canvas");d.width=this.width;d.height=this.height;var e=d.getContext("2d");CAAT.Foundation.Actor.prototype.animate.call(this,CAAT.currentDirector,a);var e={ctx:e,modelViewMatrix:new CAAT.Math.Matrix,worldModelViewMatrix:new CAAT.Math.Matrix,dirtyRectsEnabled:!1,inDirtyRect:function(){return!0},AABB:new CAAT.Math.Rectangle(0,0,this.width,this.height)},f=this.modelViewMatrix,g=this.worldModelViewMatrix;this.modelViewMatrix=new CAAT.Math.Matrix;this.worldModelViewMatrix=new CAAT.Math.Matrix;this.cached=CAAT.Foundation.Actor.CACHE_NONE;"undefined"===typeof c&&(c=CAAT.Foundation.Actor.CACHE_SIMPLE);c===CAAT.Foundation.Actor.CACHE_DEEP?(this.animate(e,a),this.paintActor(e,a)):this instanceof CAAT.Foundation.ActorContainer||this instanceof
CAAT.ActorContainer?CAAT.Foundation.ActorContainer.superclass.paintActor.call(this,e,a):(this.animate(e,a),this.paintActor(e,a));this.setBackgroundImage(d);this.cached=c;this.modelViewMatrix=f;this.worldModelViewMatrix=g;return this},resetAsButton:function(){this.actionPerformed=null;this.mouseEnter=function(){};this.mouseExit=function(){};this.mouseDown=function(){};this.mouseUp=function(){};this.mouseClick=function(){};this.mouseDrag=function(){};return this},setAsButton:function(a,c,d,e,f,g){this.setBackgroundImage(a,!0);this.iNormal=c||0;this.iOver=d||this.iNormal;this.iPress=e||this.iNormal;this.iDisabled=f||this.iNormal;this.fnOnClick=g;this.enabled=!0;this.setSpriteIndex(c);this.setEnabled=function(a){this.enabled=a;this.setSpriteIndex(this.enabled?this.iNormal:this.iDisabled);return this};this.actionPerformed=function(a){this.enabled&&this.fnOnClick&&this.fnOnClick(this)};this.mouseEnter=function(a){this.enabled&&(this.dragging?this.setSpriteIndex(this.iPress):this.setSpriteIndex(this.iOver),CAAT.setCursor("pointer"))};this.mouseExit=function(a){this.enabled&&(this.setSpriteIndex(this.iNormal),CAAT.setCursor("default"))};this.mouseDown=function(a){this.enabled&&this.setSpriteIndex(this.iPress)};this.mouseUp=function(a){this.enabled&&(this.setSpriteIndex(this.iNormal),this.dragging=!1)};this.mouseClick=function(a){};this.mouseDrag=function(a){this.enabled&&(this.dragging=!0)};this.setButtonImageIndex=function(a,b,c,d){this.iNormal=a||0;this.iOver=b||this.iNormal;this.iPress=c||this.iNormal;this.iDisabled=d||this.iNormal;this.setSpriteIndex(this.iNormal);return this};return this},findActorById:function(a){return this.id===a?this:null}}}});CAAT.Module({defines:"CAAT.Foundation.ActorContainer",aliases:["CAAT.ActorContainer"],depends:["CAAT.Foundation.Actor","CAAT.Math.Point","CAAT.Math.Rectangle"],constants:{ADDHINT:{CONFORM:1},AddHint:{CONFORM:1}},extendsClass:"CAAT.Foundation.Actor",extendsWith:function(){var a=CAAT.Foundation.Actor.CACHE_DEEP,b=CAAT.Foundation.ActorContainer.superclass,c=b.drawScreenBoundingBox,d=b.paintActor,e=b.paintActorGL,f=b.animate,g=b.findActorAtPosition,h=b.destroy;return{__init:function(a){this.__super();this.childrenList=[];this.activeChildren=[];this.pendingChildrenList=[];"undefined"!==typeof a&&(this.addHint=a,this.boundingBox=new CAAT.Math.Rectangle);return this},childrenList:null,activeChildren:null,pendingChildrenList:null,addHint:0,boundingBox:null,runion:new CAAT.Math.Rectangle,layoutManager:null,layoutInvalidated:!0,setLayout:function(a){this.layoutManager=a;return this},setBounds:function(a,b,c,d){CAAT.Foundation.ActorContainer.superclass.setBounds.call(this,a,b,c,d);CAAT.currentDirector&&!CAAT.currentDirector.inValidation&&this.invalidateLayout();return this},__validateLayout:function(){this.__validateTree();this.layoutInvalidated=!1},__validateTree:function(){if(this.layoutManager&&this.layoutManager.isInvalidated()){CAAT.currentDirector.inValidation=!0;this.layoutManager.doLayout(this);for(var a=0;a<this.getNumChildren();a+=1)this.getChildAt(a).__validateLayout()}},invalidateLayout:function(){this.layoutInvalidated=!0;if(this.layoutManager){this.layoutManager.invalidateLayout(this);for(var a=0;a<this.getNumChildren();a+=1)this.getChildAt(a).invalidateLayout()}},getLayout:function(){return this.layoutManager},drawScreenBoundingBox:function(a,b){if(this.inFrame){for(var d=this.activeChildren,e=0;e<d.length;e++)d[e].drawScreenBoundingBox(a,b);c.call(this,a,b)}},emptyChildren:function(){this.childrenList=[];return this},paintActor:function(b,c){if(!this.visible)return!1;var e=b.ctx;e.save();if(!d.call(this,b,c)||this.cached===a)return!1;this.isGlobalAlpha||(this.frameAlpha=this.parent?this.parent.frameAlpha:1);for(var f=0,g=this.activeChildren.length;f<g;++f){var h=this.activeChildren[f];h.visible&&(e.save(),h.paintActor(b,c),e.restore())}this.postPaint&&this.postPaint(b,c);e.restore();return!0},__paintActor:function(a,b){if(!this.visible)return!0;var c=a.ctx;this.frameAlpha=this.parent?this.parent.frameAlpha*this.alpha:1;var d=this.worldModelViewMatrix.matrix;c.setTransform(d[0],d[3],d[1],d[4],d[2],d[5],this.frameAlpha);this.paint(a,b);this.isGlobalAlpha||(this.frameAlpha=this.parent?this.parent.frameAlpha:1);c=0;for(d=this.activeChildren.length;c<d;++c)this.activeChildren[c].paintActor(a,b);return!0},paintActorGL:function(a,b){var c,d,f;if(!this.visible)return!0;e.call(this,a,b);this.isGlobalAlpha||(this.frameAlpha=this.parent.frameAlpha);c=0;for(d=this.activeChildren.length;c<d;++c)f=this.activeChildren[c],f.paintActorGL(a,b)},animate:function(b,c){if(!this.visible)return!1;this.activeChildren=[];if(!1===f.call(this,b,c))return!1;if(this.cached===a)return!0;this.__validateLayout();CAAT.currentDirector.inValidation=!1;var d,e,g=this.pendingChildrenList;for(d=0;d<g.length;d++)e=g[d],this.addChildImmediately(e.child,e.constraint);this.pendingChildrenList=[];g=[];e=this.childrenList;this.size_total=this.size_active=1;for(d=0;d<e.length;d++){var h=e[d];h.time=c;this.size_total+=h.size_total;h.animate(b,c)?(this.activeChildren.push(h),this.size_active+=h.size_active):h.expired&&h.discardable&&g.push(h)}d=0;for(e=g.length;d<e;d++)h=g[d],h.destroy(c),b.dirtyRectsEnabled&&b.addDirtyRect(h.AABB);return!0},endAnimate:function(a,b){},addChildImmediately:function(a,b){return this.addChild(a,b)},addChild:function(a,b){if(null!=a.parent)throw"adding to a container an element with parent.";a.parent=this;this.childrenList.push(a);a.dirty=!0;this.layoutManager?(this.layoutManager.addChild(a,b),this.invalidateLayout()):this.addHint===CAAT.Foundation.ActorContainer.AddHint.CONFORM&&this.recalcSize();return this},recalcSize:function(){var a=this.boundingBox;a.setEmpty();for(var b=this.childrenList,c,d=0;d<b.length;d++)c=b[d],this.runion.setBounds(0>c.x?0:c.x,0>c.y?0:c.y,c.width,c.height),a.unionRectangle(this.runion);this.setSize(a.x1,a.y1);return this},addChildDelayed:function(a,b){this.pendingChildrenList.push({child:a,constraint:b});return this},addChildAt:function(a,b){if(0>=b)return a.parent=this,a.dirty=!0,this.childrenList.splice(0,0,a),this.invalidateLayout(),this;b>=this.childrenList.length&&(b=this.childrenList.length);a.parent=this;a.dirty=!0;this.childrenList.splice(b,0,a);this.invalidateLayout();return this},findActorById:function(a){if(CAAT.Foundation.ActorContainer.superclass.findActorById.call(this,a))return this;for(var b=this.childrenList,c=0,d=b.length;c<d;c++){var e=b[c].findActorById(a);if(null!=e)return e}return null},findChild:function(a){var b=this.childrenList,c,d=b.length;for(c=0;c<d;c++)if(b[c]===a)return c;return-1},removeChildAt:function(a){var b=this.childrenList;return-1!==a&&0<=a&&a<this.childrenList.length?(b[a].setParent(null),a=b.splice(a,1),a[0].isVisible()&&CAAT.currentDirector.dirtyRectsEnabled&&CAAT.currentDirector.scheduleDirtyRect(a[0].AABB),this.invalidateLayout(),a[0]):null},removeChild:function(a){a=this.findChild(a);return this.removeChildAt(a)},removeFirstChild:function(){var a=this.childrenList.shift();a.parent=null;a.isVisible()&&CAAT.currentDirector.dirtyRectsEnabled&&CAAT.currentDirector.scheduleDirtyRect(a.AABB);this.invalidateLayout();return a},removeLastChild:function(){if(this.childrenList.length){var a=this.childrenList.pop();a.parent=null;a.isVisible()&&CAAT.currentDirector.dirtyRectsEnabled&&CAAT.currentDirector.scheduleDirtyRect(a.AABB);this.invalidateLayout();return a}return null},findActorAtPosition:function(a){if(null===g.call(this,a))return null;for(var b=this.childrenList.length-1;0<=b;b--){var c=this.childrenList[b],d=new CAAT.Math.Point(a.x,a.y,0),c=c.findActorAtPosition(d);if(null!==c)return c}return this},destroy:function(){for(var a=this.childrenList,b=a.length-1;0<=b;b--)a[b].destroy();h.call(this);return this},getNumChildren:function(){return this.childrenList.length},getNumActiveChildren:function(){return this.activeChildren.length},getChildAt:function(a){return this.childrenList[a]},setZOrder:function(a,b){var c=this.findChild(a);if(-1!==c){var d=this.childrenList;b!==c&&(b>=d.length?(d.splice(c,1),d.push(a)):(c=d.splice(c,1),0>b?b=0:b>d.length&&(b=d.length),d.splice(b,0,c[0])),this.invalidateLayout())}}}}});CAAT.Module({defines:"CAAT.Foundation.Scene",depends:"CAAT.Math.Point CAAT.Math.Matrix CAAT.PathUtil.Path CAAT.Behavior.GenericBehavior CAAT.Behavior.ContainerBehavior CAAT.Behavior.ScaleBehavior CAAT.Behavior.AlphaBehavior CAAT.Behavior.RotateBehavior CAAT.Behavior.PathBehavior CAAT.Foundation.ActorContainer CAAT.Foundation.Timer.TimerManager".split(" "),aliases:["CAAT.Scene"],extendsClass:"CAAT.Foundation.ActorContainer",constants:{EASE_ROTATION:1,EASE_SCALE:2,EASE_TRANSLATE:3},extendsWith:function(){return{__init:function(){this.__super();this.timerManager=new CAAT.TimerManager;this.fillStyle=null;this.isGlobalAlpha=!0;return this},easeContainerBehaviour:null,easeContainerBehaviourListener:null,easeIn:!1,paused:!1,timerManager:null,isPaused:function(){return this.paused},setPaused:function(a){this.paused=a},createTimer:function(a,b,c,d,e){return this.timerManager.createTimer(a,b,c,d,e,this)},setTimeout:function(a,b,c,d){return this.timerManager.createTimer(this.time,a,b,c,d,this)},createAlphaBehaviour:function(a,b){var c=new CAAT.Behavior.AlphaBehavior;c.setFrameTime(0,a);c.startAlpha=b?0:1;c.endAlpha=b?1:0;this.easeContainerBehaviour.addBehavior(c)},easeTranslationIn:function(a,b,c,d){this.easeTranslation(a,b,c,!0,d)},easeTranslationOut:function(a,b,c,d){this.easeTranslation(a,b,c,!1,d)},easeTranslation:function(a,b,c,d,e){this.easeContainerBehaviour=new CAAT.Behavior.ContainerBehavior;this.easeIn=d;var f=new CAAT.Behavior.PathBehavior;e&&f.setInterpolator(e);f.setFrameTime(0,a);1>c?c=1:4<c&&(c=4);switch(c){case CAAT.Foundation.Actor.ANCHOR_TOP:d?(f.setPath((new CAAT.PathUtil.Path).setLinear(0,-this.height+1,0,0)),this.setPosition(0,-this.height+1)):(f.setPath((new CAAT.PathUtil.Path).setLinear(0,0,0,-this.height+1)),this.setPosition(0,0));break;case CAAT.Foundation.Actor.ANCHOR_BOTTOM:d?(f.setPath((new CAAT.PathUtil.Path).setLinear(0,this.height-1,0,0)),this.setPosition(0,this.height-1)):(f.setPath((new CAAT.PathUtil.Path).setLinear(0,0,0,this.height-1)),this.setPosition(0,0));break;case CAAT.Foundation.Actor.ANCHOR_LEFT:d?(f.setPath((new CAAT.PathUtil.Path).setLinear(-this.width+
1,0,0,0)),this.setPosition(-this.width+1,0)):(f.setPath((new CAAT.PathUtil.Path).setLinear(0,0,-this.width+1,0)),this.setPosition(0,0));break;case CAAT.Foundation.Actor.ANCHOR_RIGHT:d?(f.setPath((new CAAT.PathUtil.Path).setLinear(this.width-1,0,0,0)),this.setPosition(this.width-1,0)):(f.setPath((new CAAT.PathUtil.Path).setLinear(0,0,this.width-1,0)),this.setPosition(0,0))}b&&this.createAlphaBehaviour(a,d);this.easeContainerBehaviour.addBehavior(f);this.easeContainerBehaviour.setFrameTime(this.time,a);this.easeContainerBehaviour.addListener(this);this.emptyBehaviorList();CAAT.Foundation.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},easeScaleIn:function(a,b,c,d,e){this.easeScale(a,b,c,d,!0,e);this.easeIn=!0},easeScaleOut:function(a,b,c,d,e){this.easeScale(a,b,c,d,!1,e);this.easeIn=!1},easeScale:function(a,b,c,d,e,f){this.easeContainerBehaviour=new CAAT.Behavior.ContainerBehavior;var g=0,h=0,k=0,m=0;switch(d){case CAAT.Foundation.Actor.ANCHOR_TOP_LEFT:case CAAT.Foundation.Actor.ANCHOR_TOP_RIGHT:case CAAT.Foundation.Actor.ANCHOR_BOTTOM_LEFT:case CAAT.Foundation.Actor.ANCHOR_BOTTOM_RIGHT:case CAAT.Foundation.Actor.ANCHOR_CENTER:m=k=1;break;case CAAT.Foundation.Actor.ANCHOR_TOP:case CAAT.Foundation.Actor.ANCHOR_BOTTOM:k=g=1;h=0;m=1;break;case CAAT.Foundation.Actor.ANCHOR_LEFT:case CAAT.Foundation.Actor.ANCHOR_RIGHT:m=h=1;g=0;k=1;break;default:alert("scale anchor ?? "+d)}if(!e){var n;n=g;g=k;k=n;n=h;h=m;m=n}c&&this.createAlphaBehaviour(b,e);c=this.getAnchorPercent(d);a=(new CAAT.Behavior.ScaleBehavior).setFrameTime(a,b).setValues(g,k,h,m,c.x,c.y);f&&a.setInterpolator(f);this.easeContainerBehaviour.addBehavior(a);this.easeContainerBehaviour.setFrameTime(this.time,b);this.easeContainerBehaviour.addListener(this);this.emptyBehaviorList();CAAT.Foundation.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},addBehavior:function(a){return this},easeRotationIn:function(a,b,c,d){this.easeRotation(a,b,c,!0,d);this.easeIn=!0},easeRotationOut:function(a,b,c,d){this.easeRotation(a,b,c,!1,d);this.easeIn=!1},easeRotation:function(a,b,c,d,e){this.easeContainerBehaviour=new CAAT.Behavior.ContainerBehavior;var f=0,g=0;c==CAAT.Foundation.Actor.ANCHOR_CENTER&&(c=CAAT.Foundation.Actor.ANCHOR_TOP);switch(c){case CAAT.Foundation.Actor.ANCHOR_TOP:case CAAT.Foundation.Actor.ANCHOR_BOTTOM:case CAAT.Foundation.Actor.ANCHOR_LEFT:case CAAT.Foundation.Actor.ANCHOR_RIGHT:f=Math.PI*(.5>Math.random()?1:-1);break;case CAAT.Foundation.Actor.ANCHOR_TOP_LEFT:case CAAT.Foundation.Actor.ANCHOR_TOP_RIGHT:case CAAT.Foundation.Actor.ANCHOR_BOTTOM_LEFT:case CAAT.Foundation.Actor.ANCHOR_BOTTOM_RIGHT:f=Math.PI/2*(.5>Math.random()?1:-1);break;default:alert("rot anchor ?? "+c)}if(!1===d)var h=f,f=g,g=h;b&&this.createAlphaBehaviour(a,d);b=this.getAnchorPercent(c);f=(new CAAT.Behavior.RotateBehavior).setFrameTime(0,a).setValues(f,g,b.x,b.y);e&&f.setInterpolator(e);this.easeContainerBehaviour.addBehavior(f);this.easeContainerBehaviour.setFrameTime(this.time,a);this.easeContainerBehaviour.addListener(this);this.emptyBehaviorList();CAAT.Foundation.Scene.superclass.addBehavior.call(this,this.easeContainerBehaviour)},setEaseListener:function(a){this.easeContainerBehaviourListener=a},behaviorExpired:function(a){this.easeContainerBehaviourListener.easeEnd(this,this.easeIn)},activated:function(){},setExpired:function(a){this.expired=a},paint:function(a,b){if(this.fillStyle){var c=a.ctx;c.fillStyle=this.fillStyle;c.fillRect(0,0,this.width,this.height)}},findActorAtPosition:function(a){var b,c,d=new CAAT.Math.Point;if(this.inputList){var e=this.inputList;for(b=0;b<e.length;b++){var f=e[b];for(c=0;c<f.length;c++)if(f[c].visible&&(d.set(a.x,a.y),f[c].worldModelViewMatrix.getInverse().transformCoord(d),f[c].contains(d.x,d.y)))return f[c]}}d.set(a.x,a.y);return CAAT.Foundation.Scene.superclass.findActorAtPosition.call(this,d)},enableInputList:function(a){this.inputList=[];for(var b=0;b<a;b++)this.inputList.push([]);return this},addActorToInputList:function(a,b,c){0>b?b=0:b>=this.inputList.length&&(b=this.inputList.length-1);b=this.inputList[b];"undefined"===typeof c||c>=b.length?b.push(a):0>=c?b.unshift(a):b.splice(c,0,a);return this},emptyInputList:function(a){0>a?a=0:a>=this.inputList.length&&(a=this.inputList.length-1);this.inputList[a]=[];return this},removeActorFromInputList:function(a,b){if("undefined"===typeof b){var c,d;for(c=0;c<this.inputList.length;c++){var e=this.inputList[c];for(d=0;d<e.length;d++)e[d]==a&&e.splice(d,1)}return this}0>b?b=0:b>=this.inputList.length&&(b=this.inputList.length-1);e=this.inputList[b];for(d=0;d<e.length;d++)e[d]==a&&e.splice(d,1);return this},getIn:function(a){},goOut:function(a){}}}});CAAT.Module({defines:"CAAT.Foundation.Director",aliases:["CAAT.Director"],extendsClass:"CAAT.Foundation.ActorContainer",depends:"CAAT.Core.Class CAAT.Core.Constants CAAT.Foundation.ActorContainer CAAT.Module.Audio.AudioManager CAAT.Module.Runtime.BrowserInfo CAAT.Module.Debug.Debug CAAT.Math.Point CAAT.Math.Rectangle CAAT.Math.Matrix CAAT.Foundation.Timer.TimerManager CAAT.Foundation.Actor CAAT.Foundation.Scene CAAT.Event.AnimationLoop CAAT.Event.Input CAAT.Event.KeyEvent CAAT.Event.MouseEvent CAAT.Event.TouchEvent CAAT.WebGL.Program CAAT.WebGL.ColorProgram CAAT.WebGL.TextureProgram CAAT.WebGL.GLU CAAT.Module.TexturePacker.TexturePageManager".split(" "),constants:{RENDER_MODE_CONTINUOUS:1,RENDER_MODE_DIRTY:2,CLEAR_DIRTY_RECTS:1,CLEAR_ALL:!0,CLEAR_NONE:!1,RESIZE_NONE:1,RESIZE_WIDTH:2,RESIZE_HEIGHT:4,RESIZE_BOTH:8,RESIZE_PROPORTIONAL:16},extendsWith:function(){return{__init:function(){this.__super();this.browserInfo=CAAT.Module.Runtime.BrowserInfo;this.audioManager=(new CAAT.Module.Audio.AudioManager).initialize(8);this.scenes=[];this.imagesCache=[];this.mousePoint=new CAAT.Math.Point(0,0,0);this.prevMousePoint=new CAAT.Math.Point(0,0,0);this.screenMousePoint=new CAAT.Math.Point(0,0,0);this.isMouseDown=!1;this.lastSelectedActor=null;this.dragging=!1;this.cDirtyRects=[];this.sDirtyRects=[];this.dirtyRects=[];for(var a=0;64>a;a++)this.dirtyRects.push(new CAAT.Math.Rectangle);this.dirtyRectsIndex=0;this.touches={};this.timerManager=new CAAT.Foundation.Timer.TimerManager;this.__map={};return this},debug:!1,renderMode:CAAT.Foundation.Director.RENDER_MODE_CONTINUOUS,onRenderStart:null,onRenderEnd:null,mousePoint:null,prevMousePoint:null,screenMousePoint:null,isMouseDown:!1,lastSelectedActor:null,dragging:!1,scenes:null,currentScene:null,canvas:null,ctx:null,time:0,timeline:0,imagesCache:null,audioManager:null,clear:CAAT.Foundation.Director.CLEAR_ALL,transitionScene:null,browserInfo:null,gl:null,glEnabled:!1,glTextureManager:null,glTtextureProgram:null,glColorProgram:null,pMatrix:null,coords:null,coordsIndex:0,uv:null,uvIndex:0,front_to_back:!1,statistics:{size_total:0,size_active:0,size_dirtyRects:0,draws:0,size_discarded_by_dirty_rects:0},currentTexturePage:0,currentOpacity:1,intervalId:null,frameCounter:0,resize:1,onResizeCallback:null,__gestureScale:0,__gestureRotation:0,dirtyRects:null,cDirtyRects:null,sDirtyRects:null,dirtyRectsIndex:0,dirtyRectsEnabled:!1,nDirtyRects:0,drDiscarded:0,stopped:!1,needsRepaint:!1,touches:null,timerManager:null,SCREEN_RATIO:1,__map:null,clean:function(){this.audioManager=this.imagesCache=this.currentScene=this.scenes=null;this.isMouseDown=!1;this.lastSelectedActor=null;this.dragging=!1;this.__gestureRotation=this.__gestureScale=0;this.dirty=!0;this.cDirtyRects=this.dirtyRects=null;this.dirtyRectsIndex=0;this.dirtyRectsEnabled=!1;this.nDirtyRects=0;this.onResizeCallback=null;this.__map={};return this},cancelPlay:function(a){return this.audioManager.cancelPlay(a)},cancelPlayByChannel:function(a){return this.audioManager.cancelPlayByChannel(a)},setValueForKey:function(a,b){this.__map[a]=b;return this},getValueForKey:function(a){return this.__map[a]},createTimer:function(a,b,c,d,e){return this.timerManager.createTimer(a,b,c,d,e,this)},requestRepaint:function(){this.needsRepaint=!0},getCurrentScene:function(){return this.currentScene},checkDebug:function(){if(!navigator.isCocoonJS&&CAAT.DEBUG){var a=(new CAAT.Module.Debug.Debug).initialize(this.width,60);this.debugInfo=a.debugInfo.bind(a)}},getRenderType:function(){return this.glEnabled?"WEBGL":"CANVAS"},windowResized:function(a,b){var c=CAAT.Foundation.Director;switch(this.resize){case c.RESIZE_WIDTH:this.setBounds(0,0,a,this.height);break;case c.RESIZE_HEIGHT:c=document.getElementById("azoom-animID");"undefined"!=typeof c&&null!=c?this.setScaleProportionalXR(a,b):this.setBounds(0,0,this.width,b);break;case c.RESIZE_BOTH:this.setBounds(0,0,a,b);break;case c.RESIZE_PROPORTIONAL:c=jQuery(this.canvas).parents("#azoom-animID"),"undefined"!=typeof c&&null!=c?this.setScaleProportional(c.outerWidth(),9999):this.setScaleProportional(a-300,b)}this.glEnabled&&this.glReset();if(this.onResizeCallback)this.onResizeCallback(this,a,b)},setScaleProportional:function(a,b){var c=Math.min(a/this.referenceWidth,b/this.referenceHeight);this.canvas.width=this.referenceWidth*c;this.canvas.height=this.referenceHeight*c;this.ctx=this.canvas.getContext(this.glEnabled?"experimental-webgl":"2d");this.__setupRetina();this.setScaleAnchored(c*this.scaleX,c*this.scaleY,0,0);this.glEnabled&&this.glReset()},setScaleProportionalXR:function(a,b){var c=Math.max(a/this.referenceWidth,b/this.referenceHeight);this.canvas.width=this.referenceWidth*c;this.canvas.height=b;this.ctx=this.canvas.getContext(this.glEnabled?"experimental-webgl":"2d");this.__setupRetina();var d=0,e=0,d=parseInt((this.referenceWidth*c-a)/2);parseInt((this.referenceHeight*c-b)/2);d=0!==d?-d:0;e=0;this.setScaleAnchored(c*this.scaleX,c*this.scaleY,0,0);this.canvas.style.left=d+"px";this.canvas.style.top=e+"px";this.glEnabled&&this.glReset()},enableResizeEvents:function(a,b){var c=CAAT.Foundation.Director;a===c.RESIZE_BOTH||a===c.RESIZE_WIDTH||a===c.RESIZE_HEIGHT||a===c.RESIZE_PROPORTIONAL?(this.referenceWidth=this.width,this.referenceHeight=this.height,this.resize=a,CAAT.registerResizeListener(this),this.onResizeCallback=b,this.windowResized(window.innerWidth,window.innerHeight)):(CAAT.unregisterResizeListener(this),this.onResizeCallback=null);return this},__setupRetina:function(){if(CAAT.RETINA_DISPLAY_ENABLED){var a=CAAT.Module.Runtime.BrowserInfo.DevicePixelRatio,b=this.ctx.webkitBackingStorePixelRatio||this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1,c=a/b,d=CAAT.Module.Runtime.BrowserInfo.OS;if("undefined"!==typeof CAAT.IOS_RETINA_LIMIT&&-1<d.toString().toLowerCase().indexOf("iphone"))for(var a=Math.min(a,CAAT.IOS_RETINA_LIMIT),d=0,e=parseInt(this.canvas.width)*parseInt(this.canvas.height)*c*c>CAAT.IOS_RETINA_LIMIT;e&&8>d;)0<a-1&&a--,c=a/b,e=parseInt(this.canvas.width)*parseInt(this.canvas.height)*c*c>CAAT.IOS_RETINA_LIMIT,d++;a!==b?(a=this.canvas.width,b=this.canvas.height,this.canvas.width=a*c,this.canvas.height=b*c,this.canvas.style.width=a+"px",this.canvas.style.height=b+"px",this.setScaleAnchored(c,c,0,0)):this.setScaleAnchored(1,1,0,0);this.SCREEN_RATIO=c}else this.setScaleAnchored(1,1,0,0);for(c=0;c<this.scenes.length;c++)this.scenes[c].setBounds(0,0,this.width,this.height)},setBounds:function(a,b,c,d){CAAT.Foundation.Director.superclass.setBounds.call(this,a,b,c,d);this.canvas.width!==c&&(this.canvas.width=c);this.canvas.height!==d&&(this.canvas.height=d);this.ctx=this.canvas.getContext(this.glEnabled?"experimental-webgl":"2d");this.__setupRetina();this.glEnabled&&this.glReset();return this},initialize:function(a,b,c,d){"undefined"!==typeof c&&isString(c)&&(c=document.getElementById(c));c||(c=document.createElement("canvas"),document.body.appendChild(c));this.canvas=c;"undefined"===typeof d&&(d=c);this.setBounds(0,0,a,b);this.enableEvents(d);this.timeline=(new Date).getTime();CAAT.CACHE_SCENE_ON_CHANGE&&(this.transitionScene=(new CAAT.Foundation.Scene).setBounds(0,0,a,b),c=document.createElement("canvas"),c.width=a,c.height=b,a=(new CAAT.Foundation.Actor).setBackgroundImage(c),this.transitionScene.ctx=c.getContext("2d"),this.transitionScene.addChildImmediately(a),this.transitionScene.setEaseListener(this));this.checkDebug();return this},glReset:function(){this.pMatrix=CAAT.WebGL.GLU.makeOrtho(0,this.referenceWidth,this.referenceHeight,0,-1,1);this.gl.viewport(0,0,this.canvas.width,this.canvas.height);this.glColorProgram.setMatrixUniform(this.pMatrix);this.glTextureProgram.setMatrixUniform(this.pMatrix);this.gl.viewportWidth=this.canvas.width;this.gl.viewportHeight=this.canvas.height},initializeGL:function(a,b,c,d){c||(c=document.createElement("canvas"),document.body.appendChild(c));c.width=a;c.height=b;this.referenceWidth=a;this.referenceHeight=b;try{this.gl=c.getContext("experimental-webgl"),this.gl.viewportWidth=a,this.gl.viewportHeight=b,CAAT.GLRENDER=!0}catch(e){}if(this.gl)this.canvas=c,this.setBounds(0,0,a,b),this.enableEvents(c),this.timeline=(new Date).getTime(),this.glColorProgram=(new CAAT.WebGL.ColorProgram(this.gl)).create().initialize(),this.glTextureProgram=(new CAAT.WebGL.TextureProgram(this.gl)).create().initialize(),this.glTextureProgram.useProgram(),this.glReset(),this.coords=new Float32Array(6144),this.uv=new Float32Array(4096),this.gl.clearColor(0,0,0,255),this.front_to_back?(this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LESS)):this.gl.disable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.glEnabled=!0,this.checkDebug();else return this.initialize(a,b,c);return this},createScene:function(){var a=new CAAT.Scene;this.addScene(a);return a},setImagesCache:function(a,b,c){if(!a||!a.length)return this;var d;null!==this.glTextureManager&&(this.glTextureManager.deletePages(),this.glTextureManager=null);if(this.imagesCache){var e=[];for(d=0;d<this.imagesCache.length;d++)e.push(this.imagesCache[d].id);for(d=0;d<e.length;d++)delete this.imagesCache[e[d]]}if(this.imagesCache=a)for(d=0;d<a.length;d++)this.imagesCache[a[d].id]=a[d].image;this.tpW=b||2048;this.tpH=c||2048;this.updateGLPages();return this},updateGLPages:function(){this.glEnabled&&(this.glTextureManager=new CAAT.Module.TexturePacker.TexturePageManager,this.glTextureManager.createPages(this.gl,this.tpW,this.tpH,this.imagesCache),this.currentTexturePage=this.glTextureManager.pages[0],this.glTextureProgram.setTexture(this.currentTexturePage.texture))},setGLTexturePage:function(a){this.currentTexturePage=a;this.glTextureProgram.setTexture(a.texture);return this},addImage:function(a,b,c){if(this.getImage(a))for(var d in this.imagesCache){if(this.imagesCache[d].id===a){this.imagesCache[d].image=b;break}}else this.imagesCache.push({id:a,image:b});this.imagesCache[a]=b;c||this.updateGLPages()},deleteImage:function(a,b){for(var c=0;c<this.imagesCache.length;c++)if(this.imagesCache[c].id===a){delete this.imagesCache[a];this.imagesCache.splice(c,1);break}b||this.updateGLPages()},setGLCurrentOpacity:function(a){this.currentOpacity=a;this.glTextureProgram.setAlpha(a)},glRender:function(a,b,c){a=a||this.coords;c=c||this.uv;b=b||this.coordsIndex;var d=this.gl;b=b/12*2;this.glTextureProgram.updateVertexBuffer(a);this.glTextureProgram.updateUVBuffer(c);d.drawElements(d.TRIANGLES,3*b,d.UNSIGNED_SHORT,0)},glFlush:function(){0!==this.coordsIndex&&this.glRender(this.coords,this.coordsIndex,this.uv);this.uvIndex=this.coordsIndex=0;this.statistics.draws++},findActorAtPosition:function(a){for(var b=this.childrenList.length-1;0<=b;b--){var c=this.childrenList[b],d=new CAAT.Math.Point(a.x,a.y,0),c=c.findActorAtPosition(d);if(null!==c)return c}return this},resetStats:function(){this.statistics.size_total=0;this.statistics.size_active=0;this.statistics.draws=0;this.statistics.size_discarded_by_dirty_rects=0},render:function(a){if(!this.currentScene||!this.currentScene.isPaused()){this.time+=a;e=0;for(l=this.childrenList.length;e<l;e++){var b=this.childrenList[e];if(b.isInAnimationFrame(this.time)&&!b.isPaused()){var c=b.time-b.start_time;b.timerManager.checkTimers(c);b.timerManager.removeExpiredTimers()}}this.animate(this,this.time);!navigator.isCocoonJS&&CAAT.DEBUG&&this.resetStats();var d=this.childrenList.length,e,f=this.ctx;if(this.glEnabled){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);for(e=this.uvIndex=this.coordsIndex=0;e<d;e++)if(b=this.childrenList[e],b.isInAnimationFrame(this.time)){c=b.time-b.start_time;if(b.onRenderStart)b.onRenderStart(c);b.paintActorGL(this,c);if(b.onRenderEnd)b.onRenderEnd(c);b.isPaused()||(b.time+=a);!navigator.isCocoonJS&&CAAT.DEBUG&&(this.statistics.size_total+=b.size_total,this.statistics.size_active+=b.size_active)}this.glFlush()}else{f.globalAlpha=1;f.globalCompositeOperation="source-over";f.save();if(this.dirtyRectsEnabled)if(this.modelViewMatrix.transformRenderingContext(f),CAAT.DEBUG_DIRTYRECTS)f.clearRect(0,0,this.canvas.width,this.canvas.height);else{f.beginPath();this.nDirtyRects=0;b=this.cDirtyRects;for(e=0;e<b.length;e++)c=b[e],c.isEmpty()||(f.rect(c.x|0,c.y|0,1+(c.width|0),1+(c.height|0)),this.nDirtyRects++);f.clip()}else this.clear===CAAT.Foundation.Director.CLEAR_ALL&&f.clearRect(0,0,this.canvas.width,this.canvas.height);for(e=0;e<d;e++)if(b=this.childrenList[e],b.isInAnimationFrame(this.time)){c=b.time-b.start_time;f.save();if(b.onRenderStart)b.onRenderStart(c);!CAAT.DEBUG_DIRTYRECTS&&this.dirtyRectsEnabled?this.nDirtyRects&&b.paintActor(this,c):b.paintActor(this,c);if(b.onRenderEnd)b.onRenderEnd(c);f.restore();CAAT.DEBUGAABB&&(f.globalAlpha=1,f.globalCompositeOperation="source-over",this.modelViewMatrix.transformRenderingContextSet(f),b.drawScreenBoundingBox(this,c));b.isPaused()||(b.time+=a);!navigator.isCocoonJS&&CAAT.DEBUG&&(this.statistics.size_total+=b.size_total,this.statistics.size_active+=b.size_active,this.statistics.size_dirtyRects=this.nDirtyRects)}if(0<this.nDirtyRects&&!navigator.isCocoonJS&&CAAT.DEBUG&&CAAT.DEBUG_DIRTYRECTS){f.beginPath();this.nDirtyRects=0;b=this.cDirtyRects;for(e=0;e<b.length;e++)c=b[e],c.isEmpty()||(f.rect(c.x|0,c.y|0,1+(c.width|0),1+(c.height|0)),this.nDirtyRects++);f.clip();f.fillStyle="rgba(160,255,150,.4)";f.fillRect(0,0,this.canvas.width,this.canvas.height)}f.restore()}this.frameCounter++}},inDirtyRect:function(a){if(!this.dirtyRectsEnabled||CAAT.DEBUG_DIRTYRECTS)return!0;var b=this.cDirtyRects,c,d=a.AABB;for(c=0;c<b.length;c++)if(b[c].intersects(d))return!0;this.statistics.size_discarded_by_dirty_rects+=a.size_total;return!1},animate:function(a,b){this.timerManager.checkTimers(b);this.setModelViewMatrix(this);this.modelViewMatrixI=this.modelViewMatrix.getInverse();this.setScreenBounds();this.invalid=this.dirty=!1;this.dirtyRectsIndex=-1;this.cDirtyRects=[];var c=this.childrenList,d,e;if(this.dirtyRectsEnabled){var f=this.sDirtyRects;if(f.length){e=0;for(d=f.length;e<d;e++)this.addDirtyRect(f[e]);this.sDirtyRects=[]}}for(e=0;e<c.length;e++)d=c[e],d.animate(this,d.time-d.start_time);this.timerManager.removeExpiredTimers();return this},scheduleDirtyRect:function(a){this.sDirtyRects.push(a)},addDirtyRect:function(a){if(!a.isEmpty()){var b,c,d,e,f=this.cDirtyRects;for(b=0;b<f.length;b++)if(c=f[b],!c.isEmpty()&&c.intersects(a)){for(var g=!0;g;){c.unionRectangle(a);for(d=0;d<f.length;d++)if(d!==b&&(e=f[d],!e.isEmpty()&&e.intersects(c))){c.unionRectangle(e);e.setEmpty();break}d==f.length&&(g=!1)}for(d=0;d<f.length;d++)f[d].isEmpty()&&f.splice(d,1);return}this.dirtyRectsIndex++;if(this.dirtyRectsIndex>=this.dirtyRects.length)for(b=0;32>b;b++)this.dirtyRects.push(new CAAT.Math.Rectangle);b=this.dirtyRects[this.dirtyRectsIndex];b.x=a.x;b.y=a.y;b.x1=a.x1;b.y1=a.y1;b.width=a.width;b.height=a.height;this.cDirtyRects.push(b)}},renderToContext:function(a,b){if(b.isInAnimationFrame(this.time)){a.setTransform(1,0,0,1,0,0);a.globalAlpha=1;a.globalCompositeOperation="source-over";a.clearRect(0,0,this.width,this.height);var c=this.ctx;this.ctx=a;a.save();var d=this.modelViewMatrix,e=this.worldModelViewMatrix;this.modelViewMatrix=this.worldModelViewMatrix=new CAAT.Math.Matrix;this.wdirty=!0;b.animate(this,b.time);if(b.onRenderStart)b.onRenderStart(b.time);b.paintActor(this,b.time);if(b.onRenderEnd)b.onRenderEnd(b.time);this.worldModelViewMatrix=e;this.modelViewMatrix=d;a.restore();this.ctx=c}},addScene:function(a){a.setBounds(0,0,this.width,this.height);this.scenes.push(a);a.setEaseListener(this);null===this.currentScene&&this.setScene(0)},getNumScenes:function(){return this.scenes.length},easeInOut:function(a,b,c,d,e,f,g,h,k,m){a!==this.getCurrentSceneIndex()&&(a=this.scenes[a],d=this.scenes[d],!CAAT.__CSS__&&CAAT.CACHE_SCENE_ON_CHANGE&&(this.renderToContext(this.transitionScene.ctx,d),d=this.transitionScene),a.setExpired(!1),d.setExpired(!1),a.mouseEnabled=!1,d.mouseEnabled=!1,a.resetTransform(),d.resetTransform(),a.setLocation(0,0),d.setLocation(0,0),a.alpha=1,d.alpha=1,b===CAAT.Foundation.Scene.EASE_ROTATION?a.easeRotationIn(g,h,c,k):b===CAAT.Foundation.Scene.EASE_SCALE?a.easeScaleIn(0,g,h,c,k):a.easeTranslationIn(g,h,c,k),e===CAAT.Foundation.Scene.EASE_ROTATION?d.easeRotationOut(g,h,f,m):e===CAAT.Foundation.Scene.EASE_SCALE?d.easeScaleOut(0,g,h,f,m):d.easeTranslationOut(g,h,f,m),this.childrenList=[],d.goOut(a),a.getIn(d),this.addChild(d),this.addChild(a))},easeInOutRandom:function(a,b,c,d){var e=Math.random(),f=Math.random(),g;.33>e?(e=CAAT.Foundation.Scene.EASE_ROTATION,g=(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4)):.66>e?(e=CAAT.Foundation.Scene.EASE_SCALE,g=(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1.1,.4)):(e=CAAT.Foundation.Scene.EASE_TRANSLATE,g=(new CAAT.Behavior.Interpolator).createBounceOutInterpolator());var h;.33>f?(f=CAAT.Foundation.Scene.EASE_ROTATION,h=(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4)):.66>f?(f=CAAT.Foundation.Scene.EASE_SCALE,h=(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(4)):(f=CAAT.Foundation.Scene.EASE_TRANSLATE,h=(new CAAT.Behavior.Interpolator).createBounceOutInterpolator());this.easeInOut(a,e,8.99*Math.random()>>0,b,f,8.99*Math.random()>>0,c,d,g,h)},easeIn:function(a,b,c,d,e,f){a=this.scenes[a];b===CAAT.Foundation.Scene.EASE_ROTATION?a.easeRotationIn(c,d,e,f):b===CAAT.Foundation.Scene.EASE_SCALE?a.easeScaleIn(0,c,d,e,f):a.easeTranslationIn(c,d,e,f);this.childrenList=[];this.addChild(a);a.resetTransform();a.setLocation(0,0);a.alpha=1;a.mouseEnabled=!1;a.setExpired(!1)},setScene:function(a){a=this.scenes[a];this.childrenList=[];this.addChild(a);this.currentScene=a;a.setExpired(!1);a.mouseEnabled=!0;a.resetTransform();a.setLocation(0,0);a.alpha=1;a.getIn();a.activated()},switchToScene:function(a,b,c,d){var e=this.getSceneIndex(this.currentScene);d?this.easeInOutRandom(a,e,b,c):this.setScene(a)},switchToPrevScene:function(a,b,c){var d=this.getSceneIndex(this.currentScene);1>=this.getNumScenes()||0===d||(c?this.easeInOutRandom(d-1,d,a,b):this.setScene(d-1))},switchToNextScene:function(a,b,c){var d=this.getSceneIndex(this.currentScene);1>=this.getNumScenes()||d===this.getNumScenes()-1||(c?this.easeInOutRandom(d+1,d,a,b):this.setScene(d+1))},mouseEnter:function(a){},mouseExit:function(a){},mouseMove:function(a){},mouseDown:function(a){},mouseUp:function(a){},mouseDrag:function(a){},easeEnd:function(a,b){b?(this.currentScene=a,this.currentScene.activated()):a.setExpired(!0);a.mouseEnabled=!0;a.emptyBehaviorList()},getSceneIndex:function(a){for(var b=0;b<this.scenes.length;b++)if(this.scenes[b]===a)return b;return-1},getScene:function(a){return this.scenes[a]},getSceneById:function(a){for(var b=0;b<this.scenes.length;b++)if(this.scenes[b].id===a)return this.scenes[b];return null},getCurrentSceneIndex:function(){return this.getSceneIndex(this.currentScene)},getBrowserName:function(){return this.browserInfo.browser},getBrowserVersion:function(){return this.browserInfo.version},getOSName:function(){return this.browserInfo.OS},getImage:function(a){var b=this.imagesCache[a];if(b)return b;for(var c in this.imagesCache)if(this.imagesCache[c].id===a)return this.imagesCache[c].image;return null},musicPlay:function(a){return this.audioManager.playMusic(a)},musicStop:function(){this.audioManager.stopMusic()},addAudio:function(a,b){this.audioManager.addAudio(a,b);return this},audioPlay:function(a){return this.audioManager.play(a)},audioLoop:function(a){return this.audioManager.loop(a)},endSound:function(){return this.audioManager.endSound()},setSoundEffectsEnabled:function(a){return this.audioManager.setSoundEffectsEnabled(a)},setMusicEnabled:function(a){return this.audioManager.setMusicEnabled(a)},isMusicEnabled:function(){return this.audioManager.isMusicEnabled()},isSoundEffectsEnabled:function(){return this.audioManager.isSoundEffectsEnabled()},setVolume:function(a,b){return this.audioManager.setVolume(a,b)},emptyScenes:function(){this.scenes=[]},addChild:function(a){a.parent=this;this.childrenList.push(a)},loop:function(a,b,c){c?(this.onRenderStart=b,this.onRenderEnd=c):b&&(this.onRenderEnd=b);CAAT.loop()},renderFrame:function(){CAAT.currentDirector=this;if(!this.stopped){var a=(new Date).getTime(),b=a-this.timeline;500<b&&(b=500);if(this.onRenderStart)this.onRenderStart(b);this.render(b);this.debugInfo&&this.debugInfo(this.statistics);this.timeline=a;if(this.onRenderEnd)this.onRenderEnd(b);this.needsRepaint=!1}},resetTimeline:function(){this.timeline=(new Date).getTime()},endLoop:function(){},setClear:function(a){this.clear=a;this.dirtyRectsEnabled=this.clear===CAAT.Foundation.Director.CLEAR_DIRTY_RECTS?!0:!1;return this},getAudioManager:function(){return this.audioManager},cumulateOffset:function(a,b,c){var d=c+"Left";c+="Top";for(var e=0,f=0,g;"iOS"!==navigator.browser&&a&&a.style&&(g=a.currentStyle?a.currentStyle.position:(g=(a.ownerDocument.defaultView||a.ownerDocument.parentWindow).getComputedStyle(a,null))?g.getPropertyValue("position"):null,!/^(fixed)$/.test(g));)e+=a[d],f+=a[c],a=a[b];return{x:e,y:f,style:g}},getOffset:function(a){var b=this.cumulateOffset(a,"offsetParent","offset");return"fixed"===b.style?(a=this.cumulateOffset(a,a.parentNode?"parentNode":"parentElement","scroll"),{x:b.x+
a.x,y:b.y+a.y}):{x:b.x,y:b.y}},getCanvasCoord:function(a,b){var c=new CAAT.Math.Point,d=0,e=0;b||(b=window.event);if(b.pageX||b.pageY)d=b.pageX,e=b.pageY;else if(b.clientX||b.clientY)d=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=b.clientY+document.body.scrollTop+document.documentElement.scrollTop;var f=this.getOffset(this.canvas),d=d-f.x,e=e-f.y,d=d*this.SCREEN_RATIO,e=e*this.SCREEN_RATIO;c.x=d;c.y=e;this.modelViewMatrixI||(this.modelViewMatrixI=this.modelViewMatrix.getInverse());this.modelViewMatrixI.transformCoord(c);d=c.x;e=c.y;a.set(d,e);this.screenMousePoint.set(d,e)},__mouseDownHandler:function(a){if(this.dragging&&this.lastSelectedActor)this.__mouseUpHandler(a);else{this.getCanvasCoord(this.mousePoint,a);this.isMouseDown=!0;var b=this.findActorAtPosition(this.mousePoint);if(null!==b){var c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0));b.mouseDown((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y)))}this.lastSelectedActor=b}},__mouseUpHandler:function(a){this.isMouseDown=!1;this.getCanvasCoord(this.mousePoint,a);var b=null,c=this.lastSelectedActor;null!==c&&(b=c.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),c.actionPerformed&&c.contains(b.x,b.y)&&c.actionPerformed(a),c.mouseUp((new CAAT.Event.MouseEvent).init(b.x,b.y,a,c,this.screenMousePoint,this.currentScene.time)));this.dragging||null===c||c.contains(b.x,b.y)&&c.mouseClick((new CAAT.Event.MouseEvent).init(b.x,b.y,a,c,this.screenMousePoint,this.currentScene.time));this.in_=this.dragging=!1},__mouseMoveHandler:function(a){var b,c,d=this.currentScene?this.currentScene.time:0;if(this.isMouseDown&&null!==this.lastSelectedActor){if(b=this.lastSelectedActor,c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),this.dragging||!(Math.abs(this.prevMousePoint.x-c.x)<CAAT.DRAG_THRESHOLD_X&&Math.abs(this.prevMousePoint.y-c.y)<CAAT.DRAG_THRESHOLD_Y)){this.dragging=!0;var e=b.x,f=b.y;b.mouseDrag((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y),d));this.prevMousePoint.x=c.x;this.prevMousePoint.y=c.y;e===b.x&&f===b.y&&(e=b.contains(c.x,c.y),this.in_&&!e&&(b.mouseExit((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,d)),this.in_=!1),!this.in_&&e&&(b.mouseEnter((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,d)),this.in_=!0))}}else this.in_=!0,b=this.findActorAtPosition(this.mousePoint),b!==this.lastSelectedActor&&(null!==this.lastSelectedActor&&(c=this.lastSelectedActor.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),this.lastSelectedActor.mouseExit((new CAAT.Event.MouseEvent).init(c.x,c.y,a,this.lastSelectedActor,this.screenMousePoint,d))),null!==b&&(c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),b.mouseEnter((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,d)))),c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),null!==b&&b.mouseMove((new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,d)),this.prevMousePoint.x=c.x,this.prevMousePoint.y=c.y,this.lastSelectedActor=b},__mouseOutHandler:function(a){if(!this.dragging)if(null!==this.lastSelectedActor){this.getCanvasCoord(this.mousePoint,a);var b=new CAAT.Math.Point(this.mousePoint.x,this.mousePoint.y,0);this.lastSelectedActor.viewToModel(b);a=(new CAAT.Event.MouseEvent).init(b.x,b.y,a,this.lastSelectedActor,this.screenMousePoint,this.currentScene.time);this.lastSelectedActor.mouseExit(a);this.lastSelectedActor.mouseOut(a);this.dragging||(this.lastSelectedActor=null)}else this.in_=this.isMouseDown=!1},__mouseOverHandler:function(a){if(!this.dragging){var b,c;null==this.lastSelectedActor?(b=this.findActorAtPosition(this.mousePoint),null!==b&&(c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),a=(new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,this.currentScene?this.currentScene.time:0),b.mouseOver(a),b.mouseEnter(a)),this.lastSelectedActor=b):(b=this.lastSelectedActor,c=b.viewToModel(new CAAT.Math.Point(this.screenMousePoint.x,this.screenMousePoint.y,0)),a=(new CAAT.Event.MouseEvent).init(c.x,c.y,a,b,this.screenMousePoint,this.currentScene.time),b.mouseOver(a),b.mouseEnter(a))}},__mouseDBLClickHandler:function(a){this.getCanvasCoord(this.mousePoint,a);null!==this.lastSelectedActor&&this.lastSelectedActor.mouseDblClick((new CAAT.Event.MouseEvent).init(this.mousePoint.x,this.mousePoint.y,a,this.lastSelectedActor,this.screenMousePoint,this.currentScene.time))},__touchStartHandler:function(a){if(a.target===this.canvas){a=a.targetTouches[0];var b=this.mousePoint;this.getCanvasCoord(b,a);0>b.x||0>b.y||b.x>=this.width||b.y>=this.height||(this.touching=!0,this.__mouseDownHandler(a))}},__touchEndHandler:function(a){this.touching&&(a=a.changedTouches[0],this.getCanvasCoord(this.mousePoint,a),this.touching=!1,this.__mouseUpHandler(a))},__touchMoveHandler:function(a){if(this.touching&&!this.gesturing)for(var b=0;b<a.targetTouches.length;b++){var c=a.targetTouches[b];this.getCanvasCoord(this.mousePoint,c);this.__mouseMoveHandler(c)}},__gestureStart:function(a,b){this.gesturing=!0;this.__gestureRotation=this.lastSelectedActor.rotationAngle;this.__gestureSX=this.lastSelectedActor.scaleX-1;this.__gestureSY=this.lastSelectedActor.scaleY-1},__gestureChange:function(a,b){"undefined"!==typeof a&&"undefined"!==typeof b&&null!==this.lastSelectedActor&&this.lastSelectedActor.isGestureEnabled()&&(this.lastSelectedActor.setRotation(b*Math.PI/180+this.__gestureRotation),this.lastSelectedActor.setScale(this.__gestureSX+a,this.__gestureSY+a))},__gestureEnd:function(a,b){this.gesturing=!1;this.__gestureScale=this.__gestureRotation=0},__touchEndHandlerMT:function(a){a.preventDefault();a.returnValue=!1;var b,c=[];for(b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b].identifier;c.push(d)}var e={};for(b=0;b<c.length;b++){var f=c[b];this.touches[f]&&(d=this.touches[f].actor,e[d.id]||(e[d.id]={actor:d,touch:(new CAAT.Event.TouchEvent).init(a,d,this.currentScene.time)}),e[d.id].touch.addChangedTouch(this.touches[f].touch))}for(b=0;b<a.changedTouches.length;b++)c=a.changedTouches[b],d=c.identifier,delete this.touches[d];for(var g in e){a=e[g];var d=a.actor,c=a.touch,h;for(h in this.touches)a=this.touches[h],a.actor.id===d.id&&c.addTouch(a.touch);d.touchEnd(c)}},__touchMoveHandlerMT:function(a){a.preventDefault();a.returnValue=!1;var b,c=[];for(b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=d.identifier;if(this.touches[e]){var f=this.mousePoint;this.getCanvasCoord(f,d);var g=this.touches[e].actor,f=g.viewToModel(f);this.touches[e]={actor:g,touch:new CAAT.Event.TouchInfo(e,f.x,f.y,g)};c.push(e)}}e={};for(b=0;b<c.length;b++)d=c[b],g=this.touches[d].actor,e[g.id]||(e[g.id]={actor:g,touch:(new CAAT.Event.TouchEvent).init(a,g,this.currentScene.time)}),g=e[g.id].touch,g.addTouch(this.touches[d].touch),g.addChangedTouch(this.touches[d].touch);for(var h in e){a=e[h];var g=a.actor,d=a.touch,k;for(k in this.touches)a=this.touches[k],a.actor.id===g.id&&d.addTouch(a.touch);g.touchMove(d)}},__touchCancelHandleMT:function(a){this.__touchEndHandlerMT(a)},__touchStartHandlerMT:function(a){a.preventDefault();a.returnValue=!1;var b,c=[];for(b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=d.identifier,f=this.mousePoint;this.getCanvasCoord(f,d);if(!(0>f.x||0>f.y||f.x>=this.width||f.y>=this.height)){var g=this.findActorAtPosition(f);null!==g&&(f=g.viewToModel(f),this.touches[e]||(this.touches[e]={actor:g,touch:new CAAT.Event.TouchInfo(e,f.x,f.y,g)},c.push(e)))}}e={};for(b=0;b<c.length;b++)d=c[b],g=this.touches[d].actor,e[g.id]||(e[g.id]={actor:g,touch:(new CAAT.Event.TouchEvent).init(a,g,this.currentScene.time)}),g=e[g.id].touch,g.addTouch(this.touches[d].touch),g.addChangedTouch(this.touches[d].touch);for(var h in e){a=e[h];var g=a.actor,d=a.touch,k;for(k in this.touches)a=this.touches[k],a.actor.id===g.id&&d.addTouch(a.touch);g.touchStart(d)}},__findTouchFirstActor:function(){var a=Number.MAX_VALUE,b=null,c;for(c in this.touches){var d=this.touches[c];d.touch.time&&d.touch.time<a&&d.actor.isGestureEnabled()&&(b=d.actor,a=d.touch.time)}return b},__gesturedActor:null,__touchGestureStartHandleMT:function(a){var b=this.__findTouchFirstActor();null!==b&&b.isGestureEnabled()&&(this.__gesturedActor=b,this.__gestureRotation=b.rotationAngle,this.__gestureSX=b.scaleX-1,this.__gestureSY=b.scaleY-1,b.gestureStart(a.rotation*Math.PI/180,a.scale+this.__gestureSX,a.scale+this.__gestureSY))},__touchGestureEndHandleMT:function(a){null!==this.__gesturedActor&&this.__gesturedActor.isGestureEnabled()&&this.__gesturedActor.gestureEnd(a.rotation*Math.PI/180,a.scale+this.__gestureSX,a.scale+this.__gestureSY);this.__gestureScale=this.__gestureRotation=0},__touchGestureChangeHandleMT:function(a){null!==this.__gesturedActor&&this.__gesturedActor.isGestureEnabled()&&this.__gesturedActor.gestureChange(a.rotation*Math.PI/180,this.__gestureSX+a.scale,this.__gestureSY+a.scale)},addHandlers:function(a){var b=this;window.addEventListener("mouseup",function(a){b.touching&&(a.preventDefault(),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),b.getCanvasCoord(b.mousePoint,a),b.__mouseUpHandler(a),b.touching=!1)},!1);window.addEventListener("mousedown",function(c){if(c.target===a){c.preventDefault();c.cancelBubble=!0;c.stopPropagation&&c.stopPropagation();var d=b.mousePoint;b.getCanvasCoord(d,c);0>d.x||0>d.y||d.x>=b.width||d.y>=b.height||(b.touching=!0,b.__mouseDownHandler(c))}},!1);window.addEventListener("mouseover",function(c){if(c.target===a&&!b.dragging){c.preventDefault();c.cancelBubble=!0;c.stopPropagation&&c.stopPropagation();var d=b.mousePoint;b.getCanvasCoord(d,c);0>d.x||0>d.y||d.x>=b.width||d.y>=b.height||b.__mouseOverHandler(c)}},!1);window.addEventListener("mouseout",function(c){c.target!==a||b.dragging||(c.preventDefault(),c.cancelBubble=!0,c.stopPropagation&&c.stopPropagation(),b.getCanvasCoord(b.mousePoint,c),b.__mouseOutHandler(c))},!1);window.addEventListener("mousemove",function(a){a.preventDefault();a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();var d=b.mousePoint;b.getCanvasCoord(d,a);!b.dragging&&(0>d.x||0>d.y||d.x>=b.width||d.y>=b.height)||b.__mouseMoveHandler(a)},!1);window.addEventListener("dblclick",function(c){if(c.target===a){c.preventDefault();c.cancelBubble=!0;c.stopPropagation&&c.stopPropagation();var d=b.mousePoint;b.getCanvasCoord(d,c);0>d.x||0>d.y||d.x>=b.width||d.y>=b.height||b.__mouseDBLClickHandler(c)}},!1);CAAT.TOUCH_BEHAVIOR===CAAT.TOUCH_AS_MOUSE?(a.addEventListener("touchstart",this.__touchStartHandler.bind(this),!1),a.addEventListener("touchmove",this.__touchMoveHandler.bind(this),!1),a.addEventListener("touchend",this.__touchEndHandler.bind(this),!1),a.addEventListener("gesturestart",function(c){c.target===a&&(c.preventDefault(),c.returnValue=!1,b.__gestureStart(c.scale,c.rotation))},!1),a.addEventListener("gestureend",function(c){c.target===a&&(c.preventDefault(),c.returnValue=!1,b.__gestureEnd(c.scale,c.rotation))},!1),a.addEventListener("gesturechange",function(c){c.target===a&&(c.preventDefault(),c.returnValue=!1,b.__gestureChange(c.scale,c.rotation))},!1)):CAAT.TOUCH_BEHAVIOR===CAAT.TOUCH_AS_MULTITOUCH&&(a.addEventListener("touchstart",this.__touchStartHandlerMT.bind(this),!1),a.addEventListener("touchmove",this.__touchMoveHandlerMT.bind(this),!1),a.addEventListener("touchend",this.__touchEndHandlerMT.bind(this),!1),a.addEventListener("touchcancel",this.__touchCancelHandleMT.bind(this),!1),a.addEventListener("gesturestart",this.__touchGestureStartHandleMT.bind(this),!1),a.addEventListener("gestureend",this.__touchGestureEndHandleMT.bind(this),!1),a.addEventListener("gesturechange",this.__touchGestureChangeHandleMT.bind(this),!1))},enableEvents:function(a){CAAT.RegisterDirector(this);this.in_=!1;this.createEventHandler(a)},createEventHandler:function(a){this.in_=!1;this.addHandlers(a)}}},onCreate:function(){"undefined"!==typeof CAAT.__CSS__&&(CAAT.Foundation.Director.prototype.clip=!0,CAAT.Foundation.Director.prototype.glEnabled=!1,CAAT.Foundation.Director.prototype.getRenderType=function(){return"CSS"},CAAT.Foundation.Director.prototype.setScaleProportional=function(a,b){var c=Math.min(a/this.referenceWidth,b/this.referenceHeight);this.setScaleAnchored(c,c,0,0);this.eventHandler.style.width=""+this.referenceWidth+"px";this.eventHandler.style.height=""+this.referenceHeight+"px"},CAAT.Foundation.Director.prototype.setBounds=function(a,b,c,d){CAAT.Foundation.Director.superclass.setBounds.call(this,a,b,c,d);for(a=0;a<this.scenes.length;a++)this.scenes[a].setBounds(0,0,c,d);this.eventHandler.style.width=c+"px";this.eventHandler.style.height=d+"px";return this},CAAT.Foundation.Director.prototype.initialize=function(a,b,c,d){this.timeline=(new Date).getTime();this.domElement=c;this.style("position","absolute");this.style("width",""+a+"px");this.style("height",""+b+"px");this.style("overflow","hidden");this.enableEvents(c);this.setBounds(0,0,a,b);this.checkDebug();return this},CAAT.Foundation.Director.prototype.render=function(a){this.time+=a;this.animate(this,a);var b,c,d;!navigator.isCocoonJS&&CAAT.DEBUG&&this.resetStats();b=0;for(c=this.childrenList.length;b<c;b++){var e=this.childrenList[b];e.isInAnimationFrame(this.time)&&!e.isPaused()&&(d=e.time-e.start_time,e.timerManager.checkTimers(d),e.timerManager.removeExpiredTimers())}b=0;for(c=this.childrenList.length;b<c;b++)if(e=this.childrenList[b],e.isInAnimationFrame(this.time)){d=e.time-e.start_time;if(e.onRenderStart)e.onRenderStart(d);e.paintActor(this,d);if(e.onRenderEnd)e.onRenderEnd(d);e.isPaused()||(e.time+=a);!navigator.isCocoonJS&&CAAT.DEBUG&&(this.statistics.size_discarded_by_dirtyRects+=this.drDiscarded,this.statistics.size_total+=e.size_total,this.statistics.size_active+=e.size_active,this.statistics.size_dirtyRects=this.nDirtyRects)}this.frameCounter++},CAAT.Foundation.Director.prototype.addScene=function(a){a.setVisible(!0);a.setBounds(0,0,this.width,this.height);this.scenes.push(a);a.setEaseListener(this);null===this.currentScene&&this.setScene(0);this.domElement.appendChild(a.domElement)},CAAT.Foundation.Director.prototype.emptyScenes=function(){this.scenes=[];this.domElement.innerHTML="";this.createEventHandler()},CAAT.Foundation.Director.prototype.setClear=function(a){return this},CAAT.Foundation.Director.prototype.createEventHandler=function(){this.eventHandler=document.createElement("div");this.domElement.appendChild(this.eventHandler);this.eventHandler.style.position="absolute";this.eventHandler.style.left="0";this.eventHandler.style.top="0";this.eventHandler.style.zIndex=999999;this.eventHandler.style.width=""+this.width+"px";this.eventHandler.style.height=""+this.height+"px";this.canvas=this.eventHandler;this.in_=!1;this.addHandlers(this.canvas)},CAAT.Foundation.Director.prototype.inDirtyRect=function(){return!0})}});CAAT.Module({defines:"CAAT.Foundation.UI.Dock",aliases:["CAAT.Dock"],extendsClass:"CAAT.Foundation.ActorContainer",depends:["CAAT.Foundation.ActorContainer","CAAT.Behavior.GenericBehavior"],constants:{OP_LAYOUT_BOTTOM:0,OP_LAYOUT_TOP:1,OP_LAYOUT_LEFT:2,OP_LAYOUT_RIGHT:3},extendsWith:{scene:null,ttask:null,minSize:0,maxSize:0,range:2,layoutOp:0,initialize:function(a){this.scene=a;return this},setApplicationRange:function(a){this.range=a;return this},setLayoutOp:function(a){this.layoutOp=a;return this},setSizes:function(a,b){this.minSize=a;this.maxSize=b;for(var c=0;c<this.childrenList.length;c++)this.childrenList[c].width=a,this.childrenList[c].height=a;return this},layout:function(){var a,b,c=CAAT.Foundation.UI.Dock;if(this.layoutOp===c.OP_LAYOUT_BOTTOM||this.layoutOp===c.OP_LAYOUT_TOP){var d=b=0;for(a=0;a<this.getNumChildren();a++)b+=this.getChildAt(a).width;d=(this.width-b)/2;for(a=0;a<this.getNumChildren();a++)b=this.getChildAt(a),b.x=d,d+=b.width,b.y=this.layoutOp===c.OP_LAYOUT_BOTTOM?this.maxSize-
b.height:0}else{for(a=d=b=0;a<this.getNumChildren();a++)b+=this.getChildAt(a).height;d=(this.height-b)/2;for(a=0;a<this.getNumChildren();a++)b=this.getChildAt(a),b.y=d,d+=b.height,b.x=this.layoutOp===c.OP_LAYOUT_LEFT?0:this.width-b.width}},mouseMove:function(a){this.actorNotPointed()},mouseExit:function(a){this.actorNotPointed()},actorNotPointed:function(){var a,b=this;for(a=0;a<this.getNumChildren();a++){var c=this.getChildAt(a);c.emptyBehaviorList();c.addBehavior((new CAAT.Behavior.GenericBehavior).setValues(c.width,this.minSize,c,"width").setFrameTime(this.scene.time,250)).addBehavior((new CAAT.Behavior.GenericBehavior).setValues(c.height,this.minSize,c,"height").setFrameTime(this.scene.time,250));a===this.getNumChildren()-1&&c.behaviorList[0].addListener({behaviorApplied:function(a,b,c,g,h){g.parent.layout()},behaviorExpired:function(d,e,f){for(a=0;a<b.getNumChildren();a++)c=b.getChildAt(a),c.width=b.minSize,c.height=b.minSize;f.parent.layout()}})}},actorPointed:function(a,b,c){var d=this.findChild(c),e=CAAT.Foundation.UI.Dock,f=0,f=this.layoutOp===e.OP_LAYOUT_BOTTOM||this.layoutOp===e.OP_LAYOUT_TOP?a/c.width:b/c.height;for(a=0;a<this.childrenList.length;a++)b=this.childrenList[a],b.emptyBehaviorList(),c=0,c=a<d-this.range||a>d+this.range?this.minSize:a===d?this.maxSize:a<d?this.minSize+(this.maxSize-this.minSize)*(Math.cos((a-d-f+1)/this.range*Math.PI)+1)/2:this.minSize+(this.maxSize-this.minSize)*(Math.cos((a-d-f)/this.range*Math.PI)+1)/2,b.height=c,b.width=c;this.layout()},actorMouseExit:function(a){null!==this.ttask&&this.ttask.cancel();var b=this;this.ttask=this.scene.createTimer(this.scene.time,100,function(a,d,e){b.actorNotPointed()},null,null)},actorMouseEnter:function(a){null!==this.ttask&&(this.ttask.cancel(),this.ttask=null)},addChild:function(a){var b=this;a.__Dock_mouseEnter=a.mouseEnter;a.__Dock_mouseExit=a.mouseExit;a.__Dock_mouseMove=a.mouseMove;a.mouseEnter=function(a){b.actorMouseEnter(a);this.__Dock_mouseEnter(a)};a.mouseExit=function(a){b.actorMouseExit(a);this.__Dock_mouseExit(a)};a.mouseMove=function(a){b.actorPointed(a.point.x,a.point.y,a.source);this.__Dock_mouseMove(a)};a.width=this.minSize;a.height=this.minSize;return CAAT.Foundation.UI.Dock.superclass.addChild.call(this,a)}}});CAAT.Module({defines:"CAAT.Foundation.UI.InterpolatorActor",aliases:["CAAT.InterpolatorActor"],depends:["CAAT.Foundation.Actor"],extendsClass:"CAAT.Foundation.Actor",extendsWith:{interpolator:null,contour:null,S:50,gap:5,setGap:function(a){this.gap=a;return this},setInterpolator:function(a,b){this.interpolator=a;this.contour=a.getContour(b||this.S);return this},paint:function(a,b){CAAT.InterpolatorActor.superclass.paint.call(this,a,b);if(this.backgroundImage)return this;if(this.interpolator){var c=a.ctx,d=this.width-2*this.gap,e=this.height-2*this.gap;c.beginPath();c.moveTo(this.gap+d*this.contour[0].x,-this.gap+this.height-e*this.contour[0].y);for(var f=1;f<this.contour.length;f++)c.lineTo(this.gap+d*this.contour[f].x,-this.gap+this.height-e*this.contour[f].y);c.strokeStyle=this.strokeStyle;c.stroke()}},getInterpolator:function(){return this.interpolator}}});CAAT.Module({defines:"CAAT.Foundation.UI.Label",depends:["CAAT.Foundation.Actor","CAAT.Foundation.SpriteImage","CAAT.Module.Font.Font","CAAT.Foundation.UI.Layout.LayoutManager"],aliases:["CAAT.UI.Label"],extendsClass:"CAAT.Foundation.Actor",extendsWith:function(){var a=function(a){this.ctx=a;return this};a.prototype={ctx:null,defaultFS:null,font:null,fontSize:null,fill:null,stroke:null,filled:null,stroked:null,strokeSize:null,italic:null,bold:null,alignment:null,tabSize:null,shadow:null,shadowBlur:null,shadowColor:null,sfont:null,chain:null,setDefault:function(a){this.defaultFS=24;this.font="Arial";this.fontSize=this.defaultFS;this.fill="#000";this.stroke="#f00";this.filled=!0;this.stroked=!1;this.strokeSize=1;this.bold=this.italic=!1;this.alignment="left";this.tabSize=75;this.shadow=!1;this.shadowBlur=0;this.shadowColor="#000";for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.__setFont();return this},setStyle:function(a){if("undefined"!==typeof a)for(var b in a)this[b]=a[b];return this},applyStyle:function(){this.__setFont();return this},clone:function(){var b=new a(this.ctx),c;for(c in this)this.hasOwnProperty(c)&&(b[c]=this[c]);for(var d=this;d.chain;)for(c in d=d.chain,d)null===b[c]&&d.hasOwnProperty(c)&&(b[c]=d[c]);b.__setFont();return b},__getProperty:function(a){var b=this,c;do{c=b[a];if(null!==c)return c;b=b.chain}while(b);return null},image:function(a){this.__setShadow(a)},text:function(a,b,c,d){this.__setShadow(a);a.font=this.__getProperty("sfont");this.filled&&this.__fillText(a,b,c,d);this.stroked&&this.__strokeText(a,b,c,d)},__setShadow:function(a){this.__getProperty("shadow")&&(a.shadowBlur=this.__getProperty("shadowBlur"),a.shadowColor=this.__getProperty("shadowColor"))},__fillText:function(a,b,c,d){a.fillStyle=this.__getProperty("fill");a.fillText(b,c,d)},__strokeText:function(a,b,c,d){a.strokeStyle=this.__getProperty("stroke");a.lineWidth=this.__getProperty("strokeSize");a.beginPath();a.strokeText(b,c,d)},__setFont:function(){var a=this.__getProperty("italic"),b=this.__getProperty("bold"),c=this.__getProperty("fontSize"),d=this.__getProperty("font");this.sfont=(a?"italic ":"")+(b?"bold ":"")+c+"px "+d;this.ctx.font=this.__getProperty("sfont")},setBold:function(a){a!=this.bold&&(this.bold=a,this.__setFont())},setItalic:function(a){a!=this.italic&&(this.italic=a,this.__setFont())},setStroked:function(a){this.stroked=a},setFilled:function(a){this.filled=a},getTabPos:function(a){var b=this.__getProperty("tabSize");return((a/b>>0)+1)*b},setFillStyle:function(a){this.fill=a},setStrokeStyle:function(a){this.stroke=a},setStrokeSize:function(a){this.strokeSize=a},setAlignment:function(a){this.alignment=a},setFontSize:function(a){a!==this.fontSize&&(this.fontSize=a,this.__setFont())}};var b=function(){this.text="";return this};b.prototype={x:0,y:0,width:0,text:null,crcs:null,rcs:null,styles:null,images:null,lines:null,documentHeight:0,anchorStack:null,__nextLine:function(){this.x=0;this.currentLine=new f(CAAT.Module.Font.Font.getFontMetrics(this.crcs.sfont));this.lines.push(this.currentLine)},__image:function(a,b,c){var e;e=b&&c?a.getWidth():a.getWrappedImageWidth();this.width&&e+this.x>this.width&&0<this.x&&this.__nextLine();this.currentLine.addElementImage(new d(this.x,a,b,c,this.crcs.clone(),this.__getCurrentAnchor()));this.x+=e},__text:function(){if(0!==this.text.length){var a=this.ctx.measureText(this.text).width;this.width&&a+this.x>this.width&&0<this.x&&this.__nextLine();this.currentLine.addElement(new e(this.text,this.x,a,0,this.crcs.clone(),this.__getCurrentAnchor()));this.x+=a;this.text=""}},fchar:function(a){" "===a?(this.__text(),this.x+=this.ctx.measureText(a).width,this.width&&this.x>this.width&&this.__nextLine()):this.text+=a},end:function(){0<this.text.length&&this.__text();for(var a=0,b=0,c=0;c<this.lines.length;c++){var d=this.lines[c].getHeight();0===d&&(d=this.styles["default"].fontSize);a+=d;c===this.lines.length-1&&(b=.25*d>>0);this.lines[c].setY(a)}this.documentHeight=a+b},getDocumentHeight:function(){return this.documentHeight},__getCurrentAnchor:function(){return this.anchorStack.length?this.anchorStack[this.anchorStack.length-
1]:null},__resetAppliedStyles:function(){this.rcs=[];this.__pushDefaultStyles()},__pushDefaultStyles:function(){this.crcs=(new a(this.ctx)).setDefault(this.styles["default"]);this.rcs.push(this.crcs)},__pushStyle:function(b){var c=this.crcs;this.crcs=new a(this.ctx);this.crcs.chain=c;this.crcs.setStyle(b);this.crcs.applyStyle();this.rcs.push(this.crcs)},__popStyle:function(){1<this.rcs.length&&(this.rcs.pop(),this.crcs=this.rcs[this.rcs.length-1],this.crcs.applyStyle())},__popAnchor:function(){0<this.anchorStack.length&&this.anchorStack.pop()},__pushAnchor:function(a){this.anchorStack.push(a)},start:function(a,b,c,d){this.y=this.x=0;this.width="undefined"!==typeof d?d:0;this.ctx=a;this.lines=[];this.styles=b;this.images=c;this.anchorStack=[];this.__resetAppliedStyles();this.__nextLine()},setTag:function(a){this.__text();a=a.toLowerCase();if("b"===a)this.crcs.setBold(!0);else if("/b"===a)this.crcs.setBold(!1);else if("i"===a)this.crcs.setItalic(!0);else if("/i"===a)this.crcs.setItalic(!1);else if("stroked"===a)this.crcs.setStroked(!0);else if("/stroked"===a)this.crcs.setStroked(!1);else if("filled"===a)this.crcs.setFilled(!0);else if("/filled"===a)this.crcs.setFilled(!1);else if("tab"===a)this.x=this.crcs.getTabPos(this.x);else if("br"===a)this.__nextLine();else if("/a"===a)this.__popAnchor();else if("/style"===a)1<this.rcs.length&&this.__popStyle();else if(0===a.indexOf("fillcolor"))a=a.split("="),this.crcs.setFillStyle(a[1]);else if(0===a.indexOf("strokecolor"))a=a.split("="),this.crcs.setStrokeStyle(a[1]);else if(0===a.indexOf("strokesize"))a=a.split("="),this.crcs.setStrokeSize(a[1]|0);else if(0===a.indexOf("fontsize"))a=a.split("="),this.crcs.setFontSize(a[1]|0);else if(0===a.indexOf("style"))a=a.split("="),(a=this.styles[a[1]])&&this.__pushStyle(a);else if(0===a.indexOf("image")){a=a.split("=")[1].split(",");var b=a[0];if(this.images[b]){var c=0,d=0;3<=a.length&&(c=a[1]|0,d=a[2]|0);this.__image(this.images[b],c,d)}}else 0===a.indexOf("a=")&&(a=a.split("="),this.__pushAnchor(a[1]))}};var c=function(a,b){this.link=a;this.style=b;return this};c.prototype={x:null,y:null,width:null,height:null,style:null,link:null,isLink:function(){return this.link},setLink:function(a){this.link=a;return this},getLink:function(){return this.link},contains:function(a,b){return!1}};var d=function(a,b,c,e,f,p){d.superclass.constructor.call(this,p,f);this.x=a;this.image=b;this.row=c;this.column=e;this.width=b.getWidth();this.height=b.getHeight();if(this.image instanceof CAAT.SpriteImage||this.image instanceof CAAT.Foundation.SpriteImage)this.spriteIndex=c*b.columns+e,this.paint=this.paintSI;return this};d.prototype={image:null,row:null,column:null,spriteIndex:null,paint:function(a){this.style.image(a);a.drawImage(this.image,this.x,-this.height+1)},paintSI:function(a){this.style.image(a);this.image.setSpriteIndex(this.spriteIndex);this.image.paint({ctx:a},0,this.x,-this.height+1)},getHeight:function(){return this.image instanceof CAAT.Foundation.SpriteImage?this.image.singleHeight:this.image.height},getFontMetrics:function(){return null},contains:function(a,b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<this.y+this.height},setYPosition:function(a){this.y=a-this.height+1}};var e=function(a,b,c,d,f,p){e.superclass.constructor.call(this,p,f);this.x=b;this.y=0;this.width=c;this.text=a;this.style=f;this.fm=CAAT.Module.Font.Font.getFontMetrics(f.sfont);this.height=this.fm.height;return this};e.prototype={text:null,style:null,fm:null,bl:null,paint:function(a){this.style.text(a,this.text,this.x,0)},getHeight:function(){return this.fm.height},getFontMetrics:function(){return this.fm},contains:function(a,b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height},setYPosition:function(a){this.bl=a;this.y=a-this.fm.ascent}};extend(d,c);extend(e,c);var f=function(a){this.elements=[];this.defaultFontMetrics=a;return this};f.prototype={elements:null,width:0,height:0,defaultHeight:0,y:0,x:0,alignment:null,baselinePos:0,addElement:function(a){this.width=Math.max(this.width,a.x+a.width);this.height=Math.max(this.height,a.height);this.elements.push(a);this.alignment=a.style.__getProperty("alignment")},addElementImage:function(a){this.width=Math.max(this.width,a.x+a.width);this.height=Math.max(this.height,a.height);this.elements.push(a)},getHeight:function(){return this.height},setY:function(a){this.y=a},getY:function(){return this.y},paint:function(a){a.save();a.translate(this.x,this.y+this.baselinePos);for(var b=0;b<this.elements.length;b++)this.elements[b].paint(a);a.restore()},setAlignment:function(a){var b;if("center"===this.alignment)this.x=(a-this.width)/2;else if("right"===this.alignment)this.x=a-this.width;else if("justify"===this.alignment&&.6<=this.width/a&&1<this.elements.length){var c=a-this.width,c=c/(this.elements.length-1)|0;for(b=1;b<this.elements.length;b++)this.elements[b].x+=b*c;c=a-this.width-c*(this.elements.length-1);for(b=0;b<c;b++)this.elements[this.elements.length-1-b].x+=c-b}},adjustHeight:function(){var a=null,b=null,c;for(c=0;c<this.elements.length;c+=1){var d=this.elements[c],e=d.getFontMetrics();null!=e?a?e.ascent>a.ascent&&(a=e):a=e:b?d.getHeight()>d.getHeight()&&(b=d):b=d}this.baselinePos=Math.max(a?a.ascent:this.defaultFontMetrics.ascent,b?b.getHeight():this.defaultFontMetrics.ascent);this.height=this.baselinePos+(null!=a?a.descent:this.defaultFontMetrics.descent);for(c=0;c<this.elements.length;c++)this.elements[c].setYPosition(this.baselinePos);return this.height},__getElementAt:function(a,b){for(var c=0;c<this.elements.length;c++){var d=this.elements[c];if(d.contains(a,b))return d}return null}};return{__init:function(){this.__super();this.rc=new b;this.lines=[];this.styles={};this.images={};return this},halignment:CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.LEFT,valignment:CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.TOP,text:null,rc:null,styles:null,documentWidth:0,documentHeight:0,documentX:0,documentY:0,reflow:!0,lines:null,images:null,clickCallback:null,setStyle:function(a,b){this.styles[a]=b;return this},addImage:function(a,b){this.images[a]=b;return this},setSize:function(a,b){CAAT.Foundation.UI.Label.superclass.setSize.call(this,a,b);this.setText(this.text,this.width);return this},setBounds:function(a,b,c,d){CAAT.Foundation.UI.Label.superclass.setBounds.call(this,a,b,c,d);this.setText(this.text,this.width);return this},setText:function(a,b){if(null!==a){var c=this.cached;c&&this.stopCacheAsBitmap();this.documentHeight=this.documentWidth=0;this.text=a;var d,e,f,r,q,t,u=CAAT.currentDirector.ctx;u.save();f=this.text;d=0;e=f.length;for(this.rc.start(u,this.styles,this.images,b);d<e;)t=f.charAt(d),"\\"===t?(d+=1,this.rc.fchar(f.charAt(d)),d+=1):"<"===t?(r=f.indexOf(">",d+1),-1!==r&&(q=f.substr(d+1,r-d-1),-1!==q.indexOf("<")?(this.rc.fchar(t),d+=1):(this.rc.setTag(q),d=r+1))):(this.rc.fchar(t),d+=1);this.rc.end();this.lines=this.rc.lines;this.__calculateDocumentDimension("undefined"===typeof b?0:b);this.setLinesAlignment();u.restore();this.setPreferredSize(this.documentWidth,this.documentHeight);this.invalidateLayout();this.setDocumentPosition();c&&this.cacheAsBitmap(0,c);return this}},setVerticalAlignment:function(a){this.valignment=a;this.setDocumentPosition();return this},setHorizontalAlignment:function(a){this.halignment=a;this.setDocumentPosition();return this},setDocumentPosition:function(){var a=0,b=0;this.valignment===CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.CENTER?b=(this.height-this.documentHeight)/2:this.valignment===CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.BOTTOM&&(b=this.height-this.documentHeight);this.halignment===CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.CENTER?a=(this.width-this.documentWidth)/2:this.halignment===CAAT.Foundation.UI.Layout.LayoutManager.ALIGNMENT.RIGHT&&(a=this.width-this.documentWidth);this.documentX=a;this.documentY=b},__calculateDocumentDimension:function(a){var b,c=0;for(b=this.documentHeight=this.documentWidth=0;b<this.lines.length;b++)this.lines[b].y=c,this.documentWidth=Math.max(this.documentWidth,this.lines[b].width),this.documentHeight+=this.lines[b].adjustHeight(),c+=this.lines[b].getHeight();this.documentWidth=Math.max(this.documentWidth,a);return this},setLinesAlignment:function(){for(var a=0;a<this.lines.length;a++)this.lines[a].setAlignment(this.documentWidth)},paint:function(a,b){if(this.cached===CAAT.Foundation.Actor.CACHE_NONE){var c=a.ctx;c.save();c.textBaseline="alphabetic";c.translate(this.documentX,this.documentY);for(var d=0;d<this.lines.length;d++)this.lines[d].paint(a.ctx);c.restore()}else this.backgroundImage&&this.backgroundImage.paint(a,b,0,0)},__getDocumentElementAt:function(a,b){a-=this.documentX;b-=this.documentY;for(var c=0;c<this.lines.length;c++){var d=this.lines[c];if(d.x<=a&&d.y<=b&&d.x+d.width>=a&&d.y+d.height>=b)return d.__getElementAt(a-d.x,b-d.y)}return null},mouseExit:function(a){CAAT.setCursor("default")},mouseMove:function(a){(a=this.__getDocumentElementAt(a.x,a.y))&&a.getLink()?CAAT.setCursor("pointer"):CAAT.setCursor("default")},mouseClick:function(a){this.clickCallback&&(a=this.__getDocumentElementAt(a.x,a.y),a.getLink()&&this.clickCallback(a.getLink()))},setClickCallback:function(a){this.clickCallback=a;return this}}}});CAAT.Module({defines:"CAAT.Foundation.UI.PathActor",aliases:["CAAT.PathActor"],depends:["CAAT.Foundation.Actor"],extendsClass:"CAAT.Foundation.Actor",extendsWith:{path:null,pathBoundingRectangle:null,bOutline:!1,outlineColor:"black",onUpdateCallback:null,interactive:!1,getPath:function(){return this.path},setPath:function(a){this.path=a;null!=a&&(this.pathBoundingRectangle=a.getBoundingBox(),this.setInteractive(this.interactive));return this},paint:function(a,b){CAAT.Foundation.UI.PathActor.superclass.paint.call(this,a,b);if(this.path){var c=a.ctx;c.strokeStyle="#000";this.path.paint(a,this.interactive);this.bOutline&&(c.strokeStyle=this.outlineColor,c.strokeRect(this.pathBoundingRectangle.x,this.pathBoundingRectangle.y,this.pathBoundingRectangle.width,this.pathBoundingRectangle.height))}},showBoundingBox:function(a,b){(this.bOutline=a)&&b&&(this.outlineColor=b);return this},setInteractive:function(a){this.interactive=a;this.path&&this.path.setInteractive(a);return this},setOnUpdateCallback:function(a){this.onUpdateCallback=a;return this},mouseDrag:function(a){this.path.drag(a.point.x,a.point.y,this.onUpdateCallback)},mouseDown:function(a){this.path.press(a.point.x,a.point.y)},mouseUp:function(a){this.path.release()}}});CAAT.Module({defines:"CAAT.Foundation.UI.ShapeActor",aliases:["CAAT.ShapeActor"],extendsClass:"CAAT.Foundation.ActorContainer",depends:["CAAT.Foundation.ActorContainer"],constants:{SHAPE_CIRCLE:0,SHAPE_RECTANGLE:1},extendsWith:{__init:function(){this.__super();this.compositeOp="source-over";this.setShape(CAAT.Foundation.UI.ShapeActor.SHAPE_CIRCLE);return this},shape:0,compositeOp:null,lineWidth:1,lineCap:null,lineJoin:null,miterLimit:null,setLineWidth:function(a){this.lineWidth=a;return this},setLineCap:function(a){this.lineCap=a;return this},setLineJoin:function(a){this.lineJoin=a;return this},setMiterLimit:function(a){this.miterLimit=a;return this},getLineCap:function(){return this.lineCap},getLineJoin:function(){return this.lineJoin},getMiterLimit:function(){return this.miterLimit},getLineWidth:function(){return this.lineWidth},setShape:function(a){this.shape=a;this.paint=this.shape===CAAT.Foundation.UI.ShapeActor.SHAPE_CIRCLE?this.paintCircle:this.paintRectangle;return this},setCompositeOp:function(a){this.compositeOp=a;return this},paint:function(a,b){},paintCircle:function(a,b){if(this.cached)CAAT.Foundation.ActorContainer.prototype.paint.call(this,a,b);else{var c=a.ctx;c.lineWidth=this.lineWidth;c.globalCompositeOperation=this.compositeOp;null!==this.fillStyle&&(c.fillStyle=this.fillStyle,c.beginPath(),c.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2-this.lineWidth/2,0,2*Math.PI,!1),c.fill());null!==this.strokeStyle&&(c.strokeStyle=this.strokeStyle,c.beginPath(),c.arc(this.width/2,this.height/2,Math.min(this.width,this.height)/2-this.lineWidth/2,0,2*Math.PI,!1),c.stroke())}},paintRectangle:function(a,b){if(this.cached)CAAT.Foundation.ActorContainer.prototype.paint.call(this,a,b);else{var c=a.ctx;c.lineWidth=this.lineWidth;this.lineCap&&(c.lineCap=this.lineCap);this.lineJoin&&(c.lineJoin=this.lineJoin);this.miterLimit&&(c.miterLimit=this.miterLimit);c.globalCompositeOperation=this.compositeOp;null!==this.fillStyle&&(c.fillStyle=this.fillStyle,c.beginPath(),c.fillRect(0,0,this.width,this.height),c.fill());null!==this.strokeStyle&&(c.strokeStyle=this.strokeStyle,c.beginPath(),c.strokeRect(0,0,this.width,this.height),c.stroke())}}}});CAAT.Module({defines:"CAAT.Foundation.UI.StarActor",aliases:["CAAT.StarActor"],depends:["CAAT.Foundation.ActorContainer"],extendsClass:"CAAT.Foundation.ActorContainer",extendsWith:{__init:function(){this.__super();this.compositeOp="source-over";return this},nPeaks:0,maxRadius:0,minRadius:0,initialAngle:0,compositeOp:null,lineWidth:1,lineCap:null,lineJoin:null,miterLimit:null,setLineWidth:function(a){this.lineWidth=a;return this},setLineCap:function(a){this.lineCap=a;return this},setLineJoin:function(a){this.lineJoin=a;return this},setMiterLimit:function(a){this.miterLimit=a;return this},getLineCap:function(){return this.lineCap},getLineJoin:function(){return this.lineJoin},getMiterLimit:function(){return this.miterLimit},getLineWidth:function(){return this.lineWidth},setFilled:function(a){return this},setOutlined:function(a){return this},setCompositeOp:function(a){this.compositeOp=a;return this},setInitialAngle:function(a){this.initialAngle=a;return this},initialize:function(a,b,c){this.setSize(2*b,2*b);this.nPeaks=a;this.maxRadius=b;this.minRadius=c;return this},paint:function(a,b){var c=a.ctx,d=this.width/2,e=this.height/2,f=this.maxRadius,g=this.minRadius,h=d+f*Math.cos(this.initialAngle),k=e+f*Math.sin(this.initialAngle);c.lineWidth=this.lineWidth;this.lineCap&&(c.lineCap=this.lineCap);this.lineJoin&&(c.lineJoin=this.lineJoin);this.miterLimit&&(c.miterLimit=this.miterLimit);c.globalCompositeOperation=this.compositeOp;c.beginPath();c.moveTo(h,k);for(h=1;h<2*this.nPeaks;h++){var m=Math.PI/this.nPeaks*h+this.initialAngle,n=0===h%2?f:g,k=d+n*Math.cos(m),m=e+n*Math.sin(m);c.lineTo(k,m)}c.lineTo(d+f*Math.cos(this.initialAngle),e+f*Math.sin(this.initialAngle));c.closePath();this.fillStyle&&(c.fillStyle=this.fillStyle,c.fill());this.strokeStyle&&(c.strokeStyle=this.strokeStyle,c.stroke())}}});CAAT.Module({defines:"CAAT.Foundation.UI.TextActor",aliases:["CAAT.TextActor"],extendsClass:"CAAT.Foundation.Actor",constants:{TRAVERSE_PATH_FORWARD:1,TRAVERSE_PATH_BACKWARD:-1},depends:["CAAT.Foundation.Actor","CAAT.Foundation.SpriteImage","CAAT.Module.Font.Font","CAAT.Math.Point","CAAT.Behavior.Interpolator"],extendsWith:{__init:function(){this.__super();this.font="10px sans-serif";this.textAlign="left";this.outlineColor="black";this.clip=!1;this.__calcFontData();return this},font:null,fontData:null,textAlign:null,textBaseline:"top",enable_shadow:!1,shadowColor:"#787878",shadowOffsetX:1,shadowOffsetY:1,shadowBlur:5,fill:!0,textFillStyle:"#eee",text:null,textWidth:0,textHeight:0,outline:!1,outlineColor:null,lineWidth:1,path:null,pathInterpolator:null,pathDuration:1E4,sign:1,lx:0,ly:0,setFill:function(a){this.stopCacheAsBitmap();this.fill=a;return this},setLineWidth:function(a){this.stopCacheAsBitmap();this.lineWidth=a;return this},setTextFillStyle:function(a){this.stopCacheAsBitmap();this.textFillStyle=a;return this},setShadow:function(a){this.stopCacheAsBitmap();this.enable_shadow=a;return this},setShadowStyle:function(a,b,c,d){this.stopCacheAsBitmap();this.shadowColor="undefined"!==typeof a?a:this.shadowColor;this.shadowOffsetX="undefined"!==typeof b?b:this.shadowOffsetX;this.shadowOffsetY="undefined"!==typeof c?c:this.shadowOffsetY;this.shadowBlur="undefined"!==typeof d?d:this.shadowBlur;return this},setOutline:function(a){this.stopCacheAsBitmap();this.outline=a;return this},setPathTraverseDirection:function(a){this.sign=a;return this},setOutlineColor:function(a){this.stopCacheAsBitmap();this.outlineColor=a;return this},setText:function(a){this.stopCacheAsBitmap();this.text=a;if(null===this.text||""===this.text)this.width=this.height=0;this.calcTextSize(CAAT.currentDirector);this.invalidate();return this},setTextAlign:function(a){this.textAlign=a;this.__setLocation();return this},setAlign:function(a){return this.setTextAlign(a)},setTextBaseline:function(a){this.stopCacheAsBitmap();this.textBaseline=a;return this},setBaseline:function(a){this.stopCacheAsBitmap();return this.setTextBaseline(a)},setFont:function(a){this.stopCacheAsBitmap();a||(a="10px sans-serif");a instanceof CAAT.Module.Font.Font&&a.setAsSpriteImage();this.font=a;this.__calcFontData();this.calcTextSize(CAAT.director[0]);return this},setLocation:function(a,b){this.lx=a;this.ly=b;this.__setLocation();return this},setPosition:function(a,b){this.lx=a;this.ly=b;this.__setLocation();return this},setBounds:function(a,b,c,d){this.lx=a;this.ly=b;this.setSize(c,d);this.__setLocation();return this},setSize:function(a,b){CAAT.Foundation.UI.TextActor.superclass.setSize.call(this,a,b);this.__setLocation();return this},__setLocation:function(){CAAT.Foundation.UI.TextActor.superclass.setLocation.call(this,"center"===this.textAlign?this.lx-this.width/2:"right"===this.textAlign||"end"===this.textAlign?this.lx-this.width:this.lx,"bottom"===this.textBaseline?this.ly-this.height:"middle"===this.textBaseline?this.ly-this.height/2:"alphabetic"===this.textBaseline?this.ly-
this.fontData.ascent:this.ly)},centerAt:function(a,b){this.textAlign="left";this.textBaseline="top";return CAAT.Foundation.UI.TextActor.superclass.centerAt.call(this,a,b)},calcTextSize:function(a){if("undefined"===typeof this.text||null===this.text||""===this.text)return this.textHeight=this.textWidth=0,this;if(a.glEnabled)return this;if(this.font instanceof CAAT.Foundation.SpriteImage||this.font instanceof CAAT.Module.Font.Font)return this.textWidth=this.font.stringWidth(this.text),this.textHeight=this.font.stringHeight(),this.width=this.textWidth,this.height=this.textHeight,this.fontData=this.font.getFontData(),this;a=a.ctx;a.save();a.font=this.font;this.textWidth=a.measureText(this.text).width;0===this.width&&(this.width=this.textWidth);this.textHeight=this.fontData.height;this.setSize(this.textWidth,this.textHeight);a.restore();return this},__calcFontData:function(){this.fontData=CAAT.Module.Font.Font.getFontMetrics(this.font)},paint:function(a,b){if(this.text&&(CAAT.Foundation.UI.TextActor.superclass.paint.call(this,a,b),!this.cached&&null!==this.text)){0!==this.textWidth&&0!==this.textHeight||this.calcTextSize(a);var c=a.ctx;if(this.font instanceof CAAT.Module.Font.Font||this.font instanceof CAAT.Foundation.SpriteImage)this.drawSpriteText(a,b);else if(null!==this.font&&(c.font=this.font),c.textBaseline="alphabetic",null===this.path){null!==this.textAlign&&(c.textAlign=this.textAlign);var d=0;"center"===this.textAlign?d=this.width/2|0:"right"===this.textAlign&&(d=this.width);this.enable_shadow&&(c.shadowColor=this.shadowColor,c.shadowOffsetX=this.shadowOffsetX,c.shadowOffsetY=this.shadowOffsetY,c.shadowBlur=this.shadowBlur);this.fill&&(null!==this.textFillStyle&&(c.fillStyle=this.textFillStyle),c.fillText(this.text,d,this.fontData.ascent));this.outline&&(null!==this.outlineColor&&(c.strokeStyle=this.outlineColor),c.lineWidth=this.lineWidth,c.beginPath(),c.strokeText(this.text,d,this.fontData.ascent))}else this.drawOnPath(a,b)}},drawOnPath:function(a,b){var c=a.ctx;this.fill&&null!==this.textFillStyle&&(c.fillStyle=this.textFillStyle);this.outline&&null!==this.outlineColor&&(c.strokeStyle=this.outlineColor);for(var d=this.sign*this.pathInterpolator.getPosition(b%this.pathDuration/this.pathDuration).y*this.path.getLength(),e=new CAAT.Math.Point(0,0,0),f=new CAAT.Math.Point(0,0,0),g=0;g<this.text.length;g++){var h=this.text[g].toString(),k=c.measureText(h).width,f=d,e=this.path.getPositionFromLength(f).clone(),f=this.path.getPositionFromLength(f-.1).clone(),f=Math.atan2(e.y-f.y,e.x-f.x);c.save();CAAT.CLAMP?c.translate(e.x>>0,e.y>>0):c.translate(e.x,e.y);c.rotate(f);this.fill&&c.fillText(h,0,0);this.outline&&(c.beginPath(),c.lineWidth=this.lineWidth,c.strokeText(h,0,0));c.restore();d+=k}},drawSpriteText:function(a,b){null===this.path?this.font.drawText(this.text,a.ctx,0,0):this.drawSpriteTextOnPath(a,b)},drawSpriteTextOnPath:function(a,b){for(var c=a.ctx,d=this.sign*this.pathInterpolator.getPosition(b%this.pathDuration/this.pathDuration).y*this.path.getLength(),e=new CAAT.Math.Point(0,0,0),f=new CAAT.Math.Point(0,0,0),g=0;g<this.text.length;g++){var h=this.text[g].toString(),k=this.font.stringWidth(h),f=k/2+d,e=this.path.getPositionFromLength(f).clone(),f=this.path.getPositionFromLength(f-.1).clone(),f=Math.atan2(e.y-f.y,e.x-f.x);c.save();CAAT.CLAMP?c.translate(e.x|0,e.y|0):c.translate(e.x,e.y);c.rotate(f);e="bottom"===this.textBaseline?0-this.font.getHeight():0;this.font.drawText(h,c,0,e);c.restore();d+=k}},setPath:function(a,b,c){this.path=a;this.pathInterpolator=b||(new CAAT.Behavior.Interpolator).createLinearInterpolator();this.pathDuration=c||1E4;this.mouseEnabled=!1;return this}}});CAAT.ModuleManager.solveAll();
;;(function(window,document,undefined){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function k(a,b,c){k=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return k.apply(null,arguments)}var n=Date.now||function(){return+new Date};function q(a,b){this.K=a;this.w=b||a;this.G=this.w.document}q.prototype.createElement=function(a,b,c){a=this.G.createElement(a);if(b)for(var d in b)b.hasOwnProperty(d)&&("style"==d?a.style.cssText=b[d]:a.setAttribute(d,b[d]));c&&a.appendChild(this.G.createTextNode(c));return a};function r(a,b,c){a=a.G.getElementsByTagName(b)[0];a||(a=document.documentElement);a&&a.lastChild&&a.insertBefore(c,a.lastChild)}function ca(a,b){function c(){a.G.body?b():setTimeout(c,0)}c()}
function s(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function t(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}
function u(a){if("string"===typeof a.na)return a.na;var b=a.w.location.protocol;"about:"==b&&(b=a.K.location.protocol);return"https:"==b?"https:":"http:"}function v(a,b){var c=a.createElement("link",{rel:"stylesheet",href:b,media:"all"}),d=!1;c.onload=function(){d||(d=!0)};c.onerror=function(){d||(d=!0)};r(a,"head",c)}
function w(a,b,c,d){var e=a.G.getElementsByTagName("head")[0];if(e){var f=a.createElement("script",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);window.setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5E3);return f}return null};function x(a,b){this.Y=a;this.ga=b};function y(a,b,c,d){this.c=null!=a?a:null;this.g=null!=b?b:null;this.D=null!=c?c:null;this.e=null!=d?d:null}var da=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;y.prototype.compare=function(a){return this.c>a.c||this.c===a.c&&this.g>a.g||this.c===a.c&&this.g===a.g&&this.D>a.D?1:this.c<a.c||this.c===a.c&&this.g<a.g||this.c===a.c&&this.g===a.g&&this.D<a.D?-1:0};y.prototype.toString=function(){return[this.c,this.g||"",this.D||"",this.e||""].join("")};function z(a){a=da.exec(a);var b=null,c=null,d=null,e=null;a&&(null!==a[1]&&a[1]&&(b=parseInt(a[1],10)),null!==a[2]&&a[2]&&(c=parseInt(a[2],10)),null!==a[3]&&a[3]&&(d=parseInt(a[3],10)),null!==a[4]&&a[4]&&(e=/^[0-9]+$/.test(a[4])?parseInt(a[4],10):a[4]));return new y(b,c,d,e)};function A(a,b,c,d,e,f,g,h){this.N=a;this.k=h}A.prototype.getName=function(){return this.N};function B(a){this.a=a}var ea=new A("Unknown",0,0,0,0,0,0,new x(!1,!1));B.prototype.parse=function(){var a;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){a=C(this);var b=z(D(this)),c=null,d=E(this.a,/Trident\/([\d\w\.]+)/,1),c=-1!=this.a.indexOf("MSIE")?z(E(this.a,/MSIE ([\d\w\.]+)/,1)):z(E(this.a,/rv:([\d\w\.]+)/,1));""!=d&&z(d);a=new A("MSIE",0,0,0,0,0,0,new x("Windows"==a&&6<=c.c||"Windows Phone"==a&&8<=b.c,!1))}else if(-1!=this.a.indexOf("Opera"))a:if(a=z(E(this.a,/Presto\/([\d\w\.]+)/,1)),z(D(this)),null!==a.c||z(E(this.a,/rv:([^\)]+)/,1)),-1!=this.a.indexOf("Opera Mini/"))a=z(E(this.a,/Opera Mini\/([\d\.]+)/,1)),a=new A("OperaMini",0,0,0,C(this),0,0,new x(!1,!1));else{if(-1!=this.a.indexOf("Version/")&&(a=z(E(this.a,/Version\/([\d\.]+)/,1)),null!==a.c)){a=new A("Opera",0,0,0,C(this),0,0,new x(10<=a.c,!1));break a}a=z(E(this.a,/Opera[\/ ]([\d\.]+)/,1));a=null!==a.c?new A("Opera",0,0,0,C(this),0,0,new x(10<=a.c,!1)):new A("Opera",0,0,0,C(this),0,0,new x(!1,!1))}else/OPR\/[\d.]+/.test(this.a)?a=F(this):/AppleWeb(K|k)it/.test(this.a)?a=F(this):-1!=this.a.indexOf("Gecko")?(a="Unknown",b=new y,z(D(this)),b=!1,-1!=this.a.indexOf("Firefox")?(a="Firefox",b=z(E(this.a,/Firefox\/([\d\w\.]+)/,1)),b=3<=b.c&&5<=b.g):-1!=this.a.indexOf("Mozilla")&&(a="Mozilla"),c=z(E(this.a,/rv:([^\)]+)/,1)),b||(b=1<c.c||1==c.c&&9<c.g||1==c.c&&9==c.g&&2<=c.D),a=new A(a,0,0,0,C(this),0,0,new x(b,!1))):a=ea;return a};function C(a){var b=E(a.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);if(""!=b)return/BB\d{2}/.test(b)&&(b="BlackBerry"),b;a=E(a.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS|PlayStation|CrKey)/,1);return""!=a?("Mac_PowerPC"==a?a="Macintosh":"PlayStation"==a&&(a="Linux"),a):"Unknown"}
function D(a){var b=E(a.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(b||(b=E(a.a,/Windows Phone( OS)? ([^;)]+)/,2))||(b=E(a.a,/(iPhone )?OS ([\d_]+)/,2)))return b;if(b=E(a.a,/(?:Linux|CrOS|CrKey) ([^;)]+)/,1))for(var b=b.split(/\s/),c=0;c<b.length;c+=1)if(/^[\d\._]+$/.test(b[c]))return b[c];return(a=E(a.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?a:"Unknown"}
function F(a){var b=C(a),c=z(D(a)),d=z(E(a.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1)),e="Unknown",f=new y,f="Unknown",g=!1;/OPR\/[\d.]+/.test(a.a)?e="Opera":-1!=a.a.indexOf("Chrome")||-1!=a.a.indexOf("CrMo")||-1!=a.a.indexOf("CriOS")?e="Chrome":/Silk\/\d/.test(a.a)?e="Silk":"BlackBerry"==b||"Android"==b?e="BuiltinBrowser":-1!=a.a.indexOf("PhantomJS")?e="PhantomJS":-1!=a.a.indexOf("Safari")?e="Safari":-1!=a.a.indexOf("AdobeAIR")?e="AdobeAIR":-1!=a.a.indexOf("PlayStation")&&(e="BuiltinBrowser");"BuiltinBrowser"==e?f="Unknown":"Silk"==e?f=E(a.a,/Silk\/([\d\._]+)/,1):"Chrome"==e?f=E(a.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=a.a.indexOf("Version/")?f=E(a.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==e?f=E(a.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==e?f=E(a.a,/OPR\/([\d.]+)/,1):"PhantomJS"==e&&(f=E(a.a,/PhantomJS\/([\d.]+)/,1));f=z(f);g="AdobeAIR"==e?2<f.c||2==f.c&&5<=f.g:"BlackBerry"==b?10<=c.c:"Android"==b?2<c.c||2==c.c&&1<c.g:526<=d.c||525<=d.c&&13<=d.g;return new A(e,0,0,0,0,0,0,new x(g,536>d.c||536==d.c&&11>d.g))}
function E(a,b,c){return(a=a.match(b))&&a[c]?a[c]:""};function G(a){this.ma=a||"-"}G.prototype.e=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.ma)};function H(a,b){this.N=a;this.Z=4;this.O="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.O=c[1],this.Z=parseInt(c[2],10))}H.prototype.getName=function(){return this.N};function I(a){return a.O+a.Z}function ga(a){var b=4,c="n",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.d=a;this.q=a.w.document.documentElement;this.Q=b;this.j="wf";this.h=new G("-");this.ha=!1!==b.events;this.F=!1!==b.classes}function J(a){if(a.F){var b=t(a.q,a.h.e(a.j,"active")),c=[],d=[a.h.e(a.j,"loading")];b||c.push(a.h.e(a.j,"inactive"));s(a.q,c,d)}K(a,"inactive")}function K(a,b,c){if(a.ha&&a.Q[b])if(c)a.Q[b](c.getName(),I(c));else a.Q[b]()};function ia(){this.C={}};function L(a,b){this.d=a;this.I=b;this.o=this.d.createElement("span",{"aria-hidden":"true"},this.I)}
function M(a,b){var c=a.o,d;d=[];for(var e=b.N.split(/,\s*/),f=0;f<e.length;f++){var g=e[f].replace(/['"]/g,"");-1==g.indexOf(" ")?d.push(g):d.push("'"+g+"'")}d=d.join(",");e="normal";"o"===b.O?e="oblique":"i"===b.O&&(e="italic");c.style.cssText="display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+d+";"+("font-style:"+e+";font-weight:"+(b.Z+"00")+";")}
function N(a){r(a.d,"body",a.o)}L.prototype.remove=function(){var a=this.o;a.parentNode&&a.parentNode.removeChild(a)};function O(a,b,c,d,e,f,g,h){this.$=a;this.ka=b;this.d=c;this.m=d;this.k=e;this.I=h||"BESbswy";this.v={};this.X=f||3E3;this.ca=g||null;this.H=this.u=this.t=null;this.t=new L(this.d,this.I);this.u=new L(this.d,this.I);this.H=new L(this.d,this.I);M(this.t,new H("serif",I(this.m)));M(this.u,new H("sans-serif",I(this.m)));M(this.H,new H("monospace",I(this.m)));N(this.t);N(this.u);N(this.H);this.v.serif=this.t.o.offsetWidth;this.v["sans-serif"]=this.u.o.offsetWidth;this.v.monospace=this.H.o.offsetWidth}
var P={sa:"serif",ra:"sans-serif",qa:"monospace"};O.prototype.start=function(){this.oa=n();M(this.t,new H(this.m.getName()+",serif",I(this.m)));M(this.u,new H(this.m.getName()+",sans-serif",I(this.m)));Q(this)};function R(a,b,c){for(var d in P)if(P.hasOwnProperty(d)&&b===a.v[P[d]]&&c===a.v[P[d]])return!0;return!1}
function Q(a){var b=a.t.o.offsetWidth,c=a.u.o.offsetWidth;b===a.v.serif&&c===a.v["sans-serif"]||a.k.ga&&R(a,b,c)?n()-a.oa>=a.X?a.k.ga&&R(a,b,c)&&(null===a.ca||a.ca.hasOwnProperty(a.m.getName()))?S(a,a.$):S(a,a.ka):ja(a):S(a,a.$)}function ja(a){setTimeout(k(function(){Q(this)},a),50)}function S(a,b){a.t.remove();a.u.remove();a.H.remove();b(a.m)};function T(a,b,c,d){this.d=b;this.A=c;this.S=0;this.ea=this.ba=!1;this.X=d;this.k=a.k}function ka(a,b,c,d,e){c=c||{};if(0===b.length&&e)J(a.A);else for(a.S+=b.length,e&&(a.ba=e),e=0;e<b.length;e++){var f=b[e],g=c[f.getName()],h=a.A,m=f;h.F&&s(h.q,[h.h.e(h.j,m.getName(),I(m).toString(),"loading")]);K(h,"fontloading",m);h=null;h=new O(k(a.ia,a),k(a.ja,a),a.d,f,a.k,a.X,d,g);h.start()}}
T.prototype.ia=function(a){var b=this.A;b.F&&s(b.q,[b.h.e(b.j,a.getName(),I(a).toString(),"active")],[b.h.e(b.j,a.getName(),I(a).toString(),"loading"),b.h.e(b.j,a.getName(),I(a).toString(),"inactive")]);K(b,"fontactive",a);this.ea=!0;la(this)};T.prototype.ja=function(a){var b=this.A;if(b.F){var c=t(b.q,b.h.e(b.j,a.getName(),I(a).toString(),"active")),d=[],e=[b.h.e(b.j,a.getName(),I(a).toString(),"loading")];c||d.push(b.h.e(b.j,a.getName(),I(a).toString(),"inactive"));s(b.q,d,e)}K(b,"fontinactive",a);la(this)};function la(a){0==--a.S&&a.ba&&(a.ea?(a=a.A,a.F&&s(a.q,[a.h.e(a.j,"active")],[a.h.e(a.j,"loading"),a.h.e(a.j,"inactive")]),K(a,"active")):J(a.A))};function U(a){this.K=a;this.B=new ia;this.pa=new B(a.navigator.userAgent);this.a=this.pa.parse();this.U=this.V=0;this.R=this.T=!0}
U.prototype.load=function(a){this.d=new q(this.K,a.context||this.K);this.T=!1!==a.events;this.R=!1!==a.classes;var b=new ha(this.d,a),c=[],d=a.timeout;b.F&&s(b.q,[b.h.e(b.j,"loading")]);K(b,"loading");var c=this.B,e=this.d,f=[],g;for(g in a)if(a.hasOwnProperty(g)){var h=c.C[g];h&&f.push(h(a[g],e))}c=f;this.U=this.V=c.length;a=new T(this.a,this.d,b,d);d=0;for(g=c.length;d<g;d++)e=c[d],e.L(this.a,k(this.la,this,e,b,a))};U.prototype.la=function(a,b,c,d){var e=this;d?a.load(function(a,b,d){ma(e,c,a,b,d)}):(a=0==--this.V,this.U--,a&&0==this.U?J(b):(this.R||this.T)&&ka(c,[],{},null,a))};function ma(a,b,c,d,e){var f=0==--a.V;(a.R||a.T)&&setTimeout(function(){ka(b,c,d||null,e||null,f)},0)};function na(a,b,c){this.P=a?a:b+oa;this.s=[];this.W=[];this.fa=c||""}var oa="//fonts.googleapis.com/css";na.prototype.e=function(){if(0==this.s.length)throw Error("No fonts to load!");if(-1!=this.P.indexOf("kit="))return this.P;for(var a=this.s.length,b=[],c=0;c<a;c++)b.push(this.s[c].replace(/ /g,"+"));a=this.P+"?family="+b.join("%7C");0<this.W.length&&(a+="&subset="+this.W.join(","));0<this.fa.length&&(a+="&text="+encodeURIComponent(this.fa));return a};function pa(a){this.s=a;this.da=[];this.M={}}
var qa={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},ra={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},sa={i:"i",italic:"i",n:"n",normal:"n"},ta=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;pa.prototype.parse=function(){for(var a=this.s.length,b=0;b<a;b++){var c=this.s[b].split(":"),d=c[0].replace(/\+/g," "),e=["n4"];if(2<=c.length){var f;var g=c[1];f=[];if(g)for(var g=g.split(","),h=g.length,m=0;m<h;m++){var l;l=g[m];if(l.match(/^[\w-]+$/)){l=ta.exec(l.toLowerCase());var p=void 0;if(null==l)p="";else{p=void 0;p=l[1];if(null==p||""==p)p="4";else var fa=ra[p],p=fa?fa:isNaN(p)?"4":p.substr(0,1);l=l[2];p=[null==l||""==l?"n":sa[l],p].join("")}l=p}else l="";l&&f.push(l)}0<f.length&&(e=f);3==c.length&&(c=c[2],f=[],c=c?c.split(","):f,0<c.length&&(c=qa[c[0]])&&(this.M[d]=c))}this.M[d]||(c=qa[d])&&(this.M[d]=c);for(c=0;c<e.length;c+=1)this.da.push(new H(d,e[c]))}};function V(a,b){this.a=(new B(navigator.userAgent)).parse();this.d=a;this.f=b}var ua={Arimo:!0,Cousine:!0,Tinos:!0};V.prototype.L=function(a,b){b(a.k.Y)};V.prototype.load=function(a){var b=this.d;"MSIE"==this.a.getName()&&1!=this.f.blocking?ca(b,k(this.aa,this,a)):this.aa(a)};V.prototype.aa=function(a){for(var b=this.d,c=new na(this.f.api,u(b),this.f.text),d=this.f.families,e=d.length,f=0;f<e;f++){var g=d[f].split(":");3==g.length&&c.W.push(g.pop());var h="";2==g.length&&""!=g[1]&&(h=":");c.s.push(g.join(h))}d=new pa(d);d.parse();v(b,c.e());a(d.da,d.M,ua)};function W(a,b){this.d=a;this.f=b;this.p=[]}W.prototype.J=function(a){var b=this.d;return u(this.d)+(this.f.api||"//f.fontdeck.com/s/css/js/")+(b.w.location.hostname||b.K.location.hostname)+"/"+a+".js"};W.prototype.L=function(a,b){var c=this.f.id,d=this.d.w,e=this;c?(d.__webfontfontdeckmodule__||(d.__webfontfontdeckmodule__={}),d.__webfontfontdeckmodule__[c]=function(a,c){for(var d=0,m=c.fonts.length;d<m;++d){var l=c.fonts[d];e.p.push(new H(l.name,ga("font-weight:"+l.weight+";font-style:"+l.style)))}b(a)},w(this.d,this.J(c),function(a){a&&b(!1)})):b(!1)};W.prototype.load=function(a){a(this.p)};function X(a,b){this.d=a;this.f=b;this.p=[]}X.prototype.J=function(a){var b=u(this.d);return(this.f.api||b+"//use.typekit.net")+"/"+a+".js"};X.prototype.L=function(a,b){var c=this.f.id,d=this.d.w,e=this;c?w(this.d,this.J(c),function(a){if(a)b(!1);else{if(d.Typekit&&d.Typekit.config&&d.Typekit.config.fn){a=d.Typekit.config.fn;for(var c=0;c<a.length;c+=2)for(var h=a[c],m=a[c+1],l=0;l<m.length;l++)e.p.push(new H(h,m[l]));try{d.Typekit.load({events:!1,classes:!1})}catch(p){}}b(!0)}},2E3):b(!1)};X.prototype.load=function(a){a(this.p)};function Y(a,b){this.d=a;this.f=b;this.p=[]}Y.prototype.L=function(a,b){var c=this,d=c.f.projectId,e=c.f.version;if(d){var f=c.d.w;w(this.d,c.J(d,e),function(e){if(e)b(!1);else{if(f["__mti_fntLst"+d]&&(e=f["__mti_fntLst"+d]()))for(var h=0;h<e.length;h++)c.p.push(new H(e[h].fontfamily));b(a.k.Y)}}).id="__MonotypeAPIScript__"+d}else b(!1)};Y.prototype.J=function(a,b){var c=u(this.d),d=(this.f.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return c+"//"+d+"/"+a+".js"+(b?"?v="+b:"")};Y.prototype.load=function(a){a(this.p)};function Z(a,b){this.d=a;this.f=b}Z.prototype.load=function(a){var b,c,d=this.f.urls||[],e=this.f.families||[],f=this.f.testStrings||{};b=0;for(c=d.length;b<c;b++)v(this.d,d[b]);d=[];b=0;for(c=e.length;b<c;b++){var g=e[b].split(":");if(g[1])for(var h=g[1].split(","),m=0;m<h.length;m+=1)d.push(new H(g[0],h[m]));else d.push(new H(g[0]))}a(d,f)};Z.prototype.L=function(a,b){return b(a.k.Y)};var $=new U(this);$.B.C.custom=function(a,b){return new Z(b,a)};$.B.C.fontdeck=function(a,b){return new W(b,a)};$.B.C.monotype=function(a,b){return new Y(b,a)};$.B.C.typekit=function(a,b){return new X(b,a)};$.B.C.google=function(a,b){return new V(b,a)};this.WebFont||(this.WebFont={},this.WebFont.load=k($.load,$),this.WebFontConfig&&$.load(this.WebFontConfig));})(this,document);
;(function(){jQuery.curvySlider=function(ia,ja,ka,la,ma,W){function na(){2<h.length&&h.splice(2,1);for(var d=a=0;d<h.scenes.length;d++){if(""!=h.scenes[d].sceneDetails.fallbackURL){b[a]={};b[a].sceneID="curvy-fallback-"+a;b[a].sceneDetails={};b[a].sceneDetails.sceneTime=h.scenes[d].sceneDetails.sceneTime;b[a].sceneDetails.sceneDelay=h.scenes[d].sceneDetails.sceneDelay;var e='<img src="'+h.scenes[d].sceneDetails.fallbackURL+'" />';b[a].imageString=0===a?'<div class="'+b[a].sceneID+'">'+e+"</div>":'<div class="'+b[a].sceneID+' hide">'+e+"</div>";jQuery(m+" .curvy-slider-fallback-canvas").append(b[a].imageString);X(a);a++;}}
a=b.length-1;}
function X(d){d='<div class="curvy-nav-elem '+(0===d?"active":"")+'" data-ref="nav-elem-'+d+'"></div>';jQuery(m+" .curvy-slider-nav-container .curvy-slider-nav").append(d);}
function M(d){d>=b.length||(jQuery(m+" .curvy-fallback-"+a).animate({opacity:"0"},Number(b[a].sceneDetails.sceneTime),function(){jQuery(this).addClass("hide");}),jQuery(m+" .curvy-fallback-"+d).css("opacity","0").removeClass("hide"),jQuery(m+" .curvy-fallback-"+d).animate({opacity:"1"},1E3*Number(b[d].sceneDetails.sceneTime),function(){a=d;}));}
function oa(){var d=jQuery("#"+t).parents(".rockthemes-curvy-slider"),a=parseInt(d.width()*h.slider_height/h.slider_width);d.parents(".rockthemes-unique-grid").length&&"true"===d.parents(".rockthemes-unique-grid").attr("data-rsb-fullscreen")&&(a=d.parents(".rockthemes-unique-grid").height());d.css({height:a+"px",position:"relative"});}
function G(){return navigator.userAgent.match(/msie [7]/i)||navigator.userAgent.match(/msie [8]/i)?!0:!1;}
function pa(){b=[];var d=h.fonts?h.fonts:[];if(0<d.length){for(var a=0;a<d.length;a++){N.push(d[a]);}
WebFont.load({google:{families:N},fontactive:function(d,a){Y++;Y>=N.length&&!O&&(O=!0,Z());}});}else{O=!0,Z();}}
function Z(){for(var d=[],a=0;a<h.scenes.length;a++){if(P&&-1<h.scenes[a].bg.bgType.indexOf("video")&&""!==h.scenes[a].sceneDetails.fallbackURL&&h.scenes[a].imageArray.push({id:"scene_fallback_"+a,url:h.scenes[a].sceneDetails.fallbackURL}),-1<h.scenes[a].bg.bgType.indexOf("image")&&""!==h.scenes[a].bg.bgURL&&h.scenes[a].imageArray.push({id:"scene_bg_"+a,url:h.scenes[a].bg.bgURL}),"undefined"!=typeof h.scenes[a].imageArray){for(var b=0;b<h.scenes[a].imageArray.length;b++){d.push({id:h.scenes[a].imageArray[b].id,url:h.scenes[a].imageArray[b].url});}}}
if(0<d.length){a=new CAAT.Module.Preloader.Preloader;for(b=0;b<d.length;b++){a.addElement(d[b].id,d[b].url);}
a.load(function(a){aa(a);});}else{aa();}}
function H(d){d>=b.length||(q.easeInOut(d,b[d].sceneDetails.incomingMotion,b[d].sceneDetails.incomingAnchor,a,b[a].sceneDetails.incomingMotion,b[a].sceneDetails.incomingAnchor,1E3*b[a].sceneDetails.sceneTime,1,r(b[d].sceneDetails.incomingEasing),r(b[a].sceneDetails.incomingEasing)),a=d,"activate_nav"===y&&(jQuery("#scenes-navigation ul li.scene-nav-elem.active").removeClass("active"),jQuery("#scene-nav-"+d).addClass("active")));}
function D(d,e,f){d=(d="undefined"===typeof d||null==d?null:d)?(new CAAT.PathUtil.Path).beginPath(parseInt(d[0].x)-240,parseInt(d[0].y)-150).addQuadricTo(parseInt(d[1].x)-240,parseInt(d[1].y)-150,parseInt(d[2].x)-240,parseInt(d[2].y)-150).endPath():(new CAAT.PathUtil.Path).beginPath(1150,219).addQuadricTo(1130,350,780,280).endPath();b[a].path.addSegment(d);b[a].pa.setPath(b[a].path);return d;}
function aa(d){CAAT.RETINA_DISPLAY_ENABLED=!0;CAAT.IOS_RETINA_LIMIT=5242880;jQuery("#"+t).parents(".rockthemes-curvy-slider").find(".loader-container").length&&jQuery("#"+t).parents(".rockthemes-curvy-slider").find(".loader-container").remove();jQuery("#"+t).parents(".rockthemes-curvy-slider").css({height:"",position:""});jQuery("#"+t).parents(".rockthemes-curvy-slider").addClass("curvy-loaded");q=(new CAAT.Foundation.Director).initialize(w,x,t);Q?q.enableResizeEvents(CAAT.Foundation.Director.RESIZE_HEIGHT):q.enableResizeEvents(CAAT.Foundation.Director.RESIZE_PROPORTIONAL);q.setImagesCache(d);if(Q){var e;jQuery(window).resize(function(){"undefined"!=typeof e&&clearTimeout(e);e=setTimeout(function(){jQuery(document).trigger("rockthemes:sticky_menu_resize");"true"!==z||u?B():(R(),I());},800);});}
ba=(new CAAT.PathUtil.Path).endPath();(new CAAT.Foundation.UI.PathActor).enableEvents(!0).setBounds(0,0,q.width,q.height).setInteractive(!0).setPath(ba).showBoundingBox(!1);qa();0<b.length||(a=b.length,b[a]={},b[a].theScene=q.createScene(),b[a].theSceneID="scene-"+a,b[a].path=(new CAAT.PathUtil.Path).endPath(),b[a].pa=(new CAAT.Foundation.UI.PathActor).setBounds(0,0,q.width,q.height).setInteractive(!0).setPath(b[a].path).showBoundingBox(!1),b[a].bg={},b[a].bg.bgActor=ca("",b[a].theSceneID),b[a].theScene.addChildAt(b[a].bg.bgActor,0),b[a].imageArray=[],b[a].sceneDetails={},b[a].sceneDetails.sceneTime=.65,b[a].sceneDetails.sceneDelay=6,b[a].sceneDetails.incomingMotion=0,b[a].sceneDetails.incomingAnchor=0,b[a].sceneDetails.incomingEasing="easeOut",b[a].theSceneID.split("-"),b[a].actorElems=[]);CAAT.loop(60);"true"==z?(H(0),"activate_nav"===y?(jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-0"]').addClass("active"),jQuery(m+" #playAllScenesBtn").trigger("click")):I()):(H(0),"activate_nav"===y&&jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-0"]').addClass("active"));var f=0,c=0;jQuery("#"+t).on("touchstart",function(a){f=a.originalEvent.touches[0].pageX;}).on("touchmove",function(a){c=f-a.originalEvent.touches[0].pageX;}).on("touchend",function(a){15>Math.abs(c)||(0>c?da():ea());});jQuery(m).animate({opacity:1},180);jQuery(document).trigger("rockthemes:sticky_menu_resize");jQuery(document).trigger("rockthemes:intro_effect_canvas_resize");jQuery(document).trigger("curvyslider:reset_side_nav");jQuery(document).trigger("curvyslider:curvy_ready");}
function ca(a,b,f){jQuery(m).append('<div style="display:none;"><video id="'+S+"_"+f+'" class="curvybgvideo_'+f+'" loop="true"><source src="'+a+'" type="video/mp4" /></video></div>');var c=document.getElementById(S+"_"+f);a=document.createElement("canvas");a.width=w;a.height=x;var h=a.getContext("2d");a=(new CAAT.Foundation.SpriteImage).initialize(a,1,1);b.createTimer(0,33,function(a,d,b){b.reset(a);h.drawImage(c,0,0,w,x);});b=(new CAAT.Foundation.ActorContainer).setBounds(0,0,q.width,q.height);a=(new CAAT.Foundation.Actor).setBackgroundImage(a.getRef(),!0);b.addChild(a);return b;}
function qa(){2<h.length&&h.splice(2,1);for(var d=a=0;d<h.scenes.length;d++){var e=h.scenes[d];b[a]={};b[a].theScene=q.createScene();b[a].path=(new CAAT.PathUtil.Path).endPath();b[a].pa=(new CAAT.Foundation.UI.PathActor).setBounds(0,0,q.width,q.height).setInteractive(!0).setPath(b[a].path).showBoundingBox(!1);b[a].imageArray="undefined"!=typeof h.scenes[d].imageArray?h.scenes[d].imageArray:[];b[a].bg={};b[a].bg.bgType=h.scenes[d].bg.bgType;b[a].bg.bgURL=h.scenes[d].bg.bgURL;b[a].bg.bgColor=h.scenes[d].bg.bgColor;b[a].bg.bgVideoURL=h.scenes[d].bg.bgVideoURL;b[a].bg.bgColorAlpha=h.scenes[d].bg.bgColorAlpha;b[a].bg.fallbackURL=h.scenes[d].sceneDetails.fallbackURL;b[a].sceneDetails={};b[a].sceneDetails.sceneTime=h.scenes[d].sceneDetails.sceneTime;b[a].sceneDetails.sceneDelay=h.scenes[d].sceneDetails.sceneDelay;b[a].sceneDetails.incomingMotion=h.scenes[d].sceneDetails.incomingMotion;b[a].sceneDetails.incomingAnchor=h.scenes[d].sceneDetails.incomingAnchor;b[a].sceneDetails.incomingEasing=h.scenes[d].sceneDetails.incomingEasing;b[a].theSceneID="scene-"+a;b[a].theSceneID.split("-");P&&-1<b[a].bg.bgType.indexOf("video")&&(b[a].bg.bgURL=b[a].bg.fallbackURL);if("transparent"==b[a].bg.bgType){b[a].bg.bgActor=(new CAAT.Foundation.UI.ShapeActor).setShape(CAAT.Foundation.UI.ShapeActor.SHAPE_RECTANGLE).centerAt(0,0).setSize(w,x),b[a].theScene.addChildAt(b[a].bg.bgActor,0);}else{if("image"==b[a].bg.bgType||P&&""!==b[a].bg.bgURL){var f=w/2,c=x/2;b[a].bg.bgActor=(new CAAT.Foundation.ActorContainer).setBounds(0,0,q.width,q.height).setSize(w,x).centerAt(f,c);b[a].theScene.addChildAt(b[a].bg.bgActor,0);ra(b[a].bg.bgActor,b[a].theSceneID,b[a].bg.bgURL);}else{"color"==b[a].bg.bgType?(b[a].bg.bgActor=(new CAAT.Foundation.UI.ShapeActor).setShape(CAAT.Foundation.UI.ShapeActor.SHAPE_RECTANGLE).centerAt(0,0).setSize(w,x),b[a].theScene.addChildAt(b[a].bg.bgActor,0),b[a].bg.bgActor.setFillStyle(b[a].bg.bgColor)):-1<b[a].bg.bgType.indexOf("video")&&(b[a].bg.bgActor=ca(b[a].bg.bgVideoURL,b[a].theScene,b[a].theSceneID),-1<b[a].bg.bgType.indexOf("color")&&(f=(new CAAT.Foundation.UI.ShapeActor).setShape(CAAT.Foundation.UI.ShapeActor.SHAPE_RECTANGLE).centerAt(0,0).setSize(w,x).setAlpha(b[a].bg.bgColorAlpha),b[a].bg.bgActor.addChild(f),f.setFillStyle(b[a].bg.bgColor)),b[a].theScene.addChildAt(b[a].bg.bgActor,0));}}
b[a].actorElems=[];for(f=0;f<e.actorElems.length;f++){switch(e.actorElems[f].objType){case"singleText":fa("scene-0",e.actorElems[f]);break;case"singleBoxedText":var c=e.actorElems[f],m=(c="undefined"===typeof c||null==c?null:c)?c.elemID:T(),g="Baumans";c&&c.objFont&&(g=c.objFont,g.indexOf(":")&&(g=g.split(":"),g=g[0]));g=(new CAAT.Foundation.UI.TextActor).setFont(c?c.fontStyle+" "+c.objFontSize+" "+g:"40px Baumans").setText(c?c.objText:jQuery("#"+m+" .text-holder").val()).setShadow(c&&c.enable_shadow?c.enable_shadow:!1).setTextFillStyle(c?c.objColor:"#f0f0f0").emptyBehaviorList();g.centerAt((g.textWidth+parseInt(c?c.paddingH:40))/2,(g.textHeight+parseInt(c?c.paddingV:30))/2);var k=(new CAAT.Foundation.ActorContainer).setLocation(c?c.coordsArray[0].x-240:1800,c?c.coordsArray[0].y-150:400).setAlpha(c?c.startAlpha:1).enableEvents(!0).emptyBehaviorList();k.addChild(g);var n,l=g.textWidth+parseInt(c?c.paddingH:40);n=g.textHeight+parseInt(c?c.paddingV:30);var p=parseInt(c?c.bgRadius:10),t=c?c.objBGColor:"#333333",u=document.createElement("canvas"),p="undefined"==typeof p?p=20:p,v=u.getContext("2d");u.width=l;u.height=n;v.fillStyle=t;v.clearRect(0,0,l,n);v.beginPath();v.moveTo(p,0);v.lineTo(l-p,0);v.quadraticCurveTo(l,0,l,p);v.lineTo(l,n-p);v.quadraticCurveTo(l,n,l-p,n);v.lineTo(p,n);v.quadraticCurveTo(0,n,0,n-p);v.lineTo(0,p);v.quadraticCurveTo(0,0,p,0);v.closePath();v.fill();n=u;k.setBackgroundImage(n);p=void 0;p=c?D(c.coordsArray,k,c.elemID):D(null,k,m);c&&1==c.hideBeginning&&k.setAlpha(0);"true"!=z&&k.setGlobalAlpha(!0).addBehavior((new CAAT.Behavior.PathBehavior).setPath(p).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3).setCycle(!1).setAutoRotate(c&&c.autoRotate?!0:!1,c&&c.autoRotate?CAAT.PathBehavior.autorotate.FREE:!1).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4))).addBehavior((new CAAT.Behavior.AlphaBehavior).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(c?c.startAlpha:1,c?c.endAlpha:1).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3)).addBehavior((new CAAT.Behavior.ScaleBehavior).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(c?c.scaleStart:1,c?c.scaleEnd:1,c?c.scaleStart:1,c?c.scaleEnd:1).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3));l=c?c:{};c||(l.coordsArray=[],l.delayTime=650,l.motionTime=650,l.outOfSceneTime=650,l.waitOnSceneTime=3,l.outOfSceneMotion="noMotion",l.objType="singleBoxedText",l.objText="New Text",l.fontStyle="",l.objSrc="",l.linkActive=!1,l.objLink="",l.objBorderColor="",l.objColor="#3e3e3e",l.objFontSize="40px",l.objFont="sans",l.elemID=m,l.autoRotate=!1,l.hideBeginning=!1,l.easingName="",l.startAlpha=1,l.endAlpha=1,l.scaleStart=1,l.scaleEnd=1);l.actor_bg_shape=n;l.pathRemoved=!1;l.path=p;n=l.path.numControlPoints();if(0>=l.coordsArray.length){for(p=0;p<n;p++){l.coordsArray.push(l.path.getControlPoint(p));}}
l.Actor=k;l.textActor=g;l.easing=c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4);b[a].actorElems||(b[a].actorElems=[]);b[a].actorElems.push(l);c&&c.linkActive&&U(k,c.objLink,c);b[a].theScene.addChildAt(k,b[a].theScene.childrenList.length);c&&"noMotion"!=c.outOfSceneMotion&&"true"!=z&&J(l,l.outOfSceneMotion);V(m);break;case"image":c=e.actorElems[f];m=(c="undefined"===typeof c||null==c?null:c)?c.elemID:T();c&&c.objSrc.substr(c.objSrc.lastIndexOf("/")+1);g=(new CAAT.Foundation.Actor).setLocation(c?c.coordsArray[0].x-240:1800,c?c.coordsArray[0].y-150:400).enableEvents(!0).setPositionAnchor(.5,.5).emptyBehaviorList();c&&g.setBackgroundImage(q.getImage(c.elemID));l=void 0;l=c?D(c.coordsArray,g,c.elemID):D(null,g,m);c&&1==c.hideBeginning&&g.setAlpha(0);k=!1;if(c&&1==c.autoRotate&&(jQuery("#"+m+" label.autoRotate input").attr("checked","checked"),c.auto_rotation_mode)){switch(c.auto_rotation_mode){case"LEFT_TO_RIGHT":k=CAAT.PathBehavior.autorotate.LEFT_TO_RIGHT;break;case"RIGHT_TO_LEFT":k=CAAT.PathBehavior.autorotate.RIGHT_TO_LEFT;break;case"FREE":k=CAAT.PathBehavior.autorotate.FREE;break;default:k=CAAT.PathBehavior.autorotate.FREE;}}"true"!=z&&g.addBehavior((new CAAT.Behavior.PathBehavior).setValues(l).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3).setCycle(!1).setAutoRotate(c&&c.autoRotate?!0:!1,c&&c.autoRotate?k:!1).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4))).addBehavior((new CAAT.Behavior.AlphaBehavior).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(c?c.startAlpha:1,c?c.endAlpha:1).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3)).addBehavior((new CAAT.Behavior.ScaleBehavior).setInterpolator(c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(c?c.scaleStart:1,c?c.scaleEnd:1,c?c.scaleStart:1,c?c.scaleEnd:1).setDelayTime(c?parseInt(c.delayTime):1800,c?parseInt(c.motionTime):1E3));k=c?c:{};c||(k.coordsArray=[],k.delayTime=650,k.motionTime=650,k.outOfSceneTime=650,k.waitOnSceneTime=3,k.outOfSceneMotion="noMotion",k.objType="image",k.objText="New Text",k.fontStyle="",k.objSrc="",k.linkActive=!1,k.objLink="",k.objBorderColor="",k.objColor="#3e3e3e",k.objFontSize="40px",k.objFont="sans",k.elemID=m,k.autoRotate=!1,k.hideBeginning=!1,k.easingName="",k.startAlpha=1,k.endAlpha=1,k.scaleStart=1,k.scaleEnd=1);k.pathRemoved=!1;k.path=l;l=k.path.numControlPoints();for(n=0;n<l;n++){}
if(0>=k.coordsArray.length){for(n=0;n<l;n++){k.coordsArray.push(k.path.getControlPoint(n));}}
for(n=0;n<l;n++){}
k.Actor=g;k.easing=c?r(c.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4);b[a].actorElems||(b[a].actorElems=[]);b[a].actorElems.push(k);c&&c.linkActive&&U(g,c.objLink);b[a].theScene.addChildAt(g,b[a].theScene.childrenList.length);c&&"noMotion"!=c.outOfSceneMotion&&J(k,k.outOfSceneMotion);for(n=0;n<l;n++){}
V(m);break;case"button":addButton("scene-0");break;default:fa("scene-0");}}"nav_regular"===y&&X(a);a++;}
a=b.length-1;}
function fa(d,e){var f=(e="undefined"===typeof e||null==e?null:e)?e.elemID:T(),c="Baumans";e&&e.objFont&&(c=e.objFont,c.indexOf(":")&&(c=c.split(":"),c=c[0]));var c=(new CAAT.Foundation.UI.TextActor).setFont(e?e.fontStyle+" "+e.objFontSize+" "+c:"40px Baumans").setText(e?e.objText:jQuery("#"+f+" .text-holder").val()).setLocation(e?e.coordsArray[0].x-240:1800,e?e.coordsArray[0].y-150:400).setAlpha(e?e.startAlpha:1).setTextFillStyle(e?e.objColor:"#3e3e3e").setShadow(e&&e.enable_shadow?e.enable_shadow:!1).enableEvents(!0).emptyBehaviorList(),h;h=e?D(e.coordsArray,c,e.elemID):D(null,c,f);e&&1==e.hideBeginning&&c.setAlpha(0);"true"!=z&&c.addBehavior((new CAAT.Behavior.PathBehavior).setPath(h).setDelayTime(e?parseInt(e.delayTime):1800,e?parseInt(e.motionTime):1E3).setCycle(!1).setAutoRotate(e&&e.autoRotate?!0:!1,e&&e.autoRotate?CAAT.PathBehavior.autorotate.FREE:!1).setInterpolator(e?r(e.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4))).addBehavior((new CAAT.Behavior.AlphaBehavior).setInterpolator(e?r(e.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(e?e.startAlpha:1,e?e.endAlpha:1).setDelayTime(e?parseInt(e.delayTime):1800,e?parseInt(e.motionTime):1E3)).addBehavior((new CAAT.Behavior.ScaleBehavior).setInterpolator(e?r(e.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4)).setValues(e?e.scaleStart:1,e?e.scaleEnd:1,e?e.scaleStart:1,e?e.scaleEnd:1).setDelayTime(e?parseInt(e.delayTime):1800,e?parseInt(e.motionTime):1E3));var g=e?e:{};e||(g.coordsArray=[],g.delayTime=650,g.motionTime=650,g.outOfSceneTime=650,g.waitOnSceneTime=3,g.outOfSceneMotion="noMotion",g.objType="singleText",g.objText="New Text",g.fontStyle="",g.objSrc="",g.linkActive=!1,g.objLink="",g.objBorderColor="",g.objColor="#3e3e3e",g.objFontSize="40px",g.objFont="sans",g.elemID=f,g.autoRotate=!1,g.hideBeginning=!1,g.easingName="",g.startAlpha=1,g.endAlpha=1,g.scaleStart=1,g.scaleEnd=1);g.pathRemoved=!1;g.path=h;h=g.path.numControlPoints();if(0>=g.coordsArray.length){for(var k=0;k<h;k++){g.coordsArray.push(g.path.getControlPoint(k));}}
g.Actor=c;g.easing=e?r(e.easingName):(new CAAT.Interpolator).createExponentialOutInterpolator(4);b[a].actorElems||(b[a].actorElems=[]);b[a].actorElems.push(g);e&&e.linkActive&&U(c,e.objLink);b[a].theScene.addChildAt(c,b[a].theScene.childrenList.length);e&&"noMotion"!=e.outOfSceneMotion&&J(g,g.outOfSceneMotion);V(f);}
function ra(d,e,f,c){var h={};h.url=f;h.id=e;"undefined"!=typeof b[a]&&b[a].imageArray.push(h);(new CAAT.Module.Preloader.Preloader).addElement(e,f).load(function(a){d.setBackgroundImage(a[a.length-1].image);"undefined"!=typeof callback&&c();});}
function U(a,b,f){"undefined"==typeof f?(a.mouseClick=function(a){1===f.Actor.frameAlpha&&(window.location.href=b);},a.touchEnd=function(a){1===f.Actor.frameAlpha&&(window.location.href=b);},a.mouseEnter=function(a){1===f.Actor.frameAlpha&&(document.getElementById(t).style.cursor="pointer");},a.mouseExit=function(a){1===f.Actor.frameAlpha&&(document.getElementById(t).style.cursor="default");}):"singleBoxedText"!=f.objType||f.buttonCover||(f.buttonCover=(new CAAT.Foundation.UI.ShapeActor).setShape(CAAT.Foundation.UI.ShapeActor.SHAPE_RECTANGLE).setBounds(0,0,a.width,a.height).setFillStyle("blue").setAlpha(0),f.buttonCover.mouseClick=function(a){1===f.Actor.frameAlpha&&(window.location.href=b);},f.buttonCover.touchEnd=function(a){1===f.Actor.frameAlpha&&(window.location.href=b);},f.buttonCover.mouseEnter=function(a){1===f.Actor.frameAlpha&&(document.getElementById(t).style.cursor="pointer",f.objBGHoverColor&&(a=f.actor_bg_shape.getContext("2d"),a.fillStyle=f.objBGHoverColor,a.fill()));},f.buttonCover.mouseExit=function(a){1===f.Actor.frameAlpha&&(document.getElementById(t).style.cursor="default",f.objBGHoverColor&&(a=f.actor_bg_shape.getContext("2d"),a.fillStyle=f.objBGColor,a.fill()));},a.addChild(f.buttonCover),f.actor_bg_shape.fillStyle="red");}
function sa(){for(var d=0;d<E.length;d++){E[d].pause();}
for(d=0;d<b[a].actorElems.length;d++){b[a].actorElems[d].Actor.setLocation(b[a].actorElems[d].coordsArray[0].x-240,b[a].actorElems[d].coordsArray[0].y-150).setAlpha(1==b[a].actorElems[d].hideBeginning?0:b[a].actorElems[d].startAlpha);}}
function I(){F||(F=!0,u=!1,K());}
function R(){u=!0;for(var a=0;a<E.length;a++){E[a].pause();}"undefined"!=typeof A&&clearInterval(A);F=!1;}
function K(){A=setTimeout(ga,1E3*b[a].sceneDetails.sceneDelay);ha=(new Date).getTime();G()||B();}
function ga(){var d=a;d++;d>=b.length&&(d=0);G()?M(d):H(d);a=d;jQuery(m+" .curvy-nav-elem.active").removeClass("active");jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-'+a+'"]').addClass("active");u||K();}
function B(){sa();-1<b[a].bg.bgType.indexOf("video")&&jQuery(".curvybgvideo_scene-"+a).length&&jQuery(".curvybgvideo_scene-"+a)[0]&&(jQuery(".curvybgvideo_scene-"+a).attr("data-video-ready-to-start")&&"true"===jQuery(".curvybgvideo_scene-"+a).attr("data-video-ready-to-start")?(jQuery(".curvybgvideo_scene-"+a)[0].currentTime=0,jQuery(".curvybgvideo_scene-"+a)[0].play(),E.push(jQuery(".curvybgvideo_scene-"+a)[0])):jQuery(".curvybgvideo_scene-"+a)[0].oncanplay=function(){jQuery(".curvybgvideo_scene-"+a)[0].currentTime=0;jQuery(".curvybgvideo_scene-"+a)[0].play();E.push(jQuery(".curvybgvideo_scene-"+a)[0]);jQuery(".curvybgvideo_scene-"+a)[0].oncanplay=!1;jQuery(".curvybgvideo_scene-"+a).attr("data-video-ready-to-start","true");});for(var d=0;d<b[a].actorElems.length;d++){var e=!1;if(b[a].actorElems[d]&&1==b[a].actorElems[d].autoRotate&&b[a].actorElems[d].auto_rotation_mode){switch(b[a].actorElems[d].auto_rotation_mode){case"LEFT_TO_RIGHT":e=CAAT.PathBehavior.autorotate.LEFT_TO_RIGHT;break;case"RIGHT_TO_LEFT":e=CAAT.PathBehavior.autorotate.RIGHT_TO_LEFT;break;case"FREE":e=CAAT.PathBehavior.autorotate.FREE;break;default:e=CAAT.PathBehavior.autorotate.FREE;}}
b[a].actorElems[d].Actor.emptyBehaviorList().setRotation(0).setGlobalAlpha(!0).setScale(b[a].actorElems[d].scaleStart,b[a].actorElems[d].scaleStart).addBehavior((new CAAT.Behavior.PathBehavior).setValues(b[a].actorElems[d].path).setDelayTime(b[a].actorElems[d].delayTime,b[a].actorElems[d].motionTime).setCycle(!1).setAutoRotate(b[a].actorElems[d].autoRotate?!0:!1,b[a].actorElems[d].autoRotate?e:!1).setInterpolator(b[a].actorElems[d].easing)).addBehavior((new CAAT.Behavior.AlphaBehavior).setValues(b[a].actorElems[d].startAlpha,b[a].actorElems[d].endAlpha).setDelayTime(b[a].actorElems[d].delayTime,b[a].actorElems[d].motionTime).setInterpolator(b[a].actorElems[d].easing)).addBehavior((new CAAT.Behavior.ScaleBehavior).setValues(b[a].actorElems[d].scaleStart,b[a].actorElems[d].scaleEnd,b[a].actorElems[d].scaleStart,b[a].actorElems[d].scaleEnd).setDelayTime(b[a].actorElems[d].delayTime,b[a].actorElems[d].motionTime).setInterpolator(b[a].actorElems[d].easing));"noMotion"!=b[a].actorElems[d].outOfSceneMotion&&J(b[a].actorElems[d],b[a].actorElems[d].outOfSceneMotion);}}
function r(a){switch(a){case"Linear":return(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1,!1);case"LinearBounce":return(new CAAT.Behavior.Interpolator).createLinearInterpolator(!0,!1);case"ExpoIn":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(2,!1);case"ExpoOut":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(2,!1);case"ExpoInOut":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(2,!1);case"ExpoInBounce":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(2,!0);case"ExpoOutBounce":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(2,!0);case"ExpoInOutBounce":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(2,!0);case"ExpoIn4":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(4,!1);case"ExpoOut4":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(4,!1);case"ExpoInOut4":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4,!1);case"ExpoIn4Bounce":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(4,!0);case"ExpoOut4Bounce":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(4,!0);case"ExpoInOut4Bounce":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(4,!0);case"ExpoIn6":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(6,!1);case"ExpoOut6":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(6,!1);case"ExpoInOut6":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(6,!1);case"ExpoIn6Bounce":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(6,!0);case"ExpoOut6Bounce":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(6,!0);case"ExpoInOut6Bounce":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(6,!0);case"BounceIn":return(new CAAT.Behavior.Interpolator).createBounceInInterpolator(!1);case"BounceOut":return(new CAAT.Behavior.Interpolator).createBounceOutInterpolator(!1);case"BounceInOut":return(new CAAT.Behavior.Interpolator).createBounceInOutInterpolator(!1);case"BounceInBounce":return(new CAAT.Behavior.Interpolator).createBounceInInterpolator(!0);case"BounceOutBounce":return(new CAAT.Behavior.Interpolator).createBounceOutInterpolator(!0);case"BounceInOutBounce":return(new CAAT.Behavior.Interpolator).createBounceInOutInterpolator(!0);case"easeIn":return(new CAAT.Behavior.Interpolator).createExponentialInInterpolator(6,!1);case"easeOut":return(new CAAT.Behavior.Interpolator).createExponentialOutInterpolator(6,!1);case"easeInOut":return(new CAAT.Behavior.Interpolator).createExponentialInOutInterpolator(6,!1);case"bounce":return(new CAAT.Behavior.Interpolator).createBounceOutInterpolator(!1);case"elastic":return(new CAAT.Behavior.Interpolator).createElasticOutInterpolator(1,.2,!1);case"linear":return(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1,!1);default:return(new CAAT.Behavior.Interpolator).createLinearInterpolator(!1,!1);}}
function T(){if(0<jQuery("#elem-"+C).length){for(;0<jQuery("#elem-"+C).length;){if(C++,0>=jQuery("#elem-"+C).length){return"elem-"+C;}}}else{return C++,"elem-"+(C-1);}}
function V(d){for(var e=0;e<b[a].actorElems.length;e++){if(b[a].actorElems[e].elemID==d){return e;}}}
function ea(){var d=parseInt(a)+1;d>=b.length&&(d=0);q.easeInOut(d,b[d].sceneDetails.incomingMotion,b[d].sceneDetails.incomingAnchor,a,b[a].sceneDetails.incomingMotion,b[a].sceneDetails.incomingAnchor,1E3*b[a].sceneDetails.sceneTime,1,r(b[d].sceneDetails.incomingEasing),r(b[a].sceneDetails.incomingEasing));a=d;jQuery(m+" .curvy-slider-nav .active").length&&(jQuery(m+" .curvy-slider-nav .active").removeClass("active"),jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-'+a+'"]').addClass("active"));u?B():(clearInterval(A),K());}
function da(){var d=parseInt(a)-1;0>a-1&&(d=b.length-1);q.easeInOut(d,b[d].sceneDetails.incomingMotion,b[d].sceneDetails.incomingAnchor,a,b[a].sceneDetails.incomingMotion,b[a].sceneDetails.incomingAnchor,1E3*b[a].sceneDetails.sceneTime,1,r(b[d].sceneDetails.incomingEasing),r(b[a].sceneDetails.incomingEasing));a=d;jQuery(m+" .curvy-slider-nav .active").length&&(jQuery(m+" .curvy-slider-nav .active").removeClass("active"),jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-'+a+'"]').addClass("active"));u?B():(clearInterval(A),K());}
function J(a,b){var f=0,f=0,f=a.Actor.width,c=a.Actor.height,h=a.path.numControlPoints();a.outCoordsArray=[];for(var g=0;g<h;g++){a.outCoordsArray.push(a.path.getControlPoint(g));}
if("noMotion"!=b){if("toRight"==b){f="image"==a.objType?parseInt(w)+240+parseInt(f)/2+40:parseInt(w)+240+40,f=(new CAAT.LinearPath).setInitialPosition(parseInt(a.outCoordsArray[2].x),parseInt(a.outCoordsArray[2].y)).setFinalPosition(parseInt(f),parseInt(a.outCoordsArray[2].y));}else{if("toLeft"==b){f="image"==a.objType?-40-parseInt(f)/2:-40-parseInt(f),f=(new CAAT.LinearPath).setInitialPosition(parseInt(a.outCoordsArray[2].x),parseInt(a.outCoordsArray[2].y)).setFinalPosition(parseInt(f),parseInt(a.outCoordsArray[2].y));}else{if("toTop"==b){f="image"==a.objType?-40-parseInt(c)/2:-40-parseInt(c),f=(new CAAT.LinearPath).setInitialPosition(parseInt(a.outCoordsArray[2].x),parseInt(a.outCoordsArray[2].y)).setFinalPosition(parseInt(a.outCoordsArray[2].x),parseInt(f));}else{if("toBottom"==b){f="image"==a.objType?150+parseInt(x)+40+parseInt(c)/2:150+parseInt(x)+40,f=(new CAAT.LinearPath).setInitialPosition(parseInt(a.outCoordsArray[2].x),parseInt(a.outCoordsArray[2].y)).setFinalPosition(parseInt(a.outCoordsArray[2].x),parseInt(f));}else{"alpha"==b&&a.Actor.setGlobalAlpha(!0).addBehavior((new CAAT.Behavior.AlphaBehavior).setValues(a.endAlpha,0).setDelayTime(parseInt(a.motionTime)+parseInt(a.delayTime)+parseInt(a.waitOnSceneTime),parseInt(a.outOfSceneTime)));return;}}}}
a.Actor.addBehavior((new CAAT.Behavior.PathBehavior).setValues(f).setDelayTime(a.motionTime+a.delayTime+a.waitOnSceneTime,a.outOfSceneTime).setCycle(!1).setAutoRotate(!1).setInterpolator(a.easing));}}
var b=[],a=0,P="ontouchstart"in window,S,m,t,z,N=[],Y=0,O=!1,w=1920,x=700,y=ma,Q=!1,E=[];S=ia;m="#"+ja;t=ka;z=la;(function(){jQuery(m+" .curvy-slider-side-nav-container").length&&(jQuery(document).on("click touchend",m+" .curvy-side-nav-left",function(){da();}),jQuery(document).on("click touchend",m+" .curvy-side-nav-right",function(){ea();}),jQuery(window).resize(function(){jQuery(document).trigger("curvyslider:reset_side_nav");}),jQuery(document).on("curvyslider:curvy_ready",function(){jQuery(m+" .curvy-slider-side-nav-container").css("display","inline");}));if("nav_regular"===y&&jQuery(m+" .curvy-slider-nav-container").length){jQuery(document).on("click touchend",m+" .curvy-nav-elem",function(){var b=parseInt(jQuery(this).attr("data-ref").toString().replace("nav-elem-",""));if(b!=a){var e=!1;"true"===z&&!1===u&&(e=!0,"activate_nav"==y?jQuery(m+" #stopAllScenesBtn").trigger("click"):R());G()?M(b):(H(b),B());e&&("activate_nav"===y?jQuery(m+" #playAllScenesBtn").trigger("click"):I());jQuery(m+" .curvy-nav-elem.active").removeClass("active");jQuery(this).addClass("active");}});}else{if("replay"===y){jQuery(document).on("click touchend",m+" .curvy-replay-button",function(){B();});}}})();(function(){jQuery(document).on("click",m+" #stopAllScenesBtn",function(){R();});})();(function(){jQuery(document).on("click",m+" #playAllScenesBtn",function(){I();});})();null!=W&&(h=W,"undefined"==typeof h.slider_width&&(h.slider_width=1920),"undefined"==typeof h.slider_height&&(h.slider_height=700),w=h.slider_width,x=h.slider_height,"fullscreen"==h.slider_size_mode&&(Q=!0),oa(),G()?(na(),M(0),"activate_nav"===y&&jQuery(m+' .curvy-nav-elem[data-ref="nav-elem-0"]').addClass("active")):pa());var h,q,ba,F=!1;jQuery(m+" #playBtn").live("click",function(){F||(F=!0,B(),setTimeout(function(){F=!1;},1E3*b[a].sceneDetails.sceneDelay));});var u=!1,A,ha=0,L=0;jQuery(window).blur(function(){u||"undefined"===typeof A||(L=1E3*b[a].sceneDetails.sceneDelay-((new Date).getTime()-ha),clearTimeout(A));});jQuery(window).focus(function(){u||0===L||(A=setTimeout(ga,L),L=0);});var C=0;};})();
;(function(t){function e(){}function i(t){function i(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function o(e,i){t.fn[e]=function(o){if("string"==typeof o){for(var s=n.call(arguments,1),a=0,h=this.length;h>a;a++){var p=this[a],u=t.data(p,e);if(u)if(t.isFunction(u[o])&&"_"!==o.charAt(0)){var f=u[o].apply(u,s);if(void 0!==f)return f}else r("no such method '"+o+"' for "+e+" instance");else r("cannot call methods on "+e+" prior to initialization; "+"attempted to call '"+o+"'")}return this}return this.each(function(){var n=t.data(this,e);n?(n.option(o),n._init()):(n=new i(this,o),t.data(this,e,n))})}}if(t){var r="undefined"==typeof console?e:function(t){console.error(t)};return t.bridget=function(t,e){i(e),o(t,e)},t.bridget}}var n=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],i):i(t.jQuery)})(window),function(t){function e(e){var i=t.event;return i.target=i.target||i.srcElement||e,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(t,e,i){t.addEventListener(e,i,!1)}:i.attachEvent&&(n=function(t,i,n){t[i+n]=n.handleEvent?function(){var i=e(t);n.handleEvent.call(n,i)}:function(){var i=e(t);n.call(t,i)},t.attachEvent("on"+i,t[i+n])});var o=function(){};i.removeEventListener?o=function(t,e,i){t.removeEventListener(e,i,!1)}:i.detachEvent&&(o=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var r={bind:n,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",r):"object"==typeof exports?module.exports=r:t.eventie=r}(this),function(t){function e(t){"function"==typeof t&&(e.isReady?t():r.push(t))}function i(t){var i="readystatechange"===t.type&&"complete"!==o.readyState;if(!e.isReady&&!i){e.isReady=!0;for(var n=0,s=r.length;s>n;n++){var a=r[n];a()}}}function n(n){return n.bind(o,"DOMContentLoaded",i),n.bind(o,"readystatechange",i),n.bind(t,"load",i),e}var o=t.document,r=[];e.isReady=!1,"function"==typeof define&&define.amd?(e.isReady="function"==typeof requirejs,define("doc-ready/doc-ready",["eventie/eventie"],n)):t.docReady=n(t.eventie)}(this),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,o=this,r=o.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;t.length>e;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,o=this.getListenersAsObject(t),r="object"==typeof i;for(n in o)o.hasOwnProperty(n)&&-1===e(o[n],i)&&o[n].push(r?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;t.length>e;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,o,r=this.getListenersAsObject(t);for(o in r)r.hasOwnProperty(o)&&(n=e(r[o],i),-1!==n&&r[o].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,o,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)r.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(o=e[n])&&("function"==typeof o?r.call(this,n,o):s.call(this,n,o));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,o,r,s=this.getListenersAsObject(t);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].length;n--;)i=s[o][n],i.once===!0&&this.removeListener(t,i.listener),r=i.listener.apply(this,e||[]),r===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=r,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t){function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,o=0,r=i.length;r>o;o++)if(e=i[o]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=s.length;i>e;e++){var n=s[e];t[n]=0}return t}function n(t){function n(t){if("string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var n=r(t);if("none"===n.display)return i();var o={};o.width=t.offsetWidth,o.height=t.offsetHeight;for(var u=o.isBorderBox=!(!p||!n[p]||"border-box"!==n[p]),f=0,c=s.length;c>f;f++){var d=s[f],l=n[d];l=a(t,l);var m=parseFloat(l);o[d]=isNaN(m)?0:m}var y=o.paddingLeft+o.paddingRight,g=o.paddingTop+o.paddingBottom,v=o.marginLeft+o.marginRight,b=o.marginTop+o.marginBottom,_=o.borderLeftWidth+o.borderRightWidth,E=o.borderTopWidth+o.borderBottomWidth,L=u&&h,x=e(n.width);x!==!1&&(o.width=x+(L?0:y+_));var z=e(n.height);return z!==!1&&(o.height=z+(L?0:g+E)),o.innerWidth=o.width-(y+_),o.innerHeight=o.height-(g+E),o.outerWidth=o.width+v,o.outerHeight=o.height+b,o}}function a(t,e){if(o||-1===e.indexOf("%"))return e;var i=t.style,n=i.left,r=t.runtimeStyle,s=r&&r.left;return s&&(r.left=t.currentStyle.left),i.left=e,e=i.pixelLeft,i.left=n,s&&(r.left=s),e}var h,p=t("boxSizing");return function(){if(p){var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style[p]="border-box";var i=document.body||document.documentElement;i.appendChild(t);var n=r(t);h=200===e(n.width),i.removeChild(t)}}(),n}var o=t.getComputedStyle,r=o?function(t){return o(t,null)}:function(t){return t.currentStyle},s=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],n):"object"==typeof exports?module.exports=n(require("get-style-property")):t.getSize=n(t.getStyleProperty)}(window),function(t,e){function i(t,e){return t[a](e)}function n(t){if(!t.parentNode){var e=document.createDocumentFragment();e.appendChild(t)}}function o(t,e){n(t);for(var i=t.parentNode.querySelectorAll(e),o=0,r=i.length;r>o;o++)if(i[o]===t)return!0;return!1}function r(t,e){return n(t),i(t,e)}var s,a=function(){if(e.matchesSelector)return"matchesSelector";for(var t=["webkit","moz","ms","o"],i=0,n=t.length;n>i;i++){var o=t[i],r=o+"MatchesSelector";if(e[r])return r}}();if(a){var h=document.createElement("div"),p=i(h,"div");s=p?i:r}else s=o;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return s}):window.matchesSelector=s}(this,Element.prototype),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){for(var e in t)return!1;return e=null,!0}function n(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function o(t,o,r){function a(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var h=r("transition"),p=r("transform"),u=h&&p,f=!!r("perspective"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[h],d=["transform","transition","transitionDuration","transitionProperty"],l=function(){for(var t={},e=0,i=d.length;i>e;e++){var n=d[e],o=r(n);o&&o!==n&&(t[n]=o)}return t}();e(a.prototype,t.prototype),a.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},a.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},a.prototype.getSize=function(){this.size=o(this.element)},a.prototype.css=function(t){var e=this.element.style;for(var i in t){var n=l[i]||i;e[n]=t[i]}},a.prototype.getPosition=function(){var t=s(this.element),e=this.layout.options,i=e.isOriginLeft,n=e.isOriginTop,o=parseInt(t[i?"left":"right"],10),r=parseInt(t[n?"top":"bottom"],10);o=isNaN(o)?0:o,r=isNaN(r)?0:r;var a=this.layout.size;o-=i?a.paddingLeft:a.paddingRight,r-=n?a.paddingTop:a.paddingBottom,this.position.x=o,this.position.y=r},a.prototype.layoutPosition=function(){var t=this.layout.size,e=this.layout.options,i={};e.isOriginLeft?(i.left=this.position.x+t.paddingLeft+"px",i.right=""):(i.right=this.position.x+t.paddingRight+"px",i.left=""),e.isOriginTop?(i.top=this.position.y+t.paddingTop+"px",i.bottom=""):(i.bottom=this.position.y+t.paddingBottom+"px",i.top=""),this.css(i),this.emitEvent("layout",[this])};var m=f?function(t,e){return"translate3d("+t+"px, "+e+"px, 0)"}:function(t,e){return"translate("+t+"px, "+e+"px)"};a.prototype._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,o=parseInt(t,10),r=parseInt(e,10),s=o===this.position.x&&r===this.position.y;if(this.setPosition(t,e),s&&!this.isTransitioning)return this.layoutPosition(),void 0;var a=t-i,h=e-n,p={},u=this.layout.options;a=u.isOriginLeft?a:-a,h=u.isOriginTop?h:-h,p.transform=m(a,h),this.transition({to:p,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},a.prototype.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},a.prototype.moveTo=u?a.prototype._transitionTo:a.prototype.goTo,a.prototype.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},a.prototype._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},a.prototype._transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return this._nonTransition(t),void 0;var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var n=this.element.offsetHeight;n=null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0};var y=p&&n(p)+",opacity";a.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:y,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(c,this,!1))},a.prototype.transition=a.prototype[h?"_transition":"_nonTransition"],a.prototype.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},a.prototype.onotransitionend=function(t){this.ontransitionend(t)};var g={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};a.prototype.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=g[t.propertyName]||t.propertyName;if(delete e.ingProperties[n],i(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd){var o=e.onEnd[n];o.call(this),delete e.onEnd[n]}this.emitEvent("transitionEnd",[this])}},a.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(c,this,!1),this.isTransitioning=!1},a.prototype._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var v={transitionProperty:"",transitionDuration:""};return a.prototype.removeTransitionStyles=function(){this.css(v)},a.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},a.prototype.remove=function(){if(!h||!parseFloat(this.layout.options.transitionDuration))return this.removeElem(),void 0;var t=this;this.on("transitionEnd",function(){return t.removeElem(),!0}),this.hide()},a.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options;this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0})},a.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options;this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.isHidden&&this.css({display:"none"})}}})},a.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},a}var r=document.defaultView,s=r&&r.getComputedStyle?function(t){return r.getComputedStyle(t,null)}:function(t){return t.currentStyle};"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],o):(t.Outlayer={},t.Outlayer.Item=o(t.EventEmitter,t.getSize,t.getStyleProperty))}(window),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){return"[object Array]"===f.call(t)}function n(t){var e=[];if(i(t))e=t;else if(t&&"number"==typeof t.length)for(var n=0,o=t.length;o>n;n++)e.push(t[n]);else e.push(t);return e}function o(t,e){var i=d(e,t);-1!==i&&e.splice(i,1)}function r(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()}function s(i,s,f,d,l,m){function y(t,i){if("string"==typeof t&&(t=a.querySelector(t)),!t||!c(t))return h&&h.error("Bad "+this.constructor.namespace+" element: "+t),void 0;this.element=t,this.options=e({},this.options),this.option(i);var n=++v;this.element.outlayerGUID=n,b[n]=this,this._create(),this.options.isInitLayout&&this.layout()}function g(t,i){t.prototype[i]=e({},y.prototype[i])}var v=0,b={};return y.namespace="outlayer",y.Item=m,y.prototype.options={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},e(y.prototype,f.prototype),y.prototype.option=function(t){e(this.options,t)},y.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),e(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},y.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},y.prototype._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],o=0,r=e.length;r>o;o++){var s=e[o],a=new i(s,this);n.push(a)}return n},y.prototype._filterFindItemElements=function(t){t=n(t);for(var e=this.options.itemSelector,i=[],o=0,r=t.length;r>o;o++){var s=t[o];if(c(s))if(e){l(s,e)&&i.push(s);for(var a=s.querySelectorAll(e),h=0,p=a.length;p>h;h++)i.push(a[h])}else i.push(s)}return i},y.prototype.getItemElements=function(){for(var t=[],e=0,i=this.items.length;i>e;e++)t.push(this.items[e].element);return t},y.prototype.layout=function(){this._resetLayout(),this._manageStamps();var t=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},y.prototype._init=y.prototype.layout,y.prototype._resetLayout=function(){this.getSize()},y.prototype.getSize=function(){this.size=d(this.element)},y.prototype._getMeasurement=function(t,e){var i,n=this.options[t];n?("string"==typeof n?i=this.element.querySelector(n):c(n)&&(i=n),this[t]=i?d(i)[e]:n):this[t]=0},y.prototype.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},y.prototype._getItemsForLayout=function(t){for(var e=[],i=0,n=t.length;n>i;i++){var o=t[i];o.isIgnored||e.push(o)}return e},y.prototype._layoutItems=function(t,e){function i(){n.emitEvent("layoutComplete",[n,t])}var n=this;if(!t||!t.length)return i(),void 0;this._itemsOn(t,"layout",i);for(var o=[],r=0,s=t.length;s>r;r++){var a=t[r],h=this._getItemLayoutPosition(a);h.item=a,h.isInstant=e||a.isLayoutInstant,o.push(h)}this._processLayoutQueue(o)},y.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},y.prototype._processLayoutQueue=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];this._positionItem(n.item,n.x,n.y,n.isInstant)}},y.prototype._positionItem=function(t,e,i,n){n?t.goTo(e,i):t.moveTo(e,i)},y.prototype._postLayout=function(){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))},y.prototype._getContainerSize=u,y.prototype._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},y.prototype._itemsOn=function(t,e,i){function n(){return o++,o===r&&i.call(s),!0}for(var o=0,r=t.length,s=this,a=0,h=t.length;h>a;a++){var p=t[a];p.on(e,n)}},y.prototype.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},y.prototype.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},y.prototype.stamp=function(t){if(t=this._find(t)){this.stamps=this.stamps.concat(t);for(var e=0,i=t.length;i>e;e++){var n=t[e];this.ignore(n)}}},y.prototype.unstamp=function(t){if(t=this._find(t))for(var e=0,i=t.length;i>e;e++){var n=t[e];o(n,this.stamps),this.unignore(n)}},y.prototype._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n(t)):void 0},y.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var t=0,e=this.stamps.length;e>t;t++){var i=this.stamps[t];this._manageStamp(i)}}},y.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},y.prototype._manageStamp=u,y.prototype._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,n=d(t),o={left:e.left-i.left-n.marginLeft,top:e.top-i.top-n.marginTop,right:i.right-e.right-n.marginRight,bottom:i.bottom-e.bottom-n.marginBottom};return o},y.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},y.prototype.bindResize=function(){this.isResizeBound||(i.bind(t,"resize",this),this.isResizeBound=!0)},y.prototype.unbindResize=function(){i.unbind(t,"resize",this),this.isResizeBound=!1},y.prototype.onresize=function(){function t(){e.resize(),delete e.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},y.prototype.resize=function(){var t=d(this.element),e=this.size&&t;e&&t.innerWidth===this.size.innerWidth||this.layout()},y.prototype.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},y.prototype.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},y.prototype.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},y.prototype.reveal=function(t){var e=t&&t.length;if(e)for(var i=0;e>i;i++){var n=t[i];n.reveal()}},y.prototype.hide=function(t){var e=t&&t.length;if(e)for(var i=0;e>i;i++){var n=t[i];n.hide()}},y.prototype.getItem=function(t){for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];if(n.element===t)return n}},y.prototype.getItems=function(t){if(t&&t.length){for(var e=[],i=0,n=t.length;n>i;i++){var o=t[i],r=this.getItem(o);r&&e.push(r)}return e}},y.prototype.remove=function(t){t=n(t);var e=this.getItems(t);if(e&&e.length){this._itemsOn(e,"remove",function(){this.emitEvent("removeComplete",[this,e])});for(var i=0,r=e.length;r>i;i++){var s=e[i];s.remove(),o(s,this.items)}}},y.prototype.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="";for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];n.destroy()}this.unbindResize(),delete this.element.outlayerGUID,p&&p.removeData(this.element,this.constructor.namespace)},y.data=function(t){var e=t&&t.outlayerGUID;return e&&b[e]},y.create=function(t,i){function n(){y.apply(this,arguments)}return Object.create?n.prototype=Object.create(y.prototype):e(n.prototype,y.prototype),n.prototype.constructor=n,g(n,"options"),e(n.prototype.options,i),n.namespace=t,n.data=y.data,n.Item=function(){m.apply(this,arguments)},n.Item.prototype=new m,s(function(){for(var e=r(t),i=a.querySelectorAll(".js-"+e),o="data-"+e+"-options",s=0,u=i.length;u>s;s++){var f,c=i[s],d=c.getAttribute(o);try{f=d&&JSON.parse(d)}catch(l){h&&h.error("Error parsing "+o+" on "+c.nodeName.toLowerCase()+(c.id?"#"+c.id:"")+": "+l);continue}var m=new n(c,f);p&&p.data(c,t,m)}}),p&&p.bridget&&p.bridget(t,n),n},y.Item=m,y}var a=t.document,h=t.console,p=t.jQuery,u=function(){},f=Object.prototype.toString,c="object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},d=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1};"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],s):t.Outlayer=s(t.eventie,t.docReady,t.EventEmitter,t.getSize,t.matchesSelector,t.Outlayer.Item)}(window),function(t){function e(t,e){var n=t.create("masonry");return n.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns();var t=this.cols;for(this.colYs=[];t--;)this.colYs.push(0);this.maxY=0},n.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}this.columnWidth+=this.gutter,this.cols=Math.floor((this.containerWidth+this.gutter)/this.columnWidth),this.cols=Math.max(this.cols,1)},n.prototype.getContainerWidth=function(){var t=this.options.isFitWidth?this.element.parentNode:this.element,i=e(t);this.containerWidth=i&&i.innerWidth},n.prototype._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,n=e&&1>e?"round":"ceil",o=Math[n](t.size.outerWidth/this.columnWidth);o=Math.min(o,this.cols);for(var r=this._getColGroup(o),s=Math.min.apply(Math,r),a=i(r,s),h={x:this.columnWidth*a,y:s},p=s+t.size.outerHeight,u=this.cols+1-r.length,f=0;u>f;f++)this.colYs[a+f]=p;return h},n.prototype._getColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++){var o=this.colYs.slice(n,n+t);e[n]=Math.max.apply(Math,o)}return e},n.prototype._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),o=this.options.isOriginLeft?n.left:n.right,r=o+i.outerWidth,s=Math.floor(o/this.columnWidth);s=Math.max(0,s);var a=Math.floor(r/this.columnWidth);a-=r%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var h=(this.options.isOriginTop?n.top:n.bottom)+i.outerHeight,p=s;a>=p;p++)this.colYs[p]=Math.max(h,this.colYs[p])},n.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this.options.isFitWidth&&(t.width=this._getContainerFitWidth()),t},n.prototype._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},n.prototype.resize=function(){var t=this.containerWidth;this.getContainerWidth(),t!==this.containerWidth&&this.layout()},n}var i=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++){var o=t[i];if(o===e)return i}return-1};"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):t.Masonry=e(t.Outlayer,t.getSize)}(window);(function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var i=e.prototype,r=this,o=r.EventEmitter;i.getListeners=function(e){var t,n,i=this._getEvents();if("object"==typeof e){t={};for(n in i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n])}else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;e.length>t;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},i.addListener=function(e,n){var i,r=this.getListenersAsObject(e),o="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===t(r[i],n)&&r[i].push(o?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,n){var i,r,o=this.getListenersAsObject(e);for(r in o)o.hasOwnProperty(r)&&(i=t(o[r],n),-1!==i&&o[r].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if("object"===n)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(e,t){var n,i,r,o,s=this.getListenersAsObject(e);for(r in s)if(s.hasOwnProperty(r))for(i=s[r].length;i--;)n=s[r][i],n.once===!0&&this.removeListener(e,n.listener),o=n.listener.apply(this,t||[]),o===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return r.EventEmitter=o,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}).call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(i=function(e,n,i){e[n+i]=i.handleEvent?function(){var n=t(e);i.handleEvent.call(i,n)}:function(){var n=t(e);i.call(e,n)},e.attachEvent("on"+n,e[n+i])});var r=function(){};n.removeEventListener?r=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(r=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(i){e[t+n]=void 0}});var o={bind:i,unbind:r};"function"==typeof define&&define.amd?define("eventie/eventie",o):e.eventie=o}(this),function(e,t){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return t(e,n,i)}):"object"==typeof exports?module.exports=t(e,require("eventEmitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(this,function(e,t,n){function i(e,t){for(var n in t)e[n]=t[n];return e}function r(e){return"[object Array]"===d.call(e)}function o(e){var t=[];if(r(e))t=e;else if("number"==typeof e.length)for(var n=0,i=e.length;i>n;n++)t.push(e[n]);else t.push(e);return t}function s(e,t,n){if(!(this instanceof s))return new s(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=o(e),this.options=i({},this.options),"function"==typeof t?n=t:i(this.options,t),n&&this.on("always",n),this.getImages(),a&&(this.jqDeferred=new a.Deferred);var r=this;setTimeout(function(){r.check()})}function c(e){this.img=e}function f(e){this.src=e,v[e]=this}var a=e.jQuery,u=e.console,h=u!==void 0,d=Object.prototype.toString;s.prototype=new t,s.prototype.options={},s.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;t>e;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),r=0,o=i.length;o>r;r++){var s=i[r];this.addImage(s)}}},s.prototype.addImage=function(e){var t=new c(e);this.images.push(t)},s.prototype.check=function(){function e(e,r){return t.options.debug&&h&&u.log("confirm",e,r),t.progress(e),n++,n===i&&t.complete(),!0}var t=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,!i)return this.complete(),void 0;for(var r=0;i>r;r++){var o=this.images[r];o.on("confirm",e),o.check()}},s.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){if(t.emit(e,t),t.emit("always",t),t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},a&&(a.fn.imagesLoaded=function(e,t){var n=new s(this,e,t);return n.jqDeferred.promise(a(this))}),c.prototype=new t,c.prototype.check=function(){var e=v[this.img.src]||new f(this.img.src);if(e.isConfirmed)return this.confirm(e.isLoaded,"cached was confirmed"),void 0;if(this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var t=this;e.on("confirm",function(e,n){return t.confirm(e.isLoaded,n),!0}),e.check()},c.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)};var v={};return f.prototype=new t,f.prototype.check=function(){if(!this.isChecked){var e=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0}},f.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},f.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},f.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},f.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},f.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},s});
;-!function(a){"use strict";var b=a.Masonry;b.prototype._remapV2Options=function(){this._remapOption("gutterWidth","gutter"),this._remapOption("isResizable","isResizeBound"),this._remapOption("isRTL","isOriginLeft",function(a){return!a});var a=this.options.isAnimated;if(void 0!==a&&(this.options.transitionDuration=a?b.prototype.options.transitionDuration:0),void 0===a||a){var c=this.options.animationOptions,d=c&&c.duration;d&&(this.options.transitionDuration="string"==typeof d?d:d+"ms")}},b.prototype._remapOption=function(a,b,c){var d=this.options[a];void 0!==d&&(this.options[b]=c?c(d):d)};var c=b.prototype._create;b.prototype._create=function(){var a=this;this._remapV2Options(),c.apply(this,arguments),setTimeout(function(){jQuery(a.element).addClass("masonry")},0)};var d=b.prototype.layout;b.prototype.layout=function(){this._remapV2Options(),d.apply(this,arguments)};var e=b.prototype.option;b.prototype.option=function(){e.apply(this,arguments),this._remapV2Options()};var f=b.prototype._itemize;b.prototype._itemize=function(a){var b=f.apply(this,arguments);return jQuery(a).addClass("masonry-brick"),b};var g=b.prototype.measureColumns;b.prototype.measureColumns=function(){var a=this.options.columnWidth;a&&"function"==typeof a&&(this.getContainerWidth(),this.columnWidth=a(this.containerWidth)),g.apply(this,arguments)},b.prototype.reload=function(){this.reloadItems.apply(this,arguments),this.layout.apply(this)};var h=b.prototype.destroy;b.prototype.destroy=function(){var a=this.getItemElements();jQuery(this.element).removeClass("masonry"),jQuery(a).removeClass("masonry-brick"),h.apply(this,arguments)}}(window);
;var Swiper=function(a,b){"use strict";function c(a,b){return document.querySelectorAll?(b||document).querySelectorAll(a):jQuery(a,b)}function d(a){return"[object Array]"===Object.prototype.toString.apply(a)?!0:!1}function e(){var a=G-J;return b.freeMode&&(a=G-J),b.slidesPerView>D.slides.length&&!b.centeredSlides&&(a=0),0>a&&(a=0),a}function f(){function a(a){var c,d,e=function(){"undefined"!=typeof D&&null!==D&&(void 0!==D.imagesLoaded&&D.imagesLoaded++,D.imagesLoaded===D.imagesToLoad.length&&(D.reInit(),b.onImagesReady&&D.fireCallback(b.onImagesReady,D)))};a.complete?e():(d=a.currentSrc||a.getAttribute("src"),d?(c=new Image,c.onload=e,c.onerror=e,c.src=d):e())}var d=D.h.addEventListener,e="wrapper"===b.eventTarget?D.wrapper:D.container;if(D.browser.ie10||D.browser.ie11?(d(e,D.touchEvents.touchStart,p),d(document,D.touchEvents.touchMove,q),d(document,D.touchEvents.touchEnd,r)):(D.support.touch&&(d(e,"touchstart",p),d(e,"touchmove",q),d(e,"touchend",r)),b.simulateTouch&&(d(e,"mousedown",p),d(document,"mousemove",q),d(document,"mouseup",r))),b.autoResize&&d(window,"resize",D.resizeFix),g(),D._wheelEvent=!1,b.mousewheelControl){if(void 0!==document.onmousewheel&&(D._wheelEvent="mousewheel"),!D._wheelEvent)try{new WheelEvent("wheel"),D._wheelEvent="wheel"}catch(f){}D._wheelEvent||(D._wheelEvent="DOMMouseScroll"),D._wheelEvent&&d(D.container,D._wheelEvent,j)}if(b.keyboardControl&&d(document,"keydown",i),b.updateOnImagesReady){D.imagesToLoad=c("img",D.container);for(var h=0;h<D.imagesToLoad.length;h++)a(D.imagesToLoad[h])}}function g(){var a,d=D.h.addEventListener;if(b.preventLinks){var e=c("a",D.container);for(a=0;a<e.length;a++)d(e[a],"click",n)}if(b.releaseFormElements){var f=c("input, textarea, select",D.container);for(a=0;a<f.length;a++)d(f[a],D.touchEvents.touchStart,o,!0),D.support.touch&&b.simulateTouch&&d(f[a],"mousedown",o,!0)}if(b.onSlideClick)for(a=0;a<D.slides.length;a++)d(D.slides[a],"click",k);if(b.onSlideTouch)for(a=0;a<D.slides.length;a++)d(D.slides[a],D.touchEvents.touchStart,l)}function h(){var a,d=D.h.removeEventListener;if(b.onSlideClick)for(a=0;a<D.slides.length;a++)d(D.slides[a],"click",k);if(b.onSlideTouch)for(a=0;a<D.slides.length;a++)d(D.slides[a],D.touchEvents.touchStart,l);if(b.releaseFormElements){var e=c("input, textarea, select",D.container);for(a=0;a<e.length;a++)d(e[a],D.touchEvents.touchStart,o,!0),D.support.touch&&b.simulateTouch&&d(e[a],"mousedown",o,!0)}if(b.preventLinks){var f=c("a",D.container);for(a=0;a<f.length;a++)d(f[a],"click",n)}}function i(a){var b=a.keyCode||a.charCode;if(!(a.shiftKey||a.altKey||a.ctrlKey||a.metaKey)){if(37===b||39===b||38===b||40===b){for(var c=!1,d=D.h.getOffset(D.container),e=D.h.windowScroll().left,f=D.h.windowScroll().top,g=D.h.windowWidth(),h=D.h.windowHeight(),i=[[d.left,d.top],[d.left+D.width,d.top],[d.left,d.top+D.height],[d.left+D.width,d.top+D.height]],j=0;j<i.length;j++){var k=i[j];k[0]>=e&&k[0]<=e+g&&k[1]>=f&&k[1]<=f+h&&(c=!0)}if(!c)return}N?((37===b||39===b)&&(a.preventDefault?a.preventDefault():a.returnValue=!1),39===b&&D.swipeNext(),37===b&&D.swipePrev()):((38===b||40===b)&&(a.preventDefault?a.preventDefault():a.returnValue=!1),40===b&&D.swipeNext(),38===b&&D.swipePrev())}}function j(a){var c=D._wheelEvent,d=0;if(a.detail)d=-a.detail;else if("mousewheel"===c)if(b.mousewheelControlForceToAxis)if(N){if(!(Math.abs(a.wheelDeltaX)>Math.abs(a.wheelDeltaY)))return;d=a.wheelDeltaX}else{if(!(Math.abs(a.wheelDeltaY)>Math.abs(a.wheelDeltaX)))return;d=a.wheelDeltaY}else d=a.wheelDelta;else if("DOMMouseScroll"===c)d=-a.detail;else if("wheel"===c)if(b.mousewheelControlForceToAxis)if(N){if(!(Math.abs(a.deltaX)>Math.abs(a.deltaY)))return;d=-a.deltaX}else{if(!(Math.abs(a.deltaY)>Math.abs(a.deltaX)))return;d=-a.deltaY}else d=Math.abs(a.deltaX)>Math.abs(a.deltaY)?-a.deltaX:-a.deltaY;if(b.freeMode){var f=D.getWrapperTranslate()+d;if(f>0&&(f=0),f<-e()&&(f=-e()),D.setWrapperTransition(0),D.setWrapperTranslate(f),D.updateActiveSlide(f),0===f||f===-e())return}else(new Date).getTime()-V>60&&(0>d?D.swipeNext():D.swipePrev()),V=(new Date).getTime();return b.autoplay&&D.stopAutoplay(!0),a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function k(a){D.allowSlideClick&&(m(a),D.fireCallback(b.onSlideClick,D,a))}function l(a){m(a),D.fireCallback(b.onSlideTouch,D,a)}function m(a){if(a.currentTarget)D.clickedSlide=a.currentTarget;else{var c=a.srcElement;do{if(c.className.indexOf(b.slideClass)>-1)break;c=c.parentNode}while(c);D.clickedSlide=c}D.clickedSlideIndex=D.slides.indexOf(D.clickedSlide),D.clickedSlideLoopIndex=D.clickedSlideIndex-(D.loopedSlides||0)}function n(a){return D.allowLinks?void 0:(a.preventDefault?a.preventDefault():a.returnValue=!1,b.preventLinksPropagation&&"stopPropagation"in a&&a.stopPropagation(),!1)}function o(a){return a.stopPropagation?a.stopPropagation():a.returnValue=!1,!1}function p(a){if(b.preventLinks&&(D.allowLinks=!0),D.isTouched||b.onlyExternal)return!1;var c=a.target||a.srcElement;document.activeElement&&document.activeElement!==document.body&&document.activeElement!==c&&document.activeElement.blur();var d="input select textarea".split(" ");if(b.noSwiping&&c&&t(c))return!1;if(_=!1,D.isTouched=!0,$="touchstart"===a.type,!$&&"which"in a&&3===a.which)return D.isTouched=!1,!1;if(!$||1===a.targetTouches.length){D.callPlugins("onTouchStartBegin"),!$&&!D.isAndroid&&d.indexOf(c.tagName.toLowerCase())<0&&(a.preventDefault?a.preventDefault():a.returnValue=!1);var e=$?a.targetTouches[0].pageX:a.pageX||a.clientX,f=$?a.targetTouches[0].pageY:a.pageY||a.clientY;D.touches.startX=D.touches.currentX=e,D.touches.startY=D.touches.currentY=f,D.touches.start=D.touches.current=N?e:f,D.setWrapperTransition(0),D.positions.start=D.positions.current=D.getWrapperTranslate(),D.setWrapperTranslate(D.positions.start),D.times.start=(new Date).getTime(),I=void 0,b.moveStartThreshold>0&&(X=!1),b.onTouchStart&&D.fireCallback(b.onTouchStart,D,a),D.callPlugins("onTouchStartEnd")}}function q(a){if(D.isTouched&&!b.onlyExternal&&(!$||"mousemove"!==a.type)){var c=$?a.targetTouches[0].pageX:a.pageX||a.clientX,d=$?a.targetTouches[0].pageY:a.pageY||a.clientY;if("undefined"==typeof I&&N&&(I=!!(I||Math.abs(d-D.touches.startY)>Math.abs(c-D.touches.startX))),"undefined"!=typeof I||N||(I=!!(I||Math.abs(d-D.touches.startY)<Math.abs(c-D.touches.startX))),I)return void(D.isTouched=!1);if(N){if(!b.swipeToNext&&c<D.touches.startX||!b.swipeToPrev&&c>D.touches.startX)return}else if(!b.swipeToNext&&d<D.touches.startY||!b.swipeToPrev&&d>D.touches.startY)return;if(a.assignedToSwiper)return void(D.isTouched=!1);if(a.assignedToSwiper=!0,b.preventLinks&&(D.allowLinks=!1),b.onSlideClick&&(D.allowSlideClick=!1),b.autoplay&&D.stopAutoplay(!0),!$||1===a.touches.length){if(D.isMoved||(D.callPlugins("onTouchMoveStart"),b.loop&&(D.fixLoop(),D.positions.start=D.getWrapperTranslate()),b.onTouchMoveStart&&D.fireCallback(b.onTouchMoveStart,D)),D.isMoved=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,D.touches.current=N?c:d,D.positions.current=(D.touches.current-D.touches.start)*b.touchRatio+D.positions.start,D.positions.current>0&&b.onResistanceBefore&&D.fireCallback(b.onResistanceBefore,D,D.positions.current),D.positions.current<-e()&&b.onResistanceAfter&&D.fireCallback(b.onResistanceAfter,D,Math.abs(D.positions.current+e())),b.resistance&&"100%"!==b.resistance){var f;if(D.positions.current>0&&(f=1-D.positions.current/J/2,D.positions.current=.5>f?J/2:D.positions.current*f),D.positions.current<-e()){var g=(D.touches.current-D.touches.start)*b.touchRatio+(e()+D.positions.start);f=(J+g)/J;var h=D.positions.current-g*(1-f)/2,i=-e()-J/2;D.positions.current=i>h||0>=f?i:h}}if(b.resistance&&"100%"===b.resistance&&(D.positions.current>0&&(!b.freeMode||b.freeModeFluid)&&(D.positions.current=0),D.positions.current<-e()&&(!b.freeMode||b.freeModeFluid)&&(D.positions.current=-e())),!b.followFinger)return;if(b.moveStartThreshold)if(Math.abs(D.touches.current-D.touches.start)>b.moveStartThreshold||X){if(!X)return X=!0,void(D.touches.start=D.touches.current);D.setWrapperTranslate(D.positions.current)}else D.positions.current=D.positions.start;else D.setWrapperTranslate(D.positions.current);return(b.freeMode||b.watchActiveIndex)&&D.updateActiveSlide(D.positions.current),b.grabCursor&&(D.container.style.cursor="move",D.container.style.cursor="grabbing",D.container.style.cursor="-moz-grabbin",D.container.style.cursor="-webkit-grabbing"),Y||(Y=D.touches.current),Z||(Z=(new Date).getTime()),D.velocity=(D.touches.current-Y)/((new Date).getTime()-Z)/2,Math.abs(D.touches.current-Y)<2&&(D.velocity=0),Y=D.touches.current,Z=(new Date).getTime(),D.callPlugins("onTouchMoveEnd"),b.onTouchMove&&D.fireCallback(b.onTouchMove,D,a),!1}}}function r(a){if(I&&D.swipeReset(),!b.onlyExternal&&D.isTouched){D.isTouched=!1,b.grabCursor&&(D.container.style.cursor="move",D.container.style.cursor="grab",D.container.style.cursor="-moz-grab",D.container.style.cursor="-webkit-grab"),D.positions.current||0===D.positions.current||(D.positions.current=D.positions.start),b.followFinger&&D.setWrapperTranslate(D.positions.current),D.times.end=(new Date).getTime(),D.touches.diff=D.touches.current-D.touches.start,D.touches.abs=Math.abs(D.touches.diff),D.positions.diff=D.positions.current-D.positions.start,D.positions.abs=Math.abs(D.positions.diff);var c=D.positions.diff,d=D.positions.abs,f=D.times.end-D.times.start;5>d&&300>f&&D.allowLinks===!1&&(b.freeMode||0===d||D.swipeReset(),b.preventLinks&&(D.allowLinks=!0),b.onSlideClick&&(D.allowSlideClick=!0)),setTimeout(function(){"undefined"!=typeof D&&null!==D&&(b.preventLinks&&(D.allowLinks=!0),b.onSlideClick&&(D.allowSlideClick=!0))},100);var g=e();if(!D.isMoved&&b.freeMode)return D.isMoved=!1,b.onTouchEnd&&D.fireCallback(b.onTouchEnd,D,a),void D.callPlugins("onTouchEnd");if(!D.isMoved||D.positions.current>0||D.positions.current<-g)return D.swipeReset(),b.onTouchEnd&&D.fireCallback(b.onTouchEnd,D,a),void D.callPlugins("onTouchEnd");if(D.isMoved=!1,b.freeMode){if(b.freeModeFluid){var h,i=1e3*b.momentumRatio,j=D.velocity*i,k=D.positions.current+j,l=!1,m=20*Math.abs(D.velocity)*b.momentumBounceRatio;-g>k&&(b.momentumBounce&&D.support.transitions?(-m>k+g&&(k=-g-m),h=-g,l=!0,_=!0):k=-g),k>0&&(b.momentumBounce&&D.support.transitions?(k>m&&(k=m),h=0,l=!0,_=!0):k=0),0!==D.velocity&&(i=Math.abs((k-D.positions.current)/D.velocity)),D.setWrapperTranslate(k),D.setWrapperTransition(i),b.momentumBounce&&l&&D.wrapperTransitionEnd(function(){_&&(b.onMomentumBounce&&D.fireCallback(b.onMomentumBounce,D),D.callPlugins("onMomentumBounce"),D.setWrapperTranslate(h),D.setWrapperTransition(300))}),D.updateActiveSlide(k)}return(!b.freeModeFluid||f>=300)&&D.updateActiveSlide(D.positions.current),b.onTouchEnd&&D.fireCallback(b.onTouchEnd,D,a),void D.callPlugins("onTouchEnd")}H=0>c?"toNext":"toPrev","toNext"===H&&300>=f&&(30>d||!b.shortSwipes?D.swipeReset():D.swipeNext(!0,!0)),"toPrev"===H&&300>=f&&(30>d||!b.shortSwipes?D.swipeReset():D.swipePrev(!0,!0));var n=0;if("auto"===b.slidesPerView){for(var o,p=Math.abs(D.getWrapperTranslate()),q=0,r=0;r<D.slides.length;r++)if(o=N?D.slides[r].getWidth(!0,b.roundLengths):D.slides[r].getHeight(!0,b.roundLengths),q+=o,q>p){n=o;break}n>J&&(n=J)}else n=F*b.slidesPerView;"toNext"===H&&f>300&&(d>=n*b.longSwipesRatio?D.swipeNext(!0,!0):D.swipeReset()),"toPrev"===H&&f>300&&(d>=n*b.longSwipesRatio?D.swipePrev(!0,!0):D.swipeReset()),b.onTouchEnd&&D.fireCallback(b.onTouchEnd,D,a),D.callPlugins("onTouchEnd")}}function s(a,b){return a&&a.getAttribute("class")&&a.getAttribute("class").indexOf(b)>-1}function t(a){var c=!1;do s(a,b.noSwipingClass)&&(c=!0),a=a.parentElement;while(!c&&a.parentElement&&!s(a,b.wrapperClass));return!c&&s(a,b.wrapperClass)&&s(a,b.noSwipingClass)&&(c=!0),c}function u(a,b){var c,d=document.createElement("div");return d.innerHTML=b,c=d.firstChild,c.className+=" "+a,c.outerHTML}function v(a,c,d){function e(){var f=+new Date,l=f-g;h+=i*l/(1e3/60),k="toNext"===j?h>a:a>h,k?(D.setWrapperTranslate(Math.ceil(h)),D._DOMAnimating=!0,window.setTimeout(function(){e()},1e3/60)):(b.onSlideChangeEnd&&("to"===c?d.runCallbacks===!0&&D.fireCallback(b.onSlideChangeEnd,D,j):D.fireCallback(b.onSlideChangeEnd,D,j)),D.setWrapperTranslate(a),D._DOMAnimating=!1)}var f="to"===c&&d.speed>=0?d.speed:b.speed,g=+new Date;if(D.support.transitions||!b.DOMAnimation)D.setWrapperTranslate(a),D.setWrapperTransition(f);else{var h=D.getWrapperTranslate(),i=Math.ceil((a-h)/f*(1e3/60)),j=h>a?"toNext":"toPrev",k="toNext"===j?h>a:a>h;if(D._DOMAnimating)return;e()}D.updateActiveSlide(a),b.onSlideNext&&"next"===c&&d.runCallbacks===!0&&D.fireCallback(b.onSlideNext,D,a),b.onSlidePrev&&"prev"===c&&d.runCallbacks===!0&&D.fireCallback(b.onSlidePrev,D,a),b.onSlideReset&&"reset"===c&&d.runCallbacks===!0&&D.fireCallback(b.onSlideReset,D,a),"next"!==c&&"prev"!==c&&"to"!==c||d.runCallbacks!==!0||w(c)}function w(a){if(D.callPlugins("onSlideChangeStart"),b.onSlideChangeStart)if(b.queueStartCallbacks&&D.support.transitions){if(D._queueStartCallbacks)return;D._queueStartCallbacks=!0,D.fireCallback(b.onSlideChangeStart,D,a),D.wrapperTransitionEnd(function(){D._queueStartCallbacks=!1})}else D.fireCallback(b.onSlideChangeStart,D,a);if(b.onSlideChangeEnd)if(D.support.transitions)if(b.queueEndCallbacks){if(D._queueEndCallbacks)return;D._queueEndCallbacks=!0,D.wrapperTransitionEnd(function(c){D.fireCallback(b.onSlideChangeEnd,c,a)})}else D.wrapperTransitionEnd(function(c){D.fireCallback(b.onSlideChangeEnd,c,a)});else b.DOMAnimation||setTimeout(function(){D.fireCallback(b.onSlideChangeEnd,D,a)},10)}function x(){var a=D.paginationButtons;if(a)for(var b=0;b<a.length;b++)D.h.removeEventListener(a[b],"click",z)}function y(){var a=D.paginationButtons;if(a)for(var b=0;b<a.length;b++)D.h.addEventListener(a[b],"click",z)}function z(a){for(var c,d=a.target||a.srcElement,e=D.paginationButtons,f=0;f<e.length;f++)d===e[f]&&(c=f);b.autoplay&&D.stopAutoplay(!0),D.swipeTo(c)}function A(){ab=setTimeout(function(){b.loop?(D.fixLoop(),D.swipeNext(!0,!0)):D.swipeNext(!0,!0)||(b.autoplayStopOnLast?(clearTimeout(ab),ab=void 0):D.swipeTo(0)),D.wrapperTransitionEnd(function(){"undefined"!=typeof ab&&A()})},b.autoplay)}function B(){D.calcSlides(),b.loader.slides.length>0&&0===D.slides.length&&D.loadSlides(),b.loop&&D.createLoop(),D.init(),f(),b.pagination&&D.createPagination(!0),b.loop||b.initialSlide>0?D.swipeTo(b.initialSlide,0,!1):D.updateActiveSlide(0),b.autoplay&&D.startAutoplay(),D.centerIndex=D.activeIndex,b.onSwiperCreated&&D.fireCallback(b.onSwiperCreated,D),D.callPlugins("onSwiperCreated")}if(!document.body.outerHTML&&document.body.__defineGetter__&&HTMLElement){var C=HTMLElement.prototype;C.__defineGetter__&&C.__defineGetter__("outerHTML",function(){return(new XMLSerializer).serializeToString(this)})}if(window.getComputedStyle||(window.getComputedStyle=function(a){return this.el=a,this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"===b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),(document.querySelectorAll||window.jQuery)&&"undefined"!=typeof a&&(a.nodeType||0!==c(a).length)){var D=this;D.touches={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,diff:0,abs:0},D.positions={start:0,abs:0,diff:0,current:0},D.times={start:0,end:0},D.id=(new Date).getTime(),D.container=a.nodeType?a:c(a)[0],D.isTouched=!1,D.isMoved=!1,D.activeIndex=0,D.centerIndex=0,D.activeLoaderIndex=0,D.activeLoopIndex=0,D.previousIndex=null,D.velocity=0,D.snapGrid=[],D.slidesGrid=[],D.imagesToLoad=[],D.imagesLoaded=0,D.wrapperLeft=0,D.wrapperRight=0,D.wrapperTop=0,D.wrapperBottom=0,D.isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>=0;var E,F,G,H,I,J,K={eventTarget:"wrapper",mode:"horizontal",touchRatio:1,speed:300,freeMode:!1,freeModeFluid:!1,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,slidesPerView:1,slidesPerGroup:1,slidesPerViewFit:!0,simulateTouch:!0,followFinger:!0,shortSwipes:!0,longSwipesRatio:.5,moveStartThreshold:!1,onlyExternal:!1,createPagination:!0,pagination:!1,paginationElement:"span",paginationClickable:!1,paginationAsRange:!0,resistance:!0,scrollContainer:!1,preventLinks:!0,preventLinksPropagation:!1,noSwiping:!1,noSwipingClass:"swiper-no-swiping",initialSlide:0,keyboardControl:!1,mousewheelControl:!1,mousewheelControlForceToAxis:!1,useCSS3Transforms:!0,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,loop:!1,loopAdditionalSlides:0,roundLengths:!1,calculateHeight:!1,cssWidthAndHeight:!1,updateOnImagesReady:!0,releaseFormElements:!0,watchActiveIndex:!1,visibilityFullFit:!1,offsetPxBefore:0,offsetPxAfter:0,offsetSlidesBefore:0,offsetSlidesAfter:0,centeredSlides:!1,queueStartCallbacks:!1,queueEndCallbacks:!1,autoResize:!0,resizeReInit:!1,DOMAnimation:!0,loader:{slides:[],slidesHTMLType:"inner",surroundGroups:1,logic:"reload",loadAllSlides:!1},swipeToPrev:!0,swipeToNext:!0,slideElement:"div",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",wrapperClass:"swiper-wrapper",paginationElementClass:"swiper-pagination-switch",paginationActiveClass:"swiper-active-switch",paginationVisibleClass:"swiper-visible-switch"};b=b||{};for(var L in K)if(L in b&&"object"==typeof b[L])for(var M in K[L])M in b[L]||(b[L][M]=K[L][M]);else L in b||(b[L]=K[L]);D.params=b,b.scrollContainer&&(b.freeMode=!0,b.freeModeFluid=!0),b.loop&&(b.resistance="100%");var N="horizontal"===b.mode,O=["mousedown","mousemove","mouseup"];D.browser.ie10&&(O=["MSPointerDown","MSPointerMove","MSPointerUp"]),D.browser.ie11&&(O=["pointerdown","pointermove","pointerup"]),D.touchEvents={touchStart:D.support.touch||!b.simulateTouch?"touchstart":O[0],touchMove:D.support.touch||!b.simulateTouch?"touchmove":O[1],touchEnd:D.support.touch||!b.simulateTouch?"touchend":O[2]};for(var P=D.container.childNodes.length-1;P>=0;P--)if(D.container.childNodes[P].className)for(var Q=D.container.childNodes[P].className.split(/\s+/),R=0;R<Q.length;R++)Q[R]===b.wrapperClass&&(E=D.container.childNodes[P]);D.wrapper=E,D._extendSwiperSlide=function(a){return a.append=function(){return b.loop?a.insertAfter(D.slides.length-D.loopedSlides):(D.wrapper.appendChild(a),D.reInit()),a},a.prepend=function(){return b.loop?(D.wrapper.insertBefore(a,D.slides[D.loopedSlides]),D.removeLoopedSlides(),D.calcSlides(),D.createLoop()):D.wrapper.insertBefore(a,D.wrapper.firstChild),D.reInit(),a},a.insertAfter=function(c){if("undefined"==typeof c)return!1;var d;return b.loop?(d=D.slides[c+1+D.loopedSlides],d?D.wrapper.insertBefore(a,d):D.wrapper.appendChild(a),D.removeLoopedSlides(),D.calcSlides(),D.createLoop()):(d=D.slides[c+1],D.wrapper.insertBefore(a,d)),D.reInit(),a},a.clone=function(){return D._extendSwiperSlide(a.cloneNode(!0))},a.remove=function(){D.wrapper.removeChild(a),D.reInit()},a.html=function(b){return"undefined"==typeof b?a.innerHTML:(a.innerHTML=b,a)},a.index=function(){for(var b,c=D.slides.length-1;c>=0;c--)a===D.slides[c]&&(b=c);return b},a.isActive=function(){return a.index()===D.activeIndex?!0:!1},a.swiperSlideDataStorage||(a.swiperSlideDataStorage={}),a.getData=function(b){return a.swiperSlideDataStorage[b]},a.setData=function(b,c){return a.swiperSlideDataStorage[b]=c,a},a.data=function(b,c){return"undefined"==typeof c?a.getAttribute("data-"+b):(a.setAttribute("data-"+b,c),a)},a.getWidth=function(b,c){return D.h.getWidth(a,b,c)},a.getHeight=function(b,c){return D.h.getHeight(a,b,c)},a.getOffset=function(){return D.h.getOffset(a)},a},D.calcSlides=function(a){var c=D.slides?D.slides.length:!1;D.slides=[],D.displaySlides=[];for(var d=0;d<D.wrapper.childNodes.length;d++)if(D.wrapper.childNodes[d].className)for(var e=D.wrapper.childNodes[d].className,f=e.split(/\s+/),i=0;i<f.length;i++)f[i]===b.slideClass&&D.slides.push(D.wrapper.childNodes[d]);for(d=D.slides.length-1;d>=0;d--)D._extendSwiperSlide(D.slides[d]);c!==!1&&(c!==D.slides.length||a)&&(h(),g(),D.updateActiveSlide(),D.params.pagination&&D.createPagination(),D.callPlugins("numberOfSlidesChanged"))},D.createSlide=function(a,c,d){c=c||D.params.slideClass,d=d||b.slideElement;var e=document.createElement(d);return e.innerHTML=a||"",e.className=c,D._extendSwiperSlide(e)},D.appendSlide=function(a,b,c){return a?a.nodeType?D._extendSwiperSlide(a).append():D.createSlide(a,b,c).append():void 0},D.prependSlide=function(a,b,c){return a?a.nodeType?D._extendSwiperSlide(a).prepend():D.createSlide(a,b,c).prepend():void 0},D.insertSlideAfter=function(a,b,c,d){return"undefined"==typeof a?!1:b.nodeType?D._extendSwiperSlide(b).insertAfter(a):D.createSlide(b,c,d).insertAfter(a)},D.removeSlide=function(a){if(D.slides[a]){if(b.loop){if(!D.slides[a+D.loopedSlides])return!1;D.slides[a+D.loopedSlides].remove(),D.removeLoopedSlides(),D.calcSlides(),D.createLoop()}else D.slides[a].remove();return!0}return!1},D.removeLastSlide=function(){return D.slides.length>0?(b.loop?(D.slides[D.slides.length-1-D.loopedSlides].remove(),D.removeLoopedSlides(),D.calcSlides(),D.createLoop()):D.slides[D.slides.length-1].remove(),!0):!1},D.removeAllSlides=function(){for(var a=D.slides.length,b=D.slides.length-1;b>=0;b--)D.slides[b].remove(),b===a-1&&D.setWrapperTranslate(0)},D.getSlide=function(a){return D.slides[a]},D.getLastSlide=function(){return D.slides[D.slides.length-1]},D.getFirstSlide=function(){return D.slides[0]},D.activeSlide=function(){return D.slides[D.activeIndex]},D.fireCallback=function(){var a=arguments[0];if("[object Array]"===Object.prototype.toString.call(a))for(var c=0;c<a.length;c++)"function"==typeof a[c]&&a[c](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);else"[object String]"===Object.prototype.toString.call(a)?b["on"+a]&&D.fireCallback(b["on"+a],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]):a(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},D.addCallback=function(a,b){var c,e=this;return e.params["on"+a]?d(this.params["on"+a])?this.params["on"+a].push(b):"function"==typeof this.params["on"+a]?(c=this.params["on"+a],this.params["on"+a]=[],this.params["on"+a].push(c),this.params["on"+a].push(b)):void 0:(this.params["on"+a]=[],this.params["on"+a].push(b))},D.removeCallbacks=function(a){D.params["on"+a]&&(D.params["on"+a]=null)};var S=[];for(var T in D.plugins)if(b[T]){var U=D.plugins[T](D,b[T]);U&&S.push(U)}D.callPlugins=function(a,b){b||(b={});for(var c=0;c<S.length;c++)a in S[c]&&S[c][a](b)},!D.browser.ie10&&!D.browser.ie11||b.onlyExternal||D.wrapper.classList.add("swiper-wp8-"+(N?"horizontal":"vertical")),b.freeMode&&(D.container.className+=" swiper-free-mode"),D.initialized=!1,D.init=function(a,c){var d=D.h.getWidth(D.container,!1,b.roundLengths),e=D.h.getHeight(D.container,!1,b.roundLengths);if(d!==D.width||e!==D.height||a){D.width=d,D.height=e;var f,g,h,i,j,k,l;J=N?d:e;var m=D.wrapper;if(a&&D.calcSlides(c),"auto"===b.slidesPerView){var n=0,o=0;b.slidesOffset>0&&(m.style.paddingLeft="",m.style.paddingRight="",m.style.paddingTop="",m.style.paddingBottom=""),m.style.width="",m.style.height="",b.offsetPxBefore>0&&(N?D.wrapperLeft=b.offsetPxBefore:D.wrapperTop=b.offsetPxBefore),b.offsetPxAfter>0&&(N?D.wrapperRight=b.offsetPxAfter:D.wrapperBottom=b.offsetPxAfter),b.centeredSlides&&(N?(D.wrapperLeft=(J-this.slides[0].getWidth(!0,b.roundLengths))/2,D.wrapperRight=(J-D.slides[D.slides.length-1].getWidth(!0,b.roundLengths))/2):(D.wrapperTop=(J-D.slides[0].getHeight(!0,b.roundLengths))/2,D.wrapperBottom=(J-D.slides[D.slides.length-1].getHeight(!0,b.roundLengths))/2)),N?(D.wrapperLeft>=0&&(m.style.paddingLeft=D.wrapperLeft+"px"),D.wrapperRight>=0&&(m.style.paddingRight=D.wrapperRight+"px")):(D.wrapperTop>=0&&(m.style.paddingTop=D.wrapperTop+"px"),D.wrapperBottom>=0&&(m.style.paddingBottom=D.wrapperBottom+"px")),k=0;var p=0;for(D.snapGrid=[],D.slidesGrid=[],h=0,l=0;l<D.slides.length;l++){f=D.slides[l].getWidth(!0,b.roundLengths),g=D.slides[l].getHeight(!0,b.roundLengths),b.calculateHeight&&(h=Math.max(h,g));var q=N?f:g;if(b.centeredSlides){var r=l===D.slides.length-1?0:D.slides[l+1].getWidth(!0,b.roundLengths),s=l===D.slides.length-1?0:D.slides[l+1].getHeight(!0,b.roundLengths),t=N?r:s;if(q>J){if(b.slidesPerViewFit)D.snapGrid.push(k+D.wrapperLeft),D.snapGrid.push(k+q-J+D.wrapperLeft);else for(var u=0;u<=Math.floor(q/(J+D.wrapperLeft));u++)D.snapGrid.push(0===u?k+D.wrapperLeft:k+D.wrapperLeft+J*u);D.slidesGrid.push(k+D.wrapperLeft)}else D.snapGrid.push(p),D.slidesGrid.push(p);p+=q/2+t/2}else{if(q>J)if(b.slidesPerViewFit)D.snapGrid.push(k),D.snapGrid.push(k+q-J);else if(0!==J)for(var v=0;v<=Math.floor(q/J);v++)D.snapGrid.push(k+J*v);else D.snapGrid.push(k);else D.snapGrid.push(k);D.slidesGrid.push(k)}k+=q,n+=f,o+=g}b.calculateHeight&&(D.height=h),N?(G=n+D.wrapperRight+D.wrapperLeft,b.cssWidthAndHeight&&"height"!==b.cssWidthAndHeight||(m.style.width=n+"px"),b.cssWidthAndHeight&&"width"!==b.cssWidthAndHeight||(m.style.height=D.height+"px")):(b.cssWidthAndHeight&&"height"!==b.cssWidthAndHeight||(m.style.width=D.width+"px"),b.cssWidthAndHeight&&"width"!==b.cssWidthAndHeight||(m.style.height=o+"px"),G=o+D.wrapperTop+D.wrapperBottom)}else if(b.scrollContainer)m.style.width="",m.style.height="",i=D.slides[0].getWidth(!0,b.roundLengths),j=D.slides[0].getHeight(!0,b.roundLengths),G=N?i:j,m.style.width=i+"px",m.style.height=j+"px",F=N?i:j;else{if(b.calculateHeight){for(h=0,j=0,N||(D.container.style.height=""),m.style.height="",l=0;l<D.slides.length;l++)D.slides[l].style.height="",h=Math.max(D.slides[l].getHeight(!0),h),N||(j+=D.slides[l].getHeight(!0));g=h,D.height=g,N?j=g:(J=g,D.container.style.height=J+"px")}else g=N?D.height:D.height/b.slidesPerView,b.roundLengths&&(g=Math.ceil(g)),j=N?D.height:D.slides.length*g;for(f=N?D.width/b.slidesPerView:D.width,b.roundLengths&&(f=Math.ceil(f)),i=N?D.slides.length*f:D.width,F=N?f:g,b.offsetSlidesBefore>0&&(N?D.wrapperLeft=F*b.offsetSlidesBefore:D.wrapperTop=F*b.offsetSlidesBefore),b.offsetSlidesAfter>0&&(N?D.wrapperRight=F*b.offsetSlidesAfter:D.wrapperBottom=F*b.offsetSlidesAfter),b.offsetPxBefore>0&&(N?D.wrapperLeft=b.offsetPxBefore:D.wrapperTop=b.offsetPxBefore),b.offsetPxAfter>0&&(N?D.wrapperRight=b.offsetPxAfter:D.wrapperBottom=b.offsetPxAfter),b.centeredSlides&&(N?(D.wrapperLeft=(J-F)/2,D.wrapperRight=(J-F)/2):(D.wrapperTop=(J-F)/2,D.wrapperBottom=(J-F)/2)),N?(D.wrapperLeft>0&&(m.style.paddingLeft=D.wrapperLeft+"px"),D.wrapperRight>0&&(m.style.paddingRight=D.wrapperRight+"px")):(D.wrapperTop>0&&(m.style.paddingTop=D.wrapperTop+"px"),D.wrapperBottom>0&&(m.style.paddingBottom=D.wrapperBottom+"px")),G=N?i+D.wrapperRight+D.wrapperLeft:j+D.wrapperTop+D.wrapperBottom,parseFloat(i)>0&&(!b.cssWidthAndHeight||"height"===b.cssWidthAndHeight)&&(m.style.width=i+"px"),parseFloat(j)>0&&(!b.cssWidthAndHeight||"width"===b.cssWidthAndHeight)&&(m.style.height=j+"px"),k=0,D.snapGrid=[],D.slidesGrid=[],l=0;l<D.slides.length;l++)D.snapGrid.push(k),D.slidesGrid.push(k),k+=F,parseFloat(f)>0&&(!b.cssWidthAndHeight||"height"===b.cssWidthAndHeight)&&(D.slides[l].style.width=f+"px"),parseFloat(g)>0&&(!b.cssWidthAndHeight||"width"===b.cssWidthAndHeight)&&(D.slides[l].style.height=g+"px")}D.initialized?(D.callPlugins("onInit"),b.onInit&&D.fireCallback(b.onInit,D)):(D.callPlugins("onFirstInit"),b.onFirstInit&&D.fireCallback(b.onFirstInit,D)),D.initialized=!0}},D.reInit=function(a){D.init(!0,a)},D.resizeFix=function(a){D.callPlugins("beforeResizeFix"),D.init(b.resizeReInit||a),b.freeMode?D.getWrapperTranslate()<-e()&&(D.setWrapperTransition(0),D.setWrapperTranslate(-e())):(D.swipeTo(b.loop?D.activeLoopIndex:D.activeIndex,0,!1),b.autoplay&&(D.support.transitions&&"undefined"!=typeof ab?"undefined"!=typeof ab&&(clearTimeout(ab),ab=void 0,D.startAutoplay()):"undefined"!=typeof bb&&(clearInterval(bb),bb=void 0,D.startAutoplay()))),D.callPlugins("afterResizeFix")},D.destroy=function(a){var c=D.h.removeEventListener,d="wrapper"===b.eventTarget?D.wrapper:D.container;if(D.browser.ie10||D.browser.ie11?(c(d,D.touchEvents.touchStart,p),c(document,D.touchEvents.touchMove,q),c(document,D.touchEvents.touchEnd,r)):(D.support.touch&&(c(d,"touchstart",p),c(d,"touchmove",q),c(d,"touchend",r)),b.simulateTouch&&(c(d,"mousedown",p),c(document,"mousemove",q),c(document,"mouseup",r))),b.autoResize&&c(window,"resize",D.resizeFix),h(),b.paginationClickable&&x(),b.mousewheelControl&&D._wheelEvent&&c(D.container,D._wheelEvent,j),b.keyboardControl&&c(document,"keydown",i),b.autoplay&&D.stopAutoplay(),a){D.wrapper.removeAttribute("style");for(var e=0;e<D.slides.length;e++)D.slides[e].removeAttribute("style")}D.callPlugins("onDestroy"),window.jQuery&&window.jQuery(D.container).data("swiper")&&window.jQuery(D.container).removeData("swiper"),window.Zepto&&window.Zepto(D.container).data("swiper")&&window.Zepto(D.container).removeData("swiper"),D=null},D.disableKeyboardControl=function(){b.keyboardControl=!1,D.h.removeEventListener(document,"keydown",i)},D.enableKeyboardControl=function(){b.keyboardControl=!0,D.h.addEventListener(document,"keydown",i)};var V=(new Date).getTime();if(D.disableMousewheelControl=function(){return D._wheelEvent?(b.mousewheelControl=!1,D.h.removeEventListener(D.container,D._wheelEvent,j),!0):!1},D.enableMousewheelControl=function(){return D._wheelEvent?(b.mousewheelControl=!0,D.h.addEventListener(D.container,D._wheelEvent,j),!0):!1},b.grabCursor){var W=D.container.style;W.cursor="move",W.cursor="grab",W.cursor="-moz-grab",W.cursor="-webkit-grab"}D.allowSlideClick=!0,D.allowLinks=!0;var X,Y,Z,$=!1,_=!0;D.swipeNext=function(a,c){"undefined"==typeof a&&(a=!0),!c&&b.loop&&D.fixLoop(),!c&&b.autoplay&&D.stopAutoplay(!0),D.callPlugins("onSwipeNext");var d=D.getWrapperTranslate().toFixed(2),f=d;if("auto"===b.slidesPerView){for(var g=0;g<D.snapGrid.length;g++)if(-d>=D.snapGrid[g].toFixed(2)&&-d<D.snapGrid[g+1].toFixed(2)){f=-D.snapGrid[g+1];break}}else{var h=F*b.slidesPerGroup;f=-(Math.floor(Math.abs(d)/Math.floor(h))*h+h)}return f<-e()&&(f=-e()),f===d?!1:(v(f,"next",{runCallbacks:a}),!0)},D.swipePrev=function(a,c){"undefined"==typeof a&&(a=!0),!c&&b.loop&&D.fixLoop(),!c&&b.autoplay&&D.stopAutoplay(!0),D.callPlugins("onSwipePrev");var d,e=Math.ceil(D.getWrapperTranslate());if("auto"===b.slidesPerView){d=0;for(var f=1;f<D.snapGrid.length;f++){if(-e===D.snapGrid[f]){d=-D.snapGrid[f-1];break}if(-e>D.snapGrid[f]&&-e<D.snapGrid[f+1]){d=-D.snapGrid[f];break}}}else{var g=F*b.slidesPerGroup;d=-(Math.ceil(-e/g)-1)*g}return d>0&&(d=0),d===e?!1:(v(d,"prev",{runCallbacks:a}),!0)},D.swipeReset=function(a){"undefined"==typeof a&&(a=!0),D.callPlugins("onSwipeReset");{var c,d=D.getWrapperTranslate(),f=F*b.slidesPerGroup;-e()}if("auto"===b.slidesPerView){c=0;for(var g=0;g<D.snapGrid.length;g++){if(-d===D.snapGrid[g])return;if(-d>=D.snapGrid[g]&&-d<D.snapGrid[g+1]){c=D.positions.diff>0?-D.snapGrid[g+1]:-D.snapGrid[g];break}}-d>=D.snapGrid[D.snapGrid.length-1]&&(c=-D.snapGrid[D.snapGrid.length-1]),d<=-e()&&(c=-e())}else c=0>d?Math.round(d/f)*f:0,d<=-e()&&(c=-e());return b.scrollContainer&&(c=0>d?d:0),c<-e()&&(c=-e()),b.scrollContainer&&J>F&&(c=0),c===d?!1:(v(c,"reset",{runCallbacks:a}),!0)},D.swipeTo=function(a,c,d){a=parseInt(a,10),D.callPlugins("onSwipeTo",{index:a,speed:c}),b.loop&&(a+=D.loopedSlides);var f=D.getWrapperTranslate();if(!(!isFinite(a)||a>D.slides.length-1||0>a)){var g;return g="auto"===b.slidesPerView?-D.slidesGrid[a]:-a*F,g<-e()&&(g=-e()),g===f?!1:("undefined"==typeof d&&(d=!0),v(g,"to",{index:a,speed:c,runCallbacks:d}),!0)}},D._queueStartCallbacks=!1,D._queueEndCallbacks=!1,D.updateActiveSlide=function(a){if(D.initialized&&0!==D.slides.length){D.previousIndex=D.activeIndex,"undefined"==typeof a&&(a=D.getWrapperTranslate()),a>0&&(a=0);var c;if("auto"===b.slidesPerView){if(D.activeIndex=D.slidesGrid.indexOf(-a),D.activeIndex<0){for(c=0;c<D.slidesGrid.length-1&&!(-a>D.slidesGrid[c]&&-a<D.slidesGrid[c+1]);c++);var d=Math.abs(D.slidesGrid[c]+a),e=Math.abs(D.slidesGrid[c+1]+a);D.activeIndex=e>=d?c:c+1}}else D.activeIndex=Math[b.visibilityFullFit?"ceil":"round"](-a/F);if(D.activeIndex===D.slides.length&&(D.activeIndex=D.slides.length-1),D.activeIndex<0&&(D.activeIndex=0),D.slides[D.activeIndex]){if(D.calcVisibleSlides(a),D.support.classList){var f;for(c=0;c<D.slides.length;c++)f=D.slides[c],f.classList.remove(b.slideActiveClass),D.visibleSlides.indexOf(f)>=0?f.classList.add(b.slideVisibleClass):f.classList.remove(b.slideVisibleClass);D.slides[D.activeIndex].classList.add(b.slideActiveClass)}else{var g=new RegExp("\\s*"+b.slideActiveClass),h=new RegExp("\\s*"+b.slideVisibleClass);for(c=0;c<D.slides.length;c++)D.slides[c].className=D.slides[c].className.replace(g,"").replace(h,""),D.visibleSlides.indexOf(D.slides[c])>=0&&(D.slides[c].className+=" "+b.slideVisibleClass);D.slides[D.activeIndex].className+=" "+b.slideActiveClass}if(b.loop){var i=D.loopedSlides;D.activeLoopIndex=D.activeIndex-i,D.activeLoopIndex>=D.slides.length-2*i&&(D.activeLoopIndex=D.slides.length-2*i-D.activeLoopIndex),D.activeLoopIndex<0&&(D.activeLoopIndex=D.slides.length-2*i+D.activeLoopIndex),D.activeLoopIndex<0&&(D.activeLoopIndex=0)}else D.activeLoopIndex=D.activeIndex;b.pagination&&D.updatePagination(a)}}},D.createPagination=function(a){if(b.paginationClickable&&D.paginationButtons&&x(),D.paginationContainer=b.pagination.nodeType?b.pagination:c(b.pagination)[0],b.createPagination){var d="",e=D.slides.length,f=e;b.loop&&(f-=2*D.loopedSlides);for(var g=0;f>g;g++)d+="<"+b.paginationElement+' class="'+b.paginationElementClass+'"></'+b.paginationElement+">";D.paginationContainer.innerHTML=d}D.paginationButtons=c("."+b.paginationElementClass,D.paginationContainer),a||D.updatePagination(),D.callPlugins("onCreatePagination"),b.paginationClickable&&y()},D.updatePagination=function(a){if(b.pagination&&!(D.slides.length<1)){var d=c("."+b.paginationActiveClass,D.paginationContainer);if(d){var e=D.paginationButtons;if(0!==e.length){for(var f=0;f<e.length;f++)e[f].className=b.paginationElementClass;var g=b.loop?D.loopedSlides:0;if(b.paginationAsRange){D.visibleSlides||D.calcVisibleSlides(a);var h,i=[];for(h=0;h<D.visibleSlides.length;h++){var j=D.slides.indexOf(D.visibleSlides[h])-g;b.loop&&0>j&&(j=D.slides.length-2*D.loopedSlides+j),b.loop&&j>=D.slides.length-2*D.loopedSlides&&(j=D.slides.length-2*D.loopedSlides-j,j=Math.abs(j)),i.push(j)}for(h=0;h<i.length;h++)e[i[h]]&&(e[i[h]].className+=" "+b.paginationVisibleClass);b.loop?void 0!==e[D.activeLoopIndex]&&(e[D.activeLoopIndex].className+=" "+b.paginationActiveClass):e[D.activeIndex]&&(e[D.activeIndex].className+=" "+b.paginationActiveClass)}else b.loop?e[D.activeLoopIndex]&&(e[D.activeLoopIndex].className+=" "+b.paginationActiveClass+" "+b.paginationVisibleClass):e[D.activeIndex]&&(e[D.activeIndex].className+=" "+b.paginationActiveClass+" "+b.paginationVisibleClass)}}}},D.calcVisibleSlides=function(a){var c=[],d=0,e=0,f=0;N&&D.wrapperLeft>0&&(a+=D.wrapperLeft),!N&&D.wrapperTop>0&&(a+=D.wrapperTop);for(var g=0;g<D.slides.length;g++){d+=e,e="auto"===b.slidesPerView?N?D.h.getWidth(D.slides[g],!0,b.roundLengths):D.h.getHeight(D.slides[g],!0,b.roundLengths):F,f=d+e;var h=!1;b.visibilityFullFit?(d>=-a&&-a+J>=f&&(h=!0),-a>=d&&f>=-a+J&&(h=!0)):(f>-a&&-a+J>=f&&(h=!0),d>=-a&&-a+J>d&&(h=!0),-a>d&&f>-a+J&&(h=!0)),h&&c.push(D.slides[g])}0===c.length&&(c=[D.slides[D.activeIndex]]),D.visibleSlides=c};var ab,bb;D.startAutoplay=function(){if(D.support.transitions){if("undefined"!=typeof ab)return!1;if(!b.autoplay)return;D.callPlugins("onAutoplayStart"),b.onAutoplayStart&&D.fireCallback(b.onAutoplayStart,D),A()}else{if("undefined"!=typeof bb)return!1;if(!b.autoplay)return;D.callPlugins("onAutoplayStart"),b.onAutoplayStart&&D.fireCallback(b.onAutoplayStart,D),bb=setInterval(function(){b.loop?(D.fixLoop(),D.swipeNext(!0,!0)):D.swipeNext(!0,!0)||(b.autoplayStopOnLast?(clearInterval(bb),bb=void 0):D.swipeTo(0))},b.autoplay)}},D.stopAutoplay=function(a){if(D.support.transitions){if(!ab)return;ab&&clearTimeout(ab),ab=void 0,a&&!b.autoplayDisableOnInteraction&&D.wrapperTransitionEnd(function(){A()}),D.callPlugins("onAutoplayStop"),b.onAutoplayStop&&D.fireCallback(b.onAutoplayStop,D)}else bb&&clearInterval(bb),bb=void 0,D.callPlugins("onAutoplayStop"),b.onAutoplayStop&&D.fireCallback(b.onAutoplayStop,D)},D.loopCreated=!1,D.removeLoopedSlides=function(){if(D.loopCreated)for(var a=0;a<D.slides.length;a++)D.slides[a].getData("looped")===!0&&D.wrapper.removeChild(D.slides[a])},D.createLoop=function(){if(0!==D.slides.length){D.loopedSlides="auto"===b.slidesPerView?b.loopedSlides||1:Math.floor(b.slidesPerView)+b.loopAdditionalSlides,D.loopedSlides>D.slides.length&&(D.loopedSlides=D.slides.length);var a,c="",d="",e="",f=D.slides.length,g=Math.floor(D.loopedSlides/f),h=D.loopedSlides%f;for(a=0;g*f>a;a++){var i=a;if(a>=f){var j=Math.floor(a/f);i=a-f*j}e+=D.slides[i].outerHTML}for(a=0;h>a;a++)d+=u(b.slideDuplicateClass,D.slides[a].outerHTML);for(a=f-h;f>a;a++)c+=u(b.slideDuplicateClass,D.slides[a].outerHTML);var k=c+e+E.innerHTML+e+d;for(E.innerHTML=k,D.loopCreated=!0,D.calcSlides(),a=0;a<D.slides.length;a++)(a<D.loopedSlides||a>=D.slides.length-D.loopedSlides)&&D.slides[a].setData("looped",!0);D.callPlugins("onCreateLoop")}},D.fixLoop=function(){var a;D.activeIndex<D.loopedSlides?(a=D.slides.length-3*D.loopedSlides+D.activeIndex,D.swipeTo(a,0,!1)):("auto"===b.slidesPerView&&D.activeIndex>=2*D.loopedSlides||D.activeIndex>D.slides.length-2*b.slidesPerView)&&(a=-D.slides.length+D.activeIndex+D.loopedSlides,D.swipeTo(a,0,!1))},D.loadSlides=function(){var a="";D.activeLoaderIndex=0;for(var c=b.loader.slides,d=b.loader.loadAllSlides?c.length:b.slidesPerView*(1+b.loader.surroundGroups),e=0;d>e;e++)a+="outer"===b.loader.slidesHTMLType?c[e]:"<"+b.slideElement+' class="'+b.slideClass+'" data-swiperindex="'+e+'">'+c[e]+"</"+b.slideElement+">";D.wrapper.innerHTML=a,D.calcSlides(!0),b.loader.loadAllSlides||D.wrapperTransitionEnd(D.reloadSlides,!0)},D.reloadSlides=function(){var a=b.loader.slides,c=parseInt(D.activeSlide().data("swiperindex"),10);if(!(0>c||c>a.length-1)){D.activeLoaderIndex=c;var d=Math.max(0,c-b.slidesPerView*b.loader.surroundGroups),e=Math.min(c+b.slidesPerView*(1+b.loader.surroundGroups)-1,a.length-1);if(c>0){var f=-F*(c-d);D.setWrapperTranslate(f),D.setWrapperTransition(0)}var g;if("reload"===b.loader.logic){D.wrapper.innerHTML="";var h="";for(g=d;e>=g;g++)h+="outer"===b.loader.slidesHTMLType?a[g]:"<"+b.slideElement+' class="'+b.slideClass+'" data-swiperindex="'+g+'">'+a[g]+"</"+b.slideElement+">";D.wrapper.innerHTML=h}else{var i=1e3,j=0;for(g=0;g<D.slides.length;g++){var k=D.slides[g].data("swiperindex");d>k||k>e?D.wrapper.removeChild(D.slides[g]):(i=Math.min(k,i),j=Math.max(k,j))}for(g=d;e>=g;g++){var l;i>g&&(l=document.createElement(b.slideElement),l.className=b.slideClass,l.setAttribute("data-swiperindex",g),l.innerHTML=a[g],D.wrapper.insertBefore(l,D.wrapper.firstChild)),g>j&&(l=document.createElement(b.slideElement),l.className=b.slideClass,l.setAttribute("data-swiperindex",g),l.innerHTML=a[g],D.wrapper.appendChild(l))}}D.reInit(!0)}},B()}};Swiper.prototype={plugins:{},wrapperTransitionEnd:function(a,b){"use strict";function c(h){if(h.target===f&&(a(e),e.params.queueEndCallbacks&&(e._queueEndCallbacks=!1),!b))for(d=0;d<g.length;d++)e.h.removeEventListener(f,g[d],c)}var d,e=this,f=e.wrapper,g=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];if(a)for(d=0;d<g.length;d++)e.h.addEventListener(f,g[d],c)},getWrapperTranslate:function(a){"use strict";var b,c,d,e,f=this.wrapper;return"undefined"==typeof a&&(a="horizontal"===this.params.mode?"x":"y"),this.support.transforms&&this.params.useCSS3Transforms?(d=window.getComputedStyle(f,null),window.WebKitCSSMatrix?e=new WebKitCSSMatrix("none"===d.webkitTransform?"":d.webkitTransform):(e=d.MozTransform||d.OTransform||d.MsTransform||d.msTransform||d.transform||d.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),b=e.toString().split(",")),"x"===a&&(c=window.WebKitCSSMatrix?e.m41:parseFloat(16===b.length?b[12]:b[4])),"y"===a&&(c=window.WebKitCSSMatrix?e.m42:parseFloat(16===b.length?b[13]:b[5]))):("x"===a&&(c=parseFloat(f.style.left,10)||0),"y"===a&&(c=parseFloat(f.style.top,10)||0)),c||0},setWrapperTranslate:function(a,b,c){"use strict";var d,e=this.wrapper.style,f={x:0,y:0,z:0};3===arguments.length?(f.x=a,f.y=b,f.z=c):("undefined"==typeof b&&(b="horizontal"===this.params.mode?"x":"y"),f[b]=a),this.support.transforms&&this.params.useCSS3Transforms?(d=this.support.transforms3d?"translate3d("+f.x+"px, "+f.y+"px, "+f.z+"px)":"translate("+f.x+"px, "+f.y+"px)",e.webkitTransform=e.MsTransform=e.msTransform=e.MozTransform=e.OTransform=e.transform=d):(e.left=f.x+"px",e.top=f.y+"px"),this.callPlugins("onSetWrapperTransform",f),this.params.onSetWrapperTransform&&this.fireCallback(this.params.onSetWrapperTransform,this,f)},setWrapperTransition:function(a){"use strict";var b=this.wrapper.style;b.webkitTransitionDuration=b.MsTransitionDuration=b.msTransitionDuration=b.MozTransitionDuration=b.OTransitionDuration=b.transitionDuration=a/1e3+"s",this.callPlugins("onSetWrapperTransition",{duration:a}),this.params.onSetWrapperTransition&&this.fireCallback(this.params.onSetWrapperTransition,this,a)},h:{getWidth:function(a,b,c){"use strict";var d=window.getComputedStyle(a,null).getPropertyValue("width"),e=parseFloat(d);return(isNaN(e)||d.indexOf("%")>0||0>e)&&(e=a.offsetWidth-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-left"))-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-right"))),b&&(e+=parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-left"))+parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-right"))),c?Math.ceil(e):e},getHeight:function(a,b,c){"use strict";if(b)return a.offsetHeight;var d=window.getComputedStyle(a,null).getPropertyValue("height"),e=parseFloat(d);return(isNaN(e)||d.indexOf("%")>0||0>e)&&(e=a.offsetHeight-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-top"))-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-bottom"))),b&&(e+=parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-top"))+parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-bottom"))),c?Math.ceil(e):e},getOffset:function(a){"use strict";var b=a.getBoundingClientRect(),c=document.body,d=a.clientTop||c.clientTop||0,e=a.clientLeft||c.clientLeft||0,f=window.pageYOffset||a.scrollTop,g=window.pageXOffset||a.scrollLeft;return document.documentElement&&!window.pageYOffset&&(f=document.documentElement.scrollTop,g=document.documentElement.scrollLeft),{top:b.top+f-d,left:b.left+g-e}},windowWidth:function(){"use strict";return window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:void 0},windowHeight:function(){"use strict";return window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:void 0},windowScroll:function(){"use strict";return"undefined"!=typeof pageYOffset?{left:window.pageXOffset,top:window.pageYOffset}:document.documentElement?{left:document.documentElement.scrollLeft,top:document.documentElement.scrollTop}:void 0},addEventListener:function(a,b,c,d){"use strict";"undefined"==typeof d&&(d=!1),a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},removeEventListener:function(a,b,c,d){"use strict";"undefined"==typeof d&&(d=!1),a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)}},setTransform:function(a,b){"use strict";var c=a.style;c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=b},setTranslate:function(a,b){"use strict";var c=a.style,d={x:b.x||0,y:b.y||0,z:b.z||0},e=this.support.transforms3d?"translate3d("+d.x+"px,"+d.y+"px,"+d.z+"px)":"translate("+d.x+"px,"+d.y+"px)";c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=e,this.support.transforms||(c.left=d.x+"px",c.top=d.y+"px")},setTransition:function(a,b){"use strict";var c=a.style;c.webkitTransitionDuration=c.MsTransitionDuration=c.msTransitionDuration=c.MozTransitionDuration=c.OTransitionDuration=c.transitionDuration=b+"ms"},support:{touch:window.Modernizr&&Modernizr.touch===!0||function(){"use strict";return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){"use strict";var a=document.createElement("div").style;return"webkitPerspective"in a||"MozPerspective"in a||"OPerspective"in a||"MsPerspective"in a||"perspective"in a}(),transforms:window.Modernizr&&Modernizr.csstransforms===!0||function(){"use strict";var a=document.createElement("div").style;return"transform"in a||"WebkitTransform"in a||"MozTransform"in a||"msTransform"in a||"MsTransform"in a||"OTransform"in a}(),transitions:window.Modernizr&&Modernizr.csstransitions===!0||function(){"use strict";var a=document.createElement("div").style;return"transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"MsTransition"in a||"OTransition"in a}(),classList:function(){"use strict";var a=document.createElement("div");return"classList"in a}()},browser:{ie8:function(){"use strict";var a=-1;if("Microsoft Internet Explorer"===navigator.appName){var b=navigator.userAgent,c=new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/);null!==c.exec(b)&&(a=parseFloat(RegExp.$1))}return-1!==a&&9>a}(),ie10:window.navigator.msPointerEnabled,ie11:window.navigator.pointerEnabled}},(window.jQuery||window.Zepto)&&!function(a){"use strict";a.fn.swiper=function(b){var c;return this.each(function(d){var e=a(this),f=new Swiper(e[0],b);d||(c=f),e.data("swiper",f)}),c}}(window.jQuery||window.Zepto),"undefined"!=typeof module?module.exports=Swiper:"function"==typeof define&&define.amd&&define([],function(){"use strict";return Swiper});